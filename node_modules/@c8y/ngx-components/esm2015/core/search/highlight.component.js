import { Component, ElementRef, Input, ViewChild } from '@angular/core';
import { escape, escapeRegExp } from 'lodash-es';
import * as ɵngcc0 from '@angular/core';

const _c0 = ["text"];
export class HighlightComponent {
    constructor() {
        this.pattern = '';
        this.text = '';
        this.elementClass = 'text-info';
        this.shouldTrimPattern = false;
        this.highlightedText = '';
    }
    ngOnChanges() {
        var _a;
        const textNoHtml = escape(this.text || '');
        const patternEventuallyTrimmed = this.shouldTrimPattern
            ? (_a = this.pattern) === null || _a === void 0 ? void 0 : _a.trim()
            : this.pattern;
        const patternNoHtml = escape(patternEventuallyTrimmed || '');
        const patternForRegex = escapeRegExp(patternNoHtml).replace(/\\\*/g, '.*');
        this.highlightedText = textNoHtml.replace(new RegExp(patternForRegex, 'i'), `<strong class="${this.elementClass}">$&</strong>`);
    }
}
HighlightComponent.ɵfac = function HighlightComponent_Factory(t) { return new (t || HighlightComponent)(); };
HighlightComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: HighlightComponent, selectors: [["c8y-highlight"]], viewQuery: function HighlightComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c0, 7, ElementRef);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.container = _t.first);
    } }, inputs: { pattern: "pattern", text: "text", elementClass: "elementClass", shouldTrimPattern: "shouldTrimPattern" }, features: [ɵngcc0.ɵɵNgOnChangesFeature], decls: 1, vars: 1, consts: [[3, "innerHTML"]], template: function HighlightComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelement(0, "span", 0);
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("innerHTML", ctx.highlightedText, ɵngcc0.ɵɵsanitizeHtml);
    } }, encapsulation: 2 });
HighlightComponent.propDecorators = {
    container: [{ type: ViewChild, args: ['text', { read: ElementRef, static: true },] }],
    pattern: [{ type: Input }],
    text: [{ type: Input }],
    elementClass: [{ type: Input }],
    shouldTrimPattern: [{ type: Input }]
};
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(HighlightComponent, [{
        type: Component,
        args: [{
                selector: 'c8y-highlight',
                template: '<span [innerHTML]="highlightedText"></span>'
            }]
    }], function () { return []; }, { pattern: [{
            type: Input
        }], text: [{
            type: Input
        }], elementClass: [{
            type: Input
        }], shouldTrimPattern: [{
            type: Input
        }], container: [{
            type: ViewChild,
            args: ['text', { read: ElementRef, static: true }]
        }] }); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGlnaGxpZ2h0LmNvbXBvbmVudC5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vY29yZS9zZWFyY2gvaGlnaGxpZ2h0LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3hFLE9BQU8sRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLE1BQU0sV0FBVyxDQUFDOzs7O0FBTWpELE1BQU0sT0FBTyxrQkFBa0I7QUFDL0IsSUFMQTtBQUNHLFFBUUQsWUFBTyxHQUFXLEVBQUUsQ0FBQztBQUN2QixRQUVFLFNBQUksR0FBVyxFQUFFLENBQUM7QUFDcEIsUUFFRSxpQkFBWSxHQUFXLFdBQVcsQ0FBQztBQUNyQyxRQUVFLHNCQUFpQixHQUFHLEtBQUssQ0FBQztBQUM1QixRQUNFLG9CQUFlLEdBQVcsRUFBRSxDQUFDO0FBQy9CLElBYUEsQ0FBQztBQUNELElBYkUsV0FBVztBQUFLO0FBQ1IsUUFBTixNQUFNLFVBQVUsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksSUFBSSxFQUFFLENBQUMsQ0FBQztBQUMvQyxRQUFJLE1BQU0sd0JBQXdCLEdBQUcsSUFBSSxDQUFDLGlCQUFpQjtBQUMzRCxZQUFNLENBQUMsQ0FBQyxNQUFBLElBQUksQ0FBQyxPQUFPLDBDQUFFLElBQUksRUFBRTtBQUM1QixZQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDO0FBQ3JCLFFBQUksTUFBTSxhQUFhLEdBQUcsTUFBTSxDQUFDLHdCQUF3QixJQUFJLEVBQUUsQ0FBQyxDQUFDO0FBQ2pFLFFBQUksTUFBTSxlQUFlLEdBQUcsWUFBWSxDQUFDLGFBQWEsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDL0UsUUFBSSxJQUFJLENBQUMsZUFBZSxHQUFHLFVBQVUsQ0FBQyxPQUFPLENBQ3ZDLElBQUksTUFBTSxDQUFDLGVBQWUsRUFBRSxHQUFHLENBQUMsRUFDaEMsa0JBQWtCLElBQUksQ0FBQyxZQUFZLGVBQWUsQ0FDbkQsQ0FBQztBQUNOLElBQUUsQ0FBQztBQUNIOzhDQWxDQyxTQUFTLFNBQUMsa0JBQ1QsUUFBUSxFQUFFLGVBQWU7ZUFDekIsUUFBUSxFQUFFLDZDQUE2QyxjQUN4RDs7Ozs7Ozs7OzZCQUNJO0FBQUM7QUFDSSx3QkFBUCxTQUFTLFNBQUMsTUFBTSxFQUFFLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFO0FBQ2xELHNCQUVGLEtBQUs7QUFDTixtQkFFQyxLQUFLO0FBQ04sMkJBRUMsS0FBSztBQUNOLGdDQUVDLEtBQUs7QUFDUDs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQUFFO0FBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEVsZW1lbnRSZWYsIElucHV0LCBWaWV3Q2hpbGQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IGVzY2FwZSwgZXNjYXBlUmVnRXhwIH0gZnJvbSAnbG9kYXNoLWVzJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYzh5LWhpZ2hsaWdodCcsXG4gIHRlbXBsYXRlOiAnPHNwYW4gW2lubmVySFRNTF09XCJoaWdobGlnaHRlZFRleHRcIj48L3NwYW4+J1xufSlcbmV4cG9ydCBjbGFzcyBIaWdobGlnaHRDb21wb25lbnQge1xuICBAVmlld0NoaWxkKCd0ZXh0JywgeyByZWFkOiBFbGVtZW50UmVmLCBzdGF0aWM6IHRydWUgfSlcbiAgY29udGFpbmVyOiBFbGVtZW50UmVmO1xuXG4gIEBJbnB1dCgpXG4gIHBhdHRlcm46IHN0cmluZyA9ICcnO1xuXG4gIEBJbnB1dCgpXG4gIHRleHQ6IHN0cmluZyA9ICcnO1xuXG4gIEBJbnB1dCgpXG4gIGVsZW1lbnRDbGFzczogc3RyaW5nID0gJ3RleHQtaW5mbyc7XG5cbiAgQElucHV0KClcbiAgc2hvdWxkVHJpbVBhdHRlcm4gPSBmYWxzZTtcblxuICBoaWdobGlnaHRlZFRleHQ6IHN0cmluZyA9ICcnO1xuXG4gIG5nT25DaGFuZ2VzKCk6IHZvaWQge1xuICAgIGNvbnN0IHRleHROb0h0bWwgPSBlc2NhcGUodGhpcy50ZXh0IHx8ICcnKTtcbiAgICBjb25zdCBwYXR0ZXJuRXZlbnR1YWxseVRyaW1tZWQgPSB0aGlzLnNob3VsZFRyaW1QYXR0ZXJuXG4gICAgICA/IHRoaXMucGF0dGVybj8udHJpbSgpXG4gICAgICA6IHRoaXMucGF0dGVybjtcbiAgICBjb25zdCBwYXR0ZXJuTm9IdG1sID0gZXNjYXBlKHBhdHRlcm5FdmVudHVhbGx5VHJpbW1lZCB8fCAnJyk7XG4gICAgY29uc3QgcGF0dGVybkZvclJlZ2V4ID0gZXNjYXBlUmVnRXhwKHBhdHRlcm5Ob0h0bWwpLnJlcGxhY2UoL1xcXFxcXCovZywgJy4qJyk7XG4gICAgdGhpcy5oaWdobGlnaHRlZFRleHQgPSB0ZXh0Tm9IdG1sLnJlcGxhY2UoXG4gICAgICBuZXcgUmVnRXhwKHBhdHRlcm5Gb3JSZWdleCwgJ2knKSxcbiAgICAgIGA8c3Ryb25nIGNsYXNzPVwiJHt0aGlzLmVsZW1lbnRDbGFzc31cIj4kJjwvc3Ryb25nPmBcbiAgICApO1xuICB9XG59XG4iXX0=