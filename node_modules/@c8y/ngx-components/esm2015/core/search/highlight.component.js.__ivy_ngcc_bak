import { Component, ElementRef, Input, ViewChild } from '@angular/core';
import { escape, escapeRegExp } from 'lodash-es';
export class HighlightComponent {
    constructor() {
        this.pattern = '';
        this.text = '';
        this.elementClass = 'text-info';
        this.shouldTrimPattern = false;
        this.highlightedText = '';
    }
    ngOnChanges() {
        var _a;
        const textNoHtml = escape(this.text || '');
        const patternEventuallyTrimmed = this.shouldTrimPattern
            ? (_a = this.pattern) === null || _a === void 0 ? void 0 : _a.trim()
            : this.pattern;
        const patternNoHtml = escape(patternEventuallyTrimmed || '');
        const patternForRegex = escapeRegExp(patternNoHtml).replace(/\\\*/g, '.*');
        this.highlightedText = textNoHtml.replace(new RegExp(patternForRegex, 'i'), `<strong class="${this.elementClass}">$&</strong>`);
    }
}
HighlightComponent.decorators = [
    { type: Component, args: [{
                selector: 'c8y-highlight',
                template: '<span [innerHTML]="highlightedText"></span>'
            },] }
];
HighlightComponent.propDecorators = {
    container: [{ type: ViewChild, args: ['text', { read: ElementRef, static: true },] }],
    pattern: [{ type: Input }],
    text: [{ type: Input }],
    elementClass: [{ type: Input }],
    shouldTrimPattern: [{ type: Input }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGlnaGxpZ2h0LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL2NvcmUvc2VhcmNoL2hpZ2hsaWdodC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN4RSxPQUFPLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxNQUFNLFdBQVcsQ0FBQztBQU1qRCxNQUFNLE9BQU8sa0JBQWtCO0lBSi9CO1FBU0UsWUFBTyxHQUFXLEVBQUUsQ0FBQztRQUdyQixTQUFJLEdBQVcsRUFBRSxDQUFDO1FBR2xCLGlCQUFZLEdBQVcsV0FBVyxDQUFDO1FBR25DLHNCQUFpQixHQUFHLEtBQUssQ0FBQztRQUUxQixvQkFBZSxHQUFXLEVBQUUsQ0FBQztJQWMvQixDQUFDO0lBWkMsV0FBVzs7UUFDVCxNQUFNLFVBQVUsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksSUFBSSxFQUFFLENBQUMsQ0FBQztRQUMzQyxNQUFNLHdCQUF3QixHQUFHLElBQUksQ0FBQyxpQkFBaUI7WUFDckQsQ0FBQyxDQUFDLE1BQUEsSUFBSSxDQUFDLE9BQU8sMENBQUUsSUFBSSxFQUFFO1lBQ3RCLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDO1FBQ2pCLE1BQU0sYUFBYSxHQUFHLE1BQU0sQ0FBQyx3QkFBd0IsSUFBSSxFQUFFLENBQUMsQ0FBQztRQUM3RCxNQUFNLGVBQWUsR0FBRyxZQUFZLENBQUMsYUFBYSxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQztRQUMzRSxJQUFJLENBQUMsZUFBZSxHQUFHLFVBQVUsQ0FBQyxPQUFPLENBQ3ZDLElBQUksTUFBTSxDQUFDLGVBQWUsRUFBRSxHQUFHLENBQUMsRUFDaEMsa0JBQWtCLElBQUksQ0FBQyxZQUFZLGVBQWUsQ0FDbkQsQ0FBQztJQUNKLENBQUM7OztZQWpDRixTQUFTLFNBQUM7Z0JBQ1QsUUFBUSxFQUFFLGVBQWU7Z0JBQ3pCLFFBQVEsRUFBRSw2Q0FBNkM7YUFDeEQ7Ozt3QkFFRSxTQUFTLFNBQUMsTUFBTSxFQUFFLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFO3NCQUdwRCxLQUFLO21CQUdMLEtBQUs7MkJBR0wsS0FBSztnQ0FHTCxLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBFbGVtZW50UmVmLCBJbnB1dCwgVmlld0NoaWxkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBlc2NhcGUsIGVzY2FwZVJlZ0V4cCB9IGZyb20gJ2xvZGFzaC1lcyc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2M4eS1oaWdobGlnaHQnLFxuICB0ZW1wbGF0ZTogJzxzcGFuIFtpbm5lckhUTUxdPVwiaGlnaGxpZ2h0ZWRUZXh0XCI+PC9zcGFuPidcbn0pXG5leHBvcnQgY2xhc3MgSGlnaGxpZ2h0Q29tcG9uZW50IHtcbiAgQFZpZXdDaGlsZCgndGV4dCcsIHsgcmVhZDogRWxlbWVudFJlZiwgc3RhdGljOiB0cnVlIH0pXG4gIGNvbnRhaW5lcjogRWxlbWVudFJlZjtcblxuICBASW5wdXQoKVxuICBwYXR0ZXJuOiBzdHJpbmcgPSAnJztcblxuICBASW5wdXQoKVxuICB0ZXh0OiBzdHJpbmcgPSAnJztcblxuICBASW5wdXQoKVxuICBlbGVtZW50Q2xhc3M6IHN0cmluZyA9ICd0ZXh0LWluZm8nO1xuXG4gIEBJbnB1dCgpXG4gIHNob3VsZFRyaW1QYXR0ZXJuID0gZmFsc2U7XG5cbiAgaGlnaGxpZ2h0ZWRUZXh0OiBzdHJpbmcgPSAnJztcblxuICBuZ09uQ2hhbmdlcygpOiB2b2lkIHtcbiAgICBjb25zdCB0ZXh0Tm9IdG1sID0gZXNjYXBlKHRoaXMudGV4dCB8fCAnJyk7XG4gICAgY29uc3QgcGF0dGVybkV2ZW50dWFsbHlUcmltbWVkID0gdGhpcy5zaG91bGRUcmltUGF0dGVyblxuICAgICAgPyB0aGlzLnBhdHRlcm4/LnRyaW0oKVxuICAgICAgOiB0aGlzLnBhdHRlcm47XG4gICAgY29uc3QgcGF0dGVybk5vSHRtbCA9IGVzY2FwZShwYXR0ZXJuRXZlbnR1YWxseVRyaW1tZWQgfHwgJycpO1xuICAgIGNvbnN0IHBhdHRlcm5Gb3JSZWdleCA9IGVzY2FwZVJlZ0V4cChwYXR0ZXJuTm9IdG1sKS5yZXBsYWNlKC9cXFxcXFwqL2csICcuKicpO1xuICAgIHRoaXMuaGlnaGxpZ2h0ZWRUZXh0ID0gdGV4dE5vSHRtbC5yZXBsYWNlKFxuICAgICAgbmV3IFJlZ0V4cChwYXR0ZXJuRm9yUmVnZXgsICdpJyksXG4gICAgICBgPHN0cm9uZyBjbGFzcz1cIiR7dGhpcy5lbGVtZW50Q2xhc3N9XCI+JCY8L3N0cm9uZz5gXG4gICAgKTtcbiAgfVxufVxuIl19