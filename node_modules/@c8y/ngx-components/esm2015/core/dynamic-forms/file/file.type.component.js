import { ChangeDetectionStrategy, Component, ViewChild } from '@angular/core';
import { FieldType } from '@ngx-formly/core';
import { get } from 'lodash';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/common';
import * as ɵngcc2 from '../../drop-area/drop-area.component';
import * as ɵngcc3 from '@angular/forms';
import * as ɵngcc4 from 'ngx-bootstrap/popover';
import * as ɵngcc5 from '../../common/icon.directive';
import * as ɵngcc6 from '../../common/humanize.pipe';

const _c0 = ["dropArea"];
function FieldFile_label_1_button_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "button", 6);
    ɵngcc0.ɵɵelement(1, "i", 7);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r2 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("popover", ctx_r2.to.description)("outsideClick", true);
} }
function FieldFile_label_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "label", 4);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵpipe(2, "humanize");
    ɵngcc0.ɵɵtemplate(3, FieldFile_label_1_button_3_Template, 2, 2, "button", 5);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵpropertyInterpolate("id", ctx_r0.id + "-fieldset");
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate1(" ", ɵngcc0.ɵɵpipeBind1(2, 3, ctx_r0.to.label), " ");
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r0.to.description);
} }
export class FieldFile extends FieldType {
    constructor() {
        super(...arguments);
        this.dropAreaInputs = [
            'title',
            'message',
            'icon',
            'loadingMessage',
            'alwaysShow',
            'clickToOpen',
            'loading',
            'progress',
            'maxAllowedFiles',
            'files',
            'accept'
        ];
    }
    ngOnInit() {
        const keys = Array.isArray(this.key) ? this.key : [this.key];
        const path = keys.join('.');
        this.dropArea.files = get(this.model, path);
        this.dropAreaInputs
            .filter(input => this.to[input] !== undefined)
            .forEach(input => (this.dropArea[input] = this.to[input]));
    }
}
FieldFile.ɵfac = /*@__PURE__*/ function () { let ɵFieldFile_BaseFactory; return function FieldFile_Factory(t) { return (ɵFieldFile_BaseFactory || (ɵFieldFile_BaseFactory = ɵngcc0.ɵɵgetInheritedFactory(FieldFile)))(t || FieldFile); }; }();
FieldFile.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: FieldFile, selectors: [["c8y-field-file"]], viewQuery: function FieldFile_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c0, 7);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.dropArea = _t.first);
    } }, features: [ɵngcc0.ɵɵInheritDefinitionFeature], decls: 4, vars: 3, consts: [["role", "group", 1, "form-group"], [3, "id", 4, "ngIf"], [1, "drop-area-sm", 3, "formControl"], ["dropArea", ""], [3, "id"], ["class", "btn-clean text-14 m-l-4", "placement", "right", "type", "button", 3, "popover", "outsideClick", 4, "ngIf"], ["placement", "right", "type", "button", 1, "btn-clean", "text-14", "m-l-4", 3, "popover", "outsideClick"], ["c8yIcon", "question-circle-o", 1, "text-info"]], template: function FieldFile_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "div", 0);
        ɵngcc0.ɵɵtemplate(1, FieldFile_label_1_Template, 4, 5, "label", 1);
        ɵngcc0.ɵɵelement(2, "c8y-drop-area", 2, 3);
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵattribute("aria-labelledby", ctx.id + "-fieldset");
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.to.label || ctx.to.description);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("formControl", ctx.formControl);
    } }, directives: [ɵngcc1.NgIf, ɵngcc2.DropAreaComponent, ɵngcc3.NgControlStatus, ɵngcc3.FormControlDirective, ɵngcc4.PopoverDirective, ɵngcc5.IconDirective], pipes: [ɵngcc6.HumanizePipe], encapsulation: 2, changeDetection: 0 });
FieldFile.CONFIG = {
    types: [
        {
            name: 'file',
            component: FieldFile
        }
    ]
};
FieldFile.propDecorators = {
    dropArea: [{ type: ViewChild, args: ['dropArea', { static: true },] }]
};
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(FieldFile, [{
        type: Component,
        args: [{
                selector: 'c8y-field-file',
                template: "<div class=\"form-group\" role=\"group\" [attr.aria-labelledby]=\"id + '-fieldset'\">\n  <label id=\"{{ id + '-fieldset' }}\" *ngIf=\"to.label || to.description\">\n    {{ to.label | humanize }}\n    <button\n      *ngIf=\"to.description\"\n      class=\"btn-clean text-14 m-l-4\"\n      [popover]=\"to.description\"\n      placement=\"right\"\n      [outsideClick]=\"true\"\n      type=\"button\"\n    >\n      <i c8yIcon=\"question-circle-o\" class=\"text-info\"></i>\n    </button>\n  </label>\n\n  <c8y-drop-area #dropArea class=\"drop-area-sm\" [formControl]=\"formControl\"> </c8y-drop-area>\n</div>\n",
                changeDetection: ChangeDetectionStrategy.OnPush
            }]
    }], null, { dropArea: [{
            type: ViewChild,
            args: ['dropArea', { static: true }]
        }] }); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlsZS50eXBlLmNvbXBvbmVudC5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vY29yZS9keW5hbWljLWZvcm1zL2ZpbGUvZmlsZS50eXBlLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsU0FBUyxFQUFVLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN0RixPQUFPLEVBQWdCLFNBQVMsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBQzNELE9BQU8sRUFBRSxHQUFHLEVBQUUsTUFBTSxRQUFRLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBUTdCLE1BQU0sT0FBTyxTQUFVLFNBQVEsU0FBUztBQUFHLElBTDNDO0FBQ0c7QUFDRCxRQWFTLG1CQUFjLEdBQWE7QUFDdEMsWUFBSSxPQUFPO0FBQ1gsWUFBSSxTQUFTO0FBQ2IsWUFBSSxNQUFNO0FBQ1YsWUFBSSxnQkFBZ0I7QUFDcEIsWUFBSSxZQUFZO0FBQ2hCLFlBQUksYUFBYTtBQUNqQixZQUFJLFNBQVM7QUFDYixZQUFJLFVBQVU7QUFDZCxZQUFJLGlCQUFpQjtBQUNyQixZQUFJLE9BQU87QUFDWCxZQUFJLFFBQVE7QUFDWixTQUFHLENBQUM7QUFDSixJQVlBLENBQUM7QUFDRCxJQVZFLFFBQVE7QUFBSyxRQUNYLE1BQU0sSUFBSSxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNqRSxRQUFJLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDaEMsUUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQztBQUNoRCxRQUNJLElBQUksQ0FBQyxjQUFjO0FBQ3ZCLGFBQU8sTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsS0FBSyxTQUFTLENBQUM7QUFDcEQsYUFBTyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDakUsSUFBRSxDQUFDO0FBQ0g7Ozs7Ozs7Ozs7Ozs7Ozs7Ozt3T0FBQztBQWxDaUIsZ0JBQU0sR0FBaUI7QUFDekMsSUFBSSxLQUFLLEVBQUU7QUFDWCxRQUFNO0FBQ04sWUFBUSxJQUFJLEVBQUUsTUFBTTtBQUNwQixZQUFRLFNBQVMsRUFBRSxTQUFTO0FBQzVCLFNBQU87QUFDUCxLQUFLO0FBQ0wsQ0FBRyxDQUFDLEFBUkM7QUFBQztRQUxMLFNBQVMsU0FBQyxrQkFDVCxRQUFRLEVBQUUsZ0JBQWdCLHRFQUlPLHVCQXdCaEMsU0FBUyxTQUFDLFVBQVUsRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7QUFBTTtVQTNCN0M7Ozs7c2JBQXlDLGtCQUN6QyxlQUFlLEVBQUUsdUJBQXVCLENBQUMsTUFBTSxjQUNoRDs7Ozs7O29CQXlCZ0Q7QUFBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENoYW5nZURldGVjdGlvblN0cmF0ZWd5LCBDb21wb25lbnQsIE9uSW5pdCwgVmlld0NoaWxkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBDb25maWdPcHRpb24sIEZpZWxkVHlwZSB9IGZyb20gJ0BuZ3gtZm9ybWx5L2NvcmUnO1xuaW1wb3J0IHsgZ2V0IH0gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB7IERyb3BBcmVhQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vZHJvcC1hcmVhJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYzh5LWZpZWxkLWZpbGUnLFxuICB0ZW1wbGF0ZVVybDogJy4vZmlsZS50eXBlLmNvbXBvbmVudC5odG1sJyxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2hcbn0pXG5leHBvcnQgY2xhc3MgRmllbGRGaWxlIGV4dGVuZHMgRmllbGRUeXBlIGltcGxlbWVudHMgT25Jbml0IHtcbiAgc3RhdGljIHJlYWRvbmx5IENPTkZJRzogQ29uZmlnT3B0aW9uID0ge1xuICAgIHR5cGVzOiBbXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICdmaWxlJyxcbiAgICAgICAgY29tcG9uZW50OiBGaWVsZEZpbGVcbiAgICAgIH1cbiAgICBdXG4gIH07XG5cbiAgcmVhZG9ubHkgZHJvcEFyZWFJbnB1dHM6IHN0cmluZ1tdID0gW1xuICAgICd0aXRsZScsXG4gICAgJ21lc3NhZ2UnLFxuICAgICdpY29uJyxcbiAgICAnbG9hZGluZ01lc3NhZ2UnLFxuICAgICdhbHdheXNTaG93JyxcbiAgICAnY2xpY2tUb09wZW4nLFxuICAgICdsb2FkaW5nJyxcbiAgICAncHJvZ3Jlc3MnLFxuICAgICdtYXhBbGxvd2VkRmlsZXMnLFxuICAgICdmaWxlcycsXG4gICAgJ2FjY2VwdCdcbiAgXTtcblxuICBAVmlld0NoaWxkKCdkcm9wQXJlYScsIHsgc3RhdGljOiB0cnVlIH0pIGRyb3BBcmVhOiBEcm9wQXJlYUNvbXBvbmVudDtcblxuICBuZ09uSW5pdCgpOiB2b2lkIHtcbiAgICBjb25zdCBrZXlzID0gQXJyYXkuaXNBcnJheSh0aGlzLmtleSkgPyB0aGlzLmtleSA6IFt0aGlzLmtleV07XG4gICAgY29uc3QgcGF0aCA9IGtleXMuam9pbignLicpO1xuICAgIHRoaXMuZHJvcEFyZWEuZmlsZXMgPSBnZXQodGhpcy5tb2RlbCwgcGF0aCk7XG5cbiAgICB0aGlzLmRyb3BBcmVhSW5wdXRzXG4gICAgICAuZmlsdGVyKGlucHV0ID0+IHRoaXMudG9baW5wdXRdICE9PSB1bmRlZmluZWQpXG4gICAgICAuZm9yRWFjaChpbnB1dCA9PiAodGhpcy5kcm9wQXJlYVtpbnB1dF0gPSB0aGlzLnRvW2lucHV0XSkpO1xuICB9XG59XG4iXX0=