import { __awaiter } from "tslib";
import { Component, EventEmitter, Input, Output } from '@angular/core';
import { Router } from '@angular/router';
import { ApplicationService } from '@c8y/client';
import { AlertService, gettext, WizardService } from '@c8y/ngx-components';
import { BehaviorSubject } from 'rxjs';
import { EcosystemService } from './../ecosystem.service';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@c8y/client';
import * as ɵngcc2 from './../ecosystem.service';
import * as ɵngcc3 from '@c8y/ngx-components';
import * as ɵngcc4 from '@angular/router';
import * as ɵngcc5 from '@angular/common';
import * as ɵngcc6 from 'ngx-bootstrap/dropdown';

function ApplicationCardComponent_c8y_app_icon_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "c8y-app-icon", 20);
} if (rf & 2) {
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("app", ctx_r0.app)("contextPath", ctx_r0.app.contextPath)("name", ctx_r0.app.name);
} }
function ApplicationCardComponent_i_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "i", 21);
} }
function ApplicationCardComponent_i_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "i", 22);
} }
function ApplicationCardComponent_i_6_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "i", 23);
} }
function ApplicationCardComponent_i_7_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "i", 24);
} }
function ApplicationCardComponent_small_14_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "small", 25);
    ɵngcc0.ɵɵelementStart(1, "em");
    ɵngcc0.ɵɵtext(2);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r5 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵtextInterpolate(ctx_r5.app.manifest.version);
} }
function ApplicationCardComponent_div_17_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 26);
    ɵngcc0.ɵɵelement(1, "div", 27);
    ɵngcc0.ɵɵelementStart(2, "p", 28);
    ɵngcc0.ɵɵtext(3);
    ɵngcc0.ɵɵpipe(4, "translate");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r6 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(4, 1, ctx_r6.app.description));
} }
function ApplicationCardComponent_button_24_Template(rf, ctx) { if (rf & 1) {
    const _r10 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "button", 29);
    ɵngcc0.ɵɵlistener("click", function ApplicationCardComponent_button_24_Template_button_click_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r10); const ctx_r9 = ɵngcc0.ɵɵnextContext(); ctx_r9.openApp(); return $event.stopPropagation(); });
    ɵngcc0.ɵɵpipe(1, "translate");
    ɵngcc0.ɵɵelement(2, "i", 30);
    ɵngcc0.ɵɵtext(3);
    ɵngcc0.ɵɵpipe(4, "translate");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r7 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("disabled", ctx_r7.disableOpenInBrowser)("title", ɵngcc0.ɵɵpipeBind1(1, 3, ctx_r7.openButtonTitle));
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate1(" ", ɵngcc0.ɵɵpipeBind1(4, 5, "Open"), " ");
} }
function ApplicationCardComponent_div_26_ul_5_li_1_Template(rf, ctx) { if (rf & 1) {
    const _r15 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "li");
    ɵngcc0.ɵɵelementStart(1, "button", 39);
    ɵngcc0.ɵɵlistener("click", function ApplicationCardComponent_div_26_ul_5_li_1_Template_button_click_1_listener() { ɵngcc0.ɵɵrestoreView(_r15); const ctx_r14 = ɵngcc0.ɵɵnextContext(3); return ctx_r14.detail(); });
    ɵngcc0.ɵɵpipe(2, "translate");
    ɵngcc0.ɵɵelement(3, "i", 40);
    ɵngcc0.ɵɵtext(4);
    ɵngcc0.ɵɵpipe(5, "translate");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵpropertyInterpolate("title", ɵngcc0.ɵɵpipeBind1(2, 2, "Edit"));
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate1(" ", ɵngcc0.ɵɵpipeBind1(5, 4, "Edit"), " ");
} }
function ApplicationCardComponent_div_26_ul_5_ng_container_2_li_7_Template(rf, ctx) { if (rf & 1) {
    const _r18 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "li");
    ɵngcc0.ɵɵelementStart(1, "button", 43);
    ɵngcc0.ɵɵlistener("click", function ApplicationCardComponent_div_26_ul_5_ng_container_2_li_7_Template_button_click_1_listener() { ɵngcc0.ɵɵrestoreView(_r18); const ctx_r17 = ɵngcc0.ɵɵnextContext(4); return ctx_r17.clone(); });
    ɵngcc0.ɵɵpipe(2, "translate");
    ɵngcc0.ɵɵelement(3, "i", 44);
    ɵngcc0.ɵɵtext(4);
    ɵngcc0.ɵɵpipe(5, "translate");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("title", ɵngcc0.ɵɵpipeBind1(2, 2, "Clone application"));
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate1(" ", ɵngcc0.ɵɵpipeBind1(5, 4, "Clone application"), " ");
} }
function ApplicationCardComponent_div_26_ul_5_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    const _r20 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "li");
    ɵngcc0.ɵɵelementStart(2, "button", 41);
    ɵngcc0.ɵɵlistener("click", function ApplicationCardComponent_div_26_ul_5_ng_container_2_Template_button_click_2_listener() { ɵngcc0.ɵɵrestoreView(_r20); const ctx_r19 = ɵngcc0.ɵɵnextContext(3); return ctx_r19.delete(); });
    ɵngcc0.ɵɵpipe(3, "translate");
    ɵngcc0.ɵɵelement(4, "i", 42);
    ɵngcc0.ɵɵtext(5);
    ɵngcc0.ɵɵpipe(6, "translate");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(7, ApplicationCardComponent_div_26_ul_5_ng_container_2_li_7_Template, 6, 6, "li", 37);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r13 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵpropertyInterpolate("title", ctx_r13.canDelete ? "Delete" : ɵngcc0.ɵɵpipeBind1(3, 4, ctx_r13.CANNOT_DELETE_HINT));
    ɵngcc0.ɵɵproperty("disabled", !ctx_r13.canDelete);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate1(" ", ɵngcc0.ɵɵpipeBind1(6, 6, "Delete"), " ");
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r13.canClone);
} }
const _c0 = function () { return ["ROLE_APPLICATION_MANAGEMENT_ADMIN"]; };
function ApplicationCardComponent_div_26_ul_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "ul", 36);
    ɵngcc0.ɵɵtemplate(1, ApplicationCardComponent_div_26_ul_5_li_1_Template, 6, 6, "li", 37);
    ɵngcc0.ɵɵtemplate(2, ApplicationCardComponent_div_26_ul_5_ng_container_2_Template, 8, 8, "ng-container", 38);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r11 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r11.canEdit);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("c8yIfAllowed", ɵngcc0.ɵɵpureFunction0(2, _c0));
} }
function ApplicationCardComponent_div_26_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 31);
    ɵngcc0.ɵɵelementStart(1, "div", 32);
    ɵngcc0.ɵɵelementStart(2, "button", 33);
    ɵngcc0.ɵɵpipe(3, "translate");
    ɵngcc0.ɵɵelement(4, "i", 34);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(5, ApplicationCardComponent_div_26_ul_5_Template, 3, 3, "ul", 35);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵpropertyInterpolate("title", ɵngcc0.ɵɵpipeBind1(3, 1, "Settings"));
} }
export class ApplicationCardComponent {
    constructor(applicationService, ecosystemService, alertService, router, wizardService) {
        this.applicationService = applicationService;
        this.ecosystemService = ecosystemService;
        this.alertService = alertService;
        this.router = router;
        this.wizardService = wizardService;
        this.canEdit = true;
        this.onAppDeleted = new EventEmitter();
        this.onAppCloned = new EventEmitter();
        this.CANNOT_DELETE_HINT = gettext(`Subscribed or current applications can't be deleted. Delete the application on the parent tenant or unsubscribe it from the current.`);
    }
    get openButtonTitle() {
        return !this.disableOpenInBrowser ?
            gettext('Open') :
            gettext('This application is overridden.');
    }
    ngOnInit() {
        return __awaiter(this, void 0, void 0, function* () {
            this.appState = this.ecosystemService.getAppState(this.app);
            const contextPath = this.app.contextPath;
            this.canOpenInBrowser = this.ecosystemService.canOpenAppInBrowser(this.app);
            this.disableOpenInBrowser =
                this.canOpenInBrowser && (yield this.ecosystemService.isOverwrittenByCustomApp(this.app));
            this.canDelete = yield this.ecosystemService.canDeleteApp(this.app);
            this.isPackage = this.ecosystemService.isPackage(this.app);
            this.isFeature = this.ecosystemService.isFeature(this.app);
            this.isMicroservice = this.ecosystemService.isMicroservice(this.app);
            this.isExternal = this.ecosystemService.isExternal(this.app);
            this.canClone = !this.isMicroservice;
        });
    }
    detail() {
        this.isMicroservice
            ? this.router.navigateByUrl(`/microservices/${this.app.id}`)
            : this.router.navigateByUrl(`/ecosystem/application/${this.app.id}`);
    }
    openApp() {
        window.open(this.applicationService.getHref(this.app));
    }
    delete() {
        return __awaiter(this, void 0, void 0, function* () {
            try {
                yield this.ecosystemService.deleteApp(this.app);
                this.onAppDeleted.emit();
            }
            catch (ex) {
                if (ex) {
                    this.alertService.addServerFailure(ex);
                }
            }
        });
    }
    clone() {
        return __awaiter(this, void 0, void 0, function* () {
            const wizardConfig = {
                headerText: 'Add Application',
                headerIcon: 'c8y-atom'
            };
            const initialState = {
                wizardConfig,
                componentInitialState: {
                    selectedApp: new BehaviorSubject(this.app)
                },
                id: 'duplicateApplication'
            };
            const modalOptions = { initialState };
            const modalRef = this.wizardService.show(modalOptions);
            modalRef.content.onClose.subscribe(() => {
                this.onAppCloned.next();
            });
        });
    }
}
ApplicationCardComponent.ɵfac = function ApplicationCardComponent_Factory(t) { return new (t || ApplicationCardComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.ApplicationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.EcosystemService), ɵngcc0.ɵɵdirectiveInject(ɵngcc3.AlertService), ɵngcc0.ɵɵdirectiveInject(ɵngcc4.Router), ɵngcc0.ɵɵdirectiveInject(ɵngcc3.WizardService)); };
ApplicationCardComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: ApplicationCardComponent, selectors: [["c8y-application-card"]], inputs: { canEdit: "canEdit", app: "app" }, outputs: { onAppDeleted: "onAppDeleted", onAppCloned: "onAppCloned" }, decls: 27, vars: 23, consts: [[1, "card", "pointer", "card--d-col"], [1, "card-block", "text-center", "card-column-40", 3, "click"], [1, "card-appicon"], [3, "app", "contextPath", "name", 4, "ngIf"], ["c8yIcon", "big-parcel", 4, "ngIf"], ["c8yIcon", "tab", 4, "ngIf"], ["c8yIcon", "microchip", 4, "ngIf"], ["c8yIcon", "globe1", 4, "ngIf"], [1, "e2e-appCardName", "text-medium", 3, "title"], ["class", "text-muted", 4, "ngIf"], [1, "card-block", "p-0", "no-min-height", "card--d-col", "card-column-80", "flex-grow", 3, "click"], [1, "card-block", "no-min-height", "p-t-0", "p-b-0", "card-column-80"], ["class", "text-center-grid", 4, "ngIf"], [1, "card-block", "no-min-height", "p-t-0", "p-b-0", "card-column-20", "text-center-grid"], [1, "label", 3, "ngClass"], [1, "card-footer", "no-min-height", "p-t-0", "p-b-0", "card-column-20", "text-center-grid"], [1, "p-b-16", "card-hidden-list"], ["class", "btn btn-xs btn-default", 3, "disabled", "title", "click", 4, "ngIf"], [1, "p-b-32", "card-hidden-list"], ["class", "card-actions m-t-0", 4, "ngIf"], [3, "app", "contextPath", "name"], ["c8yIcon", "big-parcel"], ["c8yIcon", "tab"], ["c8yIcon", "microchip"], ["c8yIcon", "globe1"], [1, "text-muted"], [1, "text-center-grid"], [1, "p-b-8", "card-hidden-grid"], [1, "small", "l-h-tight", "p-b-8", "p-l-0", "p-r-0"], [1, "btn", "btn-xs", "btn-default", 3, "disabled", "title", "click"], ["c8yIcon", "external-link", 1, "m-r-4"], [1, "card-actions", "m-t-0"], ["dropdown", "", 1, "dropdown"], ["dropdownToggle", "", 1, "dropdown-toggle", "c8y-dropdown", 3, "title"], ["c8yIcon", "ellipsis-v"], ["class", "dropdown-menu dropdown-menu-right", 4, "dropdownMenu"], [1, "dropdown-menu", "dropdown-menu-right"], [4, "ngIf"], [4, "c8yIfAllowed"], [3, "title", "click"], ["c8yIcon", "pencil", 1, "m-r-4"], ["href", "", 3, "title", "disabled", "click"], ["c8yIcon", "trash", 1, "m-r-4"], ["href", "", 3, "title", "click"], ["c8yIcon", "copy", 1, "m-r-4"]], template: function ApplicationCardComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "div", 0);
        ɵngcc0.ɵɵelementStart(1, "div", 1);
        ɵngcc0.ɵɵlistener("click", function ApplicationCardComponent_Template_div_click_1_listener() { return ctx.detail(); });
        ɵngcc0.ɵɵelementStart(2, "div", 2);
        ɵngcc0.ɵɵtemplate(3, ApplicationCardComponent_c8y_app_icon_3_Template, 1, 3, "c8y-app-icon", 3);
        ɵngcc0.ɵɵtemplate(4, ApplicationCardComponent_i_4_Template, 1, 0, "i", 4);
        ɵngcc0.ɵɵtemplate(5, ApplicationCardComponent_i_5_Template, 1, 0, "i", 5);
        ɵngcc0.ɵɵtemplate(6, ApplicationCardComponent_i_6_Template, 1, 0, "i", 6);
        ɵngcc0.ɵɵtemplate(7, ApplicationCardComponent_i_7_Template, 1, 0, "i", 7);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(8, "p", 8);
        ɵngcc0.ɵɵpipe(9, "async");
        ɵngcc0.ɵɵpipe(10, "humanizeAppName");
        ɵngcc0.ɵɵtext(11);
        ɵngcc0.ɵɵpipe(12, "async");
        ɵngcc0.ɵɵpipe(13, "humanizeAppName");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(14, ApplicationCardComponent_small_14_Template, 3, 1, "small", 9);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(15, "div", 10);
        ɵngcc0.ɵɵlistener("click", function ApplicationCardComponent_Template_div_click_15_listener() { return ctx.detail(); });
        ɵngcc0.ɵɵelementStart(16, "div", 11);
        ɵngcc0.ɵɵtemplate(17, ApplicationCardComponent_div_17_Template, 5, 3, "div", 12);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(18, "div", 13);
        ɵngcc0.ɵɵelementStart(19, "span", 14);
        ɵngcc0.ɵɵtext(20);
        ɵngcc0.ɵɵpipe(21, "translate");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(22, "div", 15);
        ɵngcc0.ɵɵelement(23, "div", 16);
        ɵngcc0.ɵɵtemplate(24, ApplicationCardComponent_button_24_Template, 5, 7, "button", 17);
        ɵngcc0.ɵɵelement(25, "div", 18);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(26, ApplicationCardComponent_div_26_Template, 6, 3, "div", 19);
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵproperty("ngIf", !ctx.isPackage && !ctx.isFeature && !ctx.isMicroservice && !ctx.isExternal);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.isPackage);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.isFeature);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.isMicroservice);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.isExternal);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵpropertyInterpolate("title", ɵngcc0.ɵɵpipeBind1(9, 13, ɵngcc0.ɵɵpipeBind1(10, 15, ctx.app)));
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵtextInterpolate1(" ", ɵngcc0.ɵɵpipeBind1(12, 17, ɵngcc0.ɵɵpipeBind1(13, 19, ctx.app)), " ");
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵproperty("ngIf", (ctx.app.manifest == null ? null : ctx.app.manifest.version) && (ctx.isPackage || ctx.isMicroservice));
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵproperty("ngIf", ctx.app.description);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngClass", ctx.appState.class);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(21, 21, ctx.appState.label));
        ɵngcc0.ɵɵadvance(4);
        ɵngcc0.ɵɵproperty("ngIf", ctx.canOpenInBrowser);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngIf", ctx.canEdit || ctx.canOpenInBrowser || ctx.canDelete);
    } }, directives: [ɵngcc5.NgIf, ɵngcc5.NgClass, ɵngcc3.AppIconComponent, ɵngcc3.IconDirective, ɵngcc6.BsDropdownDirective, ɵngcc6.BsDropdownToggleDirective, ɵngcc6.BsDropdownMenuDirective, ɵngcc3.IfAllowedDirective], pipes: [ɵngcc5.AsyncPipe, ɵngcc3.HumanizeAppNamePipe, ɵngcc3.C8yTranslatePipe], encapsulation: 2 });
ApplicationCardComponent.ctorParameters = () => [
    { type: ApplicationService },
    { type: EcosystemService },
    { type: AlertService },
    { type: Router },
    { type: WizardService }
];
ApplicationCardComponent.propDecorators = {
    app: [{ type: Input }],
    canEdit: [{ type: Input }],
    onAppDeleted: [{ type: Output }],
    onAppCloned: [{ type: Output }]
};
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(ApplicationCardComponent, [{
        type: Component,
        args: [{
                selector: 'c8y-application-card',
                template: "<div class=\"card pointer card--d-col\">\n  <div (click)=\"detail()\" class=\"card-block text-center card-column-40\">\n    <div class=\"card-appicon\">\n      <c8y-app-icon\n        *ngIf=\"!isPackage && !isFeature && !isMicroservice && !isExternal\"\n        [app]=\"app\"\n        [contextPath]=\"app.contextPath\"\n        [name]=\"app.name\"\n      ></c8y-app-icon>\n      <i *ngIf=\"isPackage\" c8yIcon=\"big-parcel\"></i>\n      <i *ngIf=\"isFeature\" c8yIcon=\"tab\"></i>\n      <i *ngIf=\"isMicroservice\" c8yIcon=\"microchip\"></i>\n      <i *ngIf=\"isExternal\" c8yIcon=\"globe1\"></i>\n    </div>\n    <p class=\"e2e-appCardName text-medium\" title=\"{{ app | humanizeAppName | async }}\">\n      {{ app | humanizeAppName | async }}\n    </p>\n    <small *ngIf=\"app.manifest?.version && (isPackage || isMicroservice)\" class=\"text-muted\">\n      <em>{{ app.manifest.version }}</em>\n    </small>\n  </div>\n  <div (click)=\"detail()\" class=\"card-block p-0 no-min-height card--d-col card-column-80 flex-grow\">\n    <div class=\"card-block no-min-height p-t-0 p-b-0 card-column-80\">\n      <div *ngIf=\"app.description\" class=\"text-center-grid\">\n        <div class=\"p-b-8 card-hidden-grid\"></div>\n        <p class=\"small l-h-tight p-b-8 p-l-0 p-r-0\">{{ app.description | translate }}</p>\n      </div>\n    </div>\n    <div class=\"card-block no-min-height p-t-0 p-b-0 card-column-20 text-center-grid\">\n      <span [ngClass]=\"appState.class\" class=\"label\">{{ appState.label | translate }}</span>\n    </div>\n    <div class=\"card-footer no-min-height p-t-0 p-b-0 card-column-20 text-center-grid\">\n      <div class=\"p-b-16 card-hidden-list\"></div>\n      <button\n        (click)=\"openApp(); $event.stopPropagation()\"\n        *ngIf=\"canOpenInBrowser\"\n        [disabled]=\"disableOpenInBrowser\"\n        class=\"btn btn-xs btn-default\"\n        [title]=\"openButtonTitle | translate\"\n      >\n        <i c8yIcon=\"external-link\" class=\"m-r-4\"></i>\n        {{ 'Open' | translate }}\n      </button>\n      <div class=\"p-b-32 card-hidden-list\"></div>\n    </div>\n  </div>\n\n  <div *ngIf=\"canEdit || canOpenInBrowser || canDelete\" class=\"card-actions m-t-0\">\n    <div class=\"dropdown\" dropdown>\n      <button\n        class=\"dropdown-toggle c8y-dropdown\"\n        dropdownToggle\n        title=\"{{ 'Settings' | translate }}\"\n      >\n        <i c8yIcon=\"ellipsis-v\"></i>\n      </button>\n      <ul *dropdownMenu class=\"dropdown-menu dropdown-menu-right\">\n        <li *ngIf=\"canEdit\">\n          <button (click)=\"detail()\" title=\"{{ 'Edit' | translate }}\">\n            <i c8yIcon=\"pencil\" class=\"m-r-4\"></i>\n            {{ 'Edit' | translate }}\n          </button>\n        </li>\n        <ng-container *c8yIfAllowed=\"['ROLE_APPLICATION_MANAGEMENT_ADMIN']\">\n          <li>\n            <button\n              (click)=\"delete()\"\n              href=\"\"\n              title=\"{{ canDelete ? 'Delete' : (CANNOT_DELETE_HINT | translate) }}\"\n              [disabled]=\"!canDelete\"\n            >\n              <i c8yIcon=\"trash\" class=\"m-r-4\"></i>\n              {{ 'Delete' | translate }}\n            </button>\n          </li>\n          <li *ngIf=\"canClone\">\n            <button\n              (click)=\"clone()\"\n              href=\"\"\n              [title]=\"'Clone application' | translate\"\n            >\n              <i c8yIcon=\"copy\" class=\"m-r-4\"></i>\n              {{ 'Clone application' | translate }}\n            </button>\n          </li>\n        </ng-container>\n      </ul>\n    </div>\n  </div>\n</div>\n"
            }]
    }], function () { return [{ type: ɵngcc1.ApplicationService }, { type: ɵngcc2.EcosystemService }, { type: ɵngcc3.AlertService }, { type: ɵngcc4.Router }, { type: ɵngcc3.WizardService }]; }, { canEdit: [{
            type: Input
        }], onAppDeleted: [{
            type: Output
        }], onAppCloned: [{
            type: Output
        }], app: [{
            type: Input
        }] }); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwbGljYXRpb24tY2FyZC5jb21wb25lbnQuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL2Vjb3N5c3RlbS9zaGFyZWQvYXBwbGljYXRpb24tY2FyZC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBVSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDL0UsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ3pDLE9BQU8sRUFBRSxrQkFBa0IsRUFBZ0IsTUFBTSxhQUFhLENBQUM7QUFDL0QsT0FBTyxFQUNMLFlBQVksRUFDWixPQUFPLEVBSVAsYUFBYSxFQUNkLE1BQU0scUJBQXFCLENBQUM7QUFFN0IsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUd2QyxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQU0xRCxNQUFNLE9BQU8sd0JBQXdCO0FBQUcsSUFzQnRDLFlBQ1Usa0JBQXNDLEVBQ3RDLGdCQUFrQyxFQUNsQyxZQUEwQixFQUMxQixNQUFjLEVBQ2QsYUFBNEI7QUFDckMsUUFMUyx1QkFBa0IsR0FBbEIsa0JBQWtCLENBQW9CO0FBQUMsUUFDdkMscUJBQWdCLEdBQWhCLGdCQUFnQixDQUFrQjtBQUFDLFFBQ25DLGlCQUFZLEdBQVosWUFBWSxDQUFjO0FBQUMsUUFDM0IsV0FBTSxHQUFOLE1BQU0sQ0FBUTtBQUFDLFFBQ2Ysa0JBQWEsR0FBYixhQUFhLENBQWU7QUFDeEMsUUExQlcsWUFBTyxHQUFZLElBQUksQ0FBQztB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O0FBQ1osWUFKTyxNQUFNO0FBQUksWUFRakIsYUFBYTtBQUNiO0FBQUc7QUFDYyxrQkFXaEIsS0FBSztBQUFLLHNCQUNWLEtBQUs7QUFBSywyQkFDVixNQUFNO0FBQUssMEJBQ1gsTUFBTTtBQUFJOzs7Ozs7Ozs7Ozs7Ozs7b0JBQUU7QUFBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgRXZlbnRFbWl0dGVyLCBJbnB1dCwgT25Jbml0LCBPdXRwdXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFJvdXRlciB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XG5pbXBvcnQgeyBBcHBsaWNhdGlvblNlcnZpY2UsIElBcHBsaWNhdGlvbiB9IGZyb20gJ0BjOHkvY2xpZW50JztcbmltcG9ydCB7XG4gIEFsZXJ0U2VydmljZSxcbiAgZ2V0dGV4dCxcbiAgV2l6YXJkLFxuICBXaXphcmRDb21wb25lbnQsXG4gIFdpemFyZENvbmZpZyxcbiAgV2l6YXJkU2VydmljZVxufSBmcm9tICdAYzh5L25neC1jb21wb25lbnRzJztcbmltcG9ydCB7IE1vZGFsT3B0aW9ucyB9IGZyb20gJ25neC1ib290c3RyYXAvbW9kYWwnO1xuaW1wb3J0IHsgQmVoYXZpb3JTdWJqZWN0IH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBEdXBsaWNhdGVBcHBsaWNhdGlvbkNvbXBvbmVudCB9IGZyb20gJy4uL2FwcGxpY2F0aW9ucy9kdXBsaWNhdGUtYXBwbGljYXRpb24vZHVwbGljYXRlLWFwcGxpY2F0aW9uLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBBcHBsaWNhdGlvblN0YXRlIH0gZnJvbSAnLi8uLi9lY29zeXN0ZW0ubW9kZWwnO1xuaW1wb3J0IHsgRWNvc3lzdGVtU2VydmljZSB9IGZyb20gJy4vLi4vZWNvc3lzdGVtLnNlcnZpY2UnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdjOHktYXBwbGljYXRpb24tY2FyZCcsXG4gIHRlbXBsYXRlVXJsOiAnLi9hcHBsaWNhdGlvbi1jYXJkLmNvbXBvbmVudC5odG1sJ1xufSlcbmV4cG9ydCBjbGFzcyBBcHBsaWNhdGlvbkNhcmRDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuICBASW5wdXQoKSBhcHA6IElBcHBsaWNhdGlvbjtcbiAgQElucHV0KCkgY2FuRWRpdDogYm9vbGVhbiA9IHRydWU7XG4gIEBPdXRwdXQoKSBvbkFwcERlbGV0ZWQ6IEV2ZW50RW1pdHRlcjx2b2lkPiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgQE91dHB1dCgpIG9uQXBwQ2xvbmVkOiBFdmVudEVtaXR0ZXI8dm9pZD4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIGFwcFN0YXRlOiBBcHBsaWNhdGlvblN0YXRlO1xuICBjYW5PcGVuSW5Ccm93c2VyOiBib29sZWFuO1xuICBkaXNhYmxlT3BlbkluQnJvd3NlcjogYm9vbGVhbjtcbiAgY2FuRGVsZXRlOiBib29sZWFuO1xuICBpc1BhY2thZ2U6IGJvb2xlYW47XG4gIGlzRmVhdHVyZTogYm9vbGVhbjtcbiAgaXNFeHRlcm5hbDogYm9vbGVhbjtcbiAgaXNNaWNyb3NlcnZpY2U6IGJvb2xlYW47XG4gIGNhbkNsb25lOiBib29sZWFuO1xuICBnZXQgb3BlbkJ1dHRvblRpdGxlKCkge1xuICAgIHJldHVybiAhdGhpcy5kaXNhYmxlT3BlbkluQnJvd3NlciA/XG4gICAgICBnZXR0ZXh0KCdPcGVuJykgOlxuICAgICAgZ2V0dGV4dCgnVGhpcyBhcHBsaWNhdGlvbiBpcyBvdmVycmlkZGVuLicpO1xuICB9XG5cbiAgcmVhZG9ubHkgQ0FOTk9UX0RFTEVURV9ISU5UID0gZ2V0dGV4dChgU3Vic2NyaWJlZCBvciBjdXJyZW50IGFwcGxpY2F0aW9ucyBjYW4ndCBiZSBkZWxldGVkLiBEZWxldGUgdGhlIGFwcGxpY2F0aW9uIG9uIHRoZSBwYXJlbnQgdGVuYW50IG9yIHVuc3Vic2NyaWJlIGl0IGZyb20gdGhlIGN1cnJlbnQuYCk7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBhcHBsaWNhdGlvblNlcnZpY2U6IEFwcGxpY2F0aW9uU2VydmljZSxcbiAgICBwcml2YXRlIGVjb3N5c3RlbVNlcnZpY2U6IEVjb3N5c3RlbVNlcnZpY2UsXG4gICAgcHJpdmF0ZSBhbGVydFNlcnZpY2U6IEFsZXJ0U2VydmljZSxcbiAgICBwcml2YXRlIHJvdXRlcjogUm91dGVyLFxuICAgIHByaXZhdGUgd2l6YXJkU2VydmljZTogV2l6YXJkU2VydmljZVxuICApIHt9XG5cbiAgYXN5bmMgbmdPbkluaXQoKSB7XG4gICAgdGhpcy5hcHBTdGF0ZSA9IHRoaXMuZWNvc3lzdGVtU2VydmljZS5nZXRBcHBTdGF0ZSh0aGlzLmFwcCk7XG4gICAgY29uc3QgY29udGV4dFBhdGggPSB0aGlzLmFwcC5jb250ZXh0UGF0aDtcbiAgICB0aGlzLmNhbk9wZW5JbkJyb3dzZXIgPSB0aGlzLmVjb3N5c3RlbVNlcnZpY2UuY2FuT3BlbkFwcEluQnJvd3Nlcih0aGlzLmFwcCk7XG4gICAgdGhpcy5kaXNhYmxlT3BlbkluQnJvd3NlciA9XG4gICAgICB0aGlzLmNhbk9wZW5JbkJyb3dzZXIgJiYgKGF3YWl0IHRoaXMuZWNvc3lzdGVtU2VydmljZS5pc092ZXJ3cml0dGVuQnlDdXN0b21BcHAodGhpcy5hcHApKTtcbiAgICB0aGlzLmNhbkRlbGV0ZSA9IGF3YWl0IHRoaXMuZWNvc3lzdGVtU2VydmljZS5jYW5EZWxldGVBcHAodGhpcy5hcHApO1xuICAgIHRoaXMuaXNQYWNrYWdlID0gdGhpcy5lY29zeXN0ZW1TZXJ2aWNlLmlzUGFja2FnZSh0aGlzLmFwcCk7XG4gICAgdGhpcy5pc0ZlYXR1cmUgPSB0aGlzLmVjb3N5c3RlbVNlcnZpY2UuaXNGZWF0dXJlKHRoaXMuYXBwKTtcbiAgICB0aGlzLmlzTWljcm9zZXJ2aWNlID0gdGhpcy5lY29zeXN0ZW1TZXJ2aWNlLmlzTWljcm9zZXJ2aWNlKHRoaXMuYXBwKTtcbiAgICB0aGlzLmlzRXh0ZXJuYWwgPSB0aGlzLmVjb3N5c3RlbVNlcnZpY2UuaXNFeHRlcm5hbCh0aGlzLmFwcCk7XG4gICAgdGhpcy5jYW5DbG9uZSA9ICF0aGlzLmlzTWljcm9zZXJ2aWNlO1xuICB9XG5cbiAgZGV0YWlsKCkge1xuICAgIHRoaXMuaXNNaWNyb3NlcnZpY2VcbiAgICAgID8gdGhpcy5yb3V0ZXIubmF2aWdhdGVCeVVybChgL21pY3Jvc2VydmljZXMvJHt0aGlzLmFwcC5pZH1gKVxuICAgICAgOiB0aGlzLnJvdXRlci5uYXZpZ2F0ZUJ5VXJsKGAvZWNvc3lzdGVtL2FwcGxpY2F0aW9uLyR7dGhpcy5hcHAuaWR9YCk7XG4gIH1cblxuICBvcGVuQXBwKCkge1xuICAgIHdpbmRvdy5vcGVuKHRoaXMuYXBwbGljYXRpb25TZXJ2aWNlLmdldEhyZWYodGhpcy5hcHApKTtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZSgpIHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5lY29zeXN0ZW1TZXJ2aWNlLmRlbGV0ZUFwcCh0aGlzLmFwcCk7XG4gICAgICB0aGlzLm9uQXBwRGVsZXRlZC5lbWl0KCk7XG4gICAgfSBjYXRjaCAoZXgpIHtcbiAgICAgIGlmIChleCkge1xuICAgICAgICB0aGlzLmFsZXJ0U2VydmljZS5hZGRTZXJ2ZXJGYWlsdXJlKGV4KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBhc3luYyBjbG9uZSgpIHtcbiAgICBjb25zdCB3aXphcmRDb25maWc6IFdpemFyZENvbmZpZyA9IHtcbiAgICAgIGhlYWRlclRleHQ6ICdBZGQgQXBwbGljYXRpb24nLFxuICAgICAgaGVhZGVySWNvbjogJ2M4eS1hdG9tJ1xuICAgIH07XG5cbiAgICBjb25zdCBpbml0aWFsU3RhdGU6IFdpemFyZDxEdXBsaWNhdGVBcHBsaWNhdGlvbkNvbXBvbmVudD4gPSB7XG4gICAgICB3aXphcmRDb25maWcsXG4gICAgICBjb21wb25lbnRJbml0aWFsU3RhdGU6IHtcbiAgICAgICAgc2VsZWN0ZWRBcHA6IG5ldyBCZWhhdmlvclN1YmplY3QodGhpcy5hcHApXG4gICAgICB9LFxuICAgICAgaWQ6ICdkdXBsaWNhdGVBcHBsaWNhdGlvbidcbiAgICB9O1xuXG4gICAgY29uc3QgbW9kYWxPcHRpb25zOiBNb2RhbE9wdGlvbnM8V2l6YXJkQ29tcG9uZW50PiA9IHsgaW5pdGlhbFN0YXRlIH07XG5cbiAgICBjb25zdCBtb2RhbFJlZiA9IHRoaXMud2l6YXJkU2VydmljZS5zaG93KG1vZGFsT3B0aW9ucyk7XG4gICAgbW9kYWxSZWYuY29udGVudC5vbkNsb3NlLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICB0aGlzLm9uQXBwQ2xvbmVkLm5leHQoKTtcbiAgICB9KTtcbiAgfVxufVxuIl19