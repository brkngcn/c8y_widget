import { Component, Inject, Optional } from '@angular/core';
import { AppStateService, gettext } from '@c8y/ngx-components';
import { COCKPIT_HOME_DASHBOARD_CONFIG, DEFAULT_COCKPIT_HOME_WIDGETS } from './cockpit-dashboard.model';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@c8y/ngx-components';
import * as ɵngcc2 from '../context-dashboard.component';
export class CockpitDashboardComponent {
    constructor(appState, homeDashboardConfig) {
        var _a, _b;
        this.appState = appState;
        this.homeDashboardConfig = homeDashboardConfig;
        this.defaultWidgets = DEFAULT_COCKPIT_HOME_WIDGETS;
        this.dashboardName = 'home-cockpit1';
        this.pageTitle = gettext('Home');
        const config = Object.assign(Object.assign({}, this.homeDashboardConfig), { dashboardName: (_a = appState.currentApplication.value.config) === null || _a === void 0 ? void 0 : _a.homeDashboardName, userSpecific: (_b = appState.currentApplication.value.config) === null || _b === void 0 ? void 0 : _b.userSpecificHomeDashboard });
        this.applyDashboardConfig(config);
    }
    applyDashboardConfig(config) {
        if (!config) {
            return;
        }
        if (config.dashboardName) {
            this.dashboardName = config.dashboardName;
        }
        if (config.defaultWidgets) {
            this.defaultWidgets = config.defaultWidgets;
        }
        if (config.userSpecific && this.appState.currentUser.value) {
            this.dashboardName = `${this.appState.currentUser.value.userName.replace(/\./g, '__')}_${this.dashboardName}`;
        }
        if (config.pageTitle) {
            this.pageTitle = config.pageTitle;
        }
    }
}
CockpitDashboardComponent.ɵfac = function CockpitDashboardComponent_Factory(t) { return new (t || CockpitDashboardComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.AppStateService), ɵngcc0.ɵɵdirectiveInject(COCKPIT_HOME_DASHBOARD_CONFIG, 8)); };
CockpitDashboardComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: CockpitDashboardComponent, selectors: [["c8y-cockpit-dashboard"]], decls: 5, vars: 6, consts: [["src", "/users-guide/cockpit/#dashboards"], [3, "name", "defaultWidgets", "canDelete"]], template: function CockpitDashboardComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "c8y-title");
        ɵngcc0.ɵɵtext(1);
        ɵngcc0.ɵɵpipe(2, "translate");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelement(3, "c8y-help", 0);
        ɵngcc0.ɵɵelement(4, "c8y-context-dashboard", 1);
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵtextInterpolate1(" ", ɵngcc0.ɵɵpipeBind1(2, 4, ctx.pageTitle), "\n");
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵproperty("name", ctx.dashboardName)("defaultWidgets", ctx.defaultWidgets)("canDelete", false);
    } }, directives: [ɵngcc1.TitleComponent, ɵngcc1.HelpComponent, ɵngcc2.ContextDashboardComponent], pipes: [ɵngcc1.C8yTranslatePipe], encapsulation: 2 });
CockpitDashboardComponent.ctorParameters = () => [
    { type: AppStateService },
    { type: undefined, decorators: [{ type: Optional }, { type: Inject, args: [COCKPIT_HOME_DASHBOARD_CONFIG,] }] }
];
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(CockpitDashboardComponent, [{
        type: Component,
        args: [{
                selector: 'c8y-cockpit-dashboard',
                template: "<c8y-title>\n  {{ pageTitle | translate }}\n</c8y-title>\n\n<c8y-help src=\"/users-guide/cockpit/#dashboards\"></c8y-help>\n\n<c8y-context-dashboard\n  [name]=\"dashboardName\"\n  [defaultWidgets]=\"defaultWidgets\"\n  [canDelete]=\"false\"\n></c8y-context-dashboard>\n"
            }]
    }], function () { return [{ type: ɵngcc1.AppStateService }, { type: undefined, decorators: [{
                type: Optional
            }, {
                type: Inject,
                args: [COCKPIT_HOME_DASHBOARD_CONFIG]
            }] }]; }, null); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29ja3BpdC1kYXNoYm9hcmQuY29tcG9uZW50LmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9jb250ZXh0LWRhc2hib2FyZC9jb2NrcGl0LWRhc2hib2FyZC9jb2NrcGl0LWRhc2hib2FyZC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzVELE9BQU8sRUFBRSxlQUFlLEVBQUUsT0FBTyxFQUFVLE1BQU0scUJBQXFCLENBQUM7QUFDdkUsT0FBTyxFQUVMLDZCQUE2QixFQUM3Qiw0QkFBNEIsRUFDN0IsTUFBTSwyQkFBMkIsQ0FBQzs7OztBQU1uQyxNQUFNLE9BQU8seUJBQXlCO0FBQ3RDLElBSUUsWUFDVSxRQUF5QixFQUd6QixtQkFBMkM7QUFDcEQ7QUFDYyxRQUxMLGFBQVEsR0FBUixRQUFRLENBQWlCO0FBQUMsUUFHMUIsd0JBQW1CLEdBQW5CLG1CQUFtQixDQUF3QjtBQUN2RCxRQVRFLG1CQUFjLEdBQUcsNEJBQTRCLENBQUM7QUFDaEQsUUFBRSxrQkFBYSxHQUFHLGVBQWUsQ0FBQztBQUNsQyxRQUFFLGNBQVMsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDOUIsUUFPSSxNQUFNLE1BQU0sbUNBQ1AsSUFBSSxDQUFDLG1CQUFtQixLQUMzQixhQUFhLEVBQUUsTUFBQSxRQUFRLENBQUMsa0JBQWtCLENBQUMsS0FBSyxDQUFDLE1BQU0sMENBQUUsaUJBQWlCLEVBQzFFLFlBQVksRUFBRSxNQUFBLFFBQVEsQ0FBQyxrQkFBa0IsQ0FBQyxLQUFLLENBQUMsTUFBTSwwQ0FBRSx5QkFBeUIsR0FDbEYsQ0FBQztBQUNOLFFBQUksSUFBSSxDQUFDLG9CQUFvQixDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ3RDLElBQUUsQ0FBQztBQUNILElBQ1Usb0JBQW9CLENBQUMsTUFBOEI7QUFDN0QsUUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFO0FBQ2pCLFlBQU0sT0FBTztBQUNiLFNBQUs7QUFDTCxRQUNJLElBQUksTUFBTSxDQUFDLGFBQWEsRUFBRTtBQUM5QixZQUFNLElBQUksQ0FBQyxhQUFhLEdBQUcsTUFBTSxDQUFDLGFBQWEsQ0FBQztBQUNoRCxTQUFLO0FBQ0wsUUFDSSxJQUFJLE1BQU0sQ0FBQyxjQUFjLEVBQUU7QUFDL0IsWUFBTSxJQUFJLENBQUMsY0FBYyxHQUFHLE1BQU0sQ0FBQyxjQUFjLENBQUM7QUFDbEQsU0FBSztBQUNMLFFBQ0ksSUFBSSxNQUFNLENBQUMsWUFBWSxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLEtBQUssRUFBRTtBQUNoRSxZQUFNLElBQUksQ0FBQyxhQUFhLEdBQUcsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLElBQ25GLElBQUksQ0FBQyxhQUNQLEVBQUUsQ0FBQztBQUNULFNBQUs7QUFDTCxRQUNJLElBQUksTUFBTSxDQUFDLFNBQVMsRUFBRTtBQUMxQixZQUFNLElBQUksQ0FBQyxTQUFTLEdBQUcsTUFBTSxDQUFDLFNBQVMsQ0FBQztBQUN4QyxTQUFLO0FBQ0wsSUFBRSxDQUFDO0FBQ0g7cURBOUNDLFNBQVMsU0FBQyxrQkFDVCxRQUFRLEVBQUUsdUJBQXVCLGtCQUNqQztzTEFBaUQsY0FDbEQ7Ozs7Ozs7Ozs7Ozs0SkFDSTtBQUFDO0FBQ1UsWUFaUCxlQUFlO0FBQUksNENBa0J2QixRQUFRLFlBQ1IsTUFBTSxTQUFDLDZCQUE2QjtBQUNuQzs7Ozs7Ozs7Ozs7O2tDQUFFO0FBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEluamVjdCwgT3B0aW9uYWwgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEFwcFN0YXRlU2VydmljZSwgZ2V0dGV4dCwgV2lkZ2V0IH0gZnJvbSAnQGM4eS9uZ3gtY29tcG9uZW50cyc7XG5pbXBvcnQge1xuICBDb2NrcGl0RGFzaGJvYXJkQ29uZmlnLFxuICBDT0NLUElUX0hPTUVfREFTSEJPQVJEX0NPTkZJRyxcbiAgREVGQVVMVF9DT0NLUElUX0hPTUVfV0lER0VUU1xufSBmcm9tICcuL2NvY2twaXQtZGFzaGJvYXJkLm1vZGVsJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYzh5LWNvY2twaXQtZGFzaGJvYXJkJyxcbiAgdGVtcGxhdGVVcmw6ICcuL2NvY2twaXQtZGFzaGJvYXJkLmNvbXBvbmVudC5odG1sJ1xufSlcbmV4cG9ydCBjbGFzcyBDb2NrcGl0RGFzaGJvYXJkQ29tcG9uZW50IHtcbiAgZGVmYXVsdFdpZGdldHMgPSBERUZBVUxUX0NPQ0tQSVRfSE9NRV9XSURHRVRTO1xuICBkYXNoYm9hcmROYW1lID0gJ2hvbWUtY29ja3BpdDEnO1xuICBwYWdlVGl0bGUgPSBnZXR0ZXh0KCdIb21lJyk7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBhcHBTdGF0ZTogQXBwU3RhdGVTZXJ2aWNlLFxuICAgIEBPcHRpb25hbCgpXG4gICAgQEluamVjdChDT0NLUElUX0hPTUVfREFTSEJPQVJEX0NPTkZJRylcbiAgICBwcml2YXRlIGhvbWVEYXNoYm9hcmRDb25maWc6IENvY2twaXREYXNoYm9hcmRDb25maWdcbiAgKSB7XG4gICAgY29uc3QgY29uZmlnID0ge1xuICAgICAgLi4udGhpcy5ob21lRGFzaGJvYXJkQ29uZmlnLFxuICAgICAgZGFzaGJvYXJkTmFtZTogYXBwU3RhdGUuY3VycmVudEFwcGxpY2F0aW9uLnZhbHVlLmNvbmZpZz8uaG9tZURhc2hib2FyZE5hbWUsXG4gICAgICB1c2VyU3BlY2lmaWM6IGFwcFN0YXRlLmN1cnJlbnRBcHBsaWNhdGlvbi52YWx1ZS5jb25maWc/LnVzZXJTcGVjaWZpY0hvbWVEYXNoYm9hcmRcbiAgICB9O1xuICAgIHRoaXMuYXBwbHlEYXNoYm9hcmRDb25maWcoY29uZmlnKTtcbiAgfVxuXG4gIHByaXZhdGUgYXBwbHlEYXNoYm9hcmRDb25maWcoY29uZmlnOiBDb2NrcGl0RGFzaGJvYXJkQ29uZmlnKSB7XG4gICAgaWYgKCFjb25maWcpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoY29uZmlnLmRhc2hib2FyZE5hbWUpIHtcbiAgICAgIHRoaXMuZGFzaGJvYXJkTmFtZSA9IGNvbmZpZy5kYXNoYm9hcmROYW1lO1xuICAgIH1cblxuICAgIGlmIChjb25maWcuZGVmYXVsdFdpZGdldHMpIHtcbiAgICAgIHRoaXMuZGVmYXVsdFdpZGdldHMgPSBjb25maWcuZGVmYXVsdFdpZGdldHM7XG4gICAgfVxuXG4gICAgaWYgKGNvbmZpZy51c2VyU3BlY2lmaWMgJiYgdGhpcy5hcHBTdGF0ZS5jdXJyZW50VXNlci52YWx1ZSkge1xuICAgICAgdGhpcy5kYXNoYm9hcmROYW1lID0gYCR7dGhpcy5hcHBTdGF0ZS5jdXJyZW50VXNlci52YWx1ZS51c2VyTmFtZS5yZXBsYWNlKC9cXC4vZywgJ19fJyl9XyR7XG4gICAgICAgIHRoaXMuZGFzaGJvYXJkTmFtZVxuICAgICAgfWA7XG4gICAgfVxuXG4gICAgaWYgKGNvbmZpZy5wYWdlVGl0bGUpIHtcbiAgICAgIHRoaXMucGFnZVRpdGxlID0gY29uZmlnLnBhZ2VUaXRsZTtcbiAgICB9XG4gIH1cbn1cbiJdfQ==