import { __awaiter } from "tslib";
import { Component, EventEmitter, Input, Output, ViewChild } from '@angular/core';
import { DataGridComponent, FilteringActionType, gettext } from '@c8y/ngx-components';
import { BehaviorSubject, combineLatest, of, Subject } from 'rxjs';
import { concatMap, filter as filterRxJS, first, map, switchMap, take, takeUntil, tap } from 'rxjs/operators';
import { DeviceGridService } from './device-grid.service';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from './device-grid.service';
import * as ɵngcc2 from '@c8y/ngx-components';
import * as ɵngcc3 from '@angular/common';

function DeviceGridComponent_ng_container_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelement(1, "c8y-column", 3);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const column_r1 = ctx.$implicit;
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("name", column_r1.name);
} }
export class DeviceGridComponent {
    constructor(deviceGridService) {
        this.deviceGridService = deviceGridService;
        /** Takes an event emitter. When an event is emitted, the grid will be reloaded. */
        this.refresh = new EventEmitter();
        /** The title for the data grid, it's displayed in the grid's header. */
        this.title = gettext('Devices');
        /** The label for load more button. */
        this.loadMoreItemsLabel = gettext('Load more devices');
        /** The label for loading indicator. */
        this.loadingItemsLabel = gettext('Loading devices…');
        /** Determines whether items can be selected by clicking a checkbox in the first column. */
        this.selectable = false;
        /** Sets the base query which is appended to the request for data. */
        this.baseQuery = {};
        this.childDeviceGrid = false;
        /** Sets the withChildren query which is appended to the request. */
        this.withChildren = false;
        /** Emits an event when columns configuration changes. */
        this.onColumnsChange = new EventEmitter();
        this.onFilterChange = new EventEmitter();
        this.onDeviceQueryStringChange = new EventEmitter();
        /** Emits an event when items selection changes. The array contains ids of selected items. */
        this.itemsSelect = new EventEmitter();
        this.configureColumnsEnabled = true;
        this.actionControls = [];
        this.columns$ = of(this.deviceGridService.getDefaultColumns());
        this.appliedFilters = [];
        this.pagination = this.deviceGridService.getDefaultPagination();
        this.bulkActionControls = this.deviceGridService.getDefaultBulkActionControls();
        this.headerActionControls = this.deviceGridService.getDefaultHeaderActionControls();
        /**
         * Manages the requests to the DeviceGridService.saveConfig$() method:
         * 0 - Semaphore is in initial state, request can be executed;
         * 1 - Semaphore is blocked, further requests need to wait for lock to get released;
         * 2 - Semaphore is "green", requests can be done;
         */
        this.saveGridConfigSemaphore$ = new BehaviorSubject(0);
        this.destroyed$ = new Subject();
        this.serverSideDataCallback = this.onDataSourceModifier.bind(this);
    }
    /** Pagination settings, e.g. allows for setting current page or page size. If not given, defaults to standard settings. */
    set _pagination(value) {
        if (value) {
            this.pagination = value;
        }
        else {
            this.pagination = this.deviceGridService.getDefaultPagination();
        }
    }
    /** Sets load more mode. */
    set _infiniteScroll(infiniteScroll) {
        this.infiniteScroll = infiniteScroll;
        if (infiniteScroll) {
            this.pagination = this.deviceGridService.getInfiniteScrollPagination();
        }
    }
    /** Sets action controls (actions available for individual items). If not given, it defaults to standard actions. */
    set _actionControls(value) {
        if (value) {
            this.actionControls = value;
        }
        else {
            this.actionControls = this.deviceGridService.getDefaultActionControls();
        }
    }
    /** Sets bulk action controls (actions available for items selected by user). If not given, it defaults to standard bulk actions. */
    set _bulkActionControls(value) {
        if (value) {
            this.bulkActionControls = value;
        }
        else {
            this.bulkActionControls = this.deviceGridService.getDefaultBulkActionControls();
        }
    }
    /** Sets header action controls (actions available from the grid header). If not given, it defaults to empty list of actions. */
    set _headerActionControls(value) {
        if (value) {
            this.headerActionControls = value;
        }
        else {
            this.headerActionControls = this.deviceGridService.getDefaultHeaderActionControls();
        }
    }
    ngOnInit() {
        this.setActionControls();
        if (this.columnsConfig && !this.columnsConfigKey) {
            this.columns$ = of(this.columnsConfig);
            this.configureColumnsEnabled = false;
            console.warn('Device grid expects columnsConfigKey to be set if setting customized columns list. Without it the changes to the grid wll not be saved anywhere.');
        }
        else {
            this.columns$ = this.deviceGridService.getUserConfiguredColumns$(this.columnsConfig ? this.columnsConfig : this.deviceGridService.getDefaultColumns(), this.columnsConfigKey);
        }
    }
    ngOnDestroy() {
        this.destroyed$.next();
        this.destroyed$.complete();
    }
    trackByName(_index, column) {
        return column.name;
    }
    onDataSourceModifier(dataSourceModifier) {
        return __awaiter(this, void 0, void 0, function* () {
            let serverSideDataResult;
            let filteredSize;
            let size;
            if (this.childDeviceGrid) {
                const { res, data, paging } = yield this.deviceGridService.getChildDeviceData(dataSourceModifier.columns, dataSourceModifier.pagination, this.baseQuery, this.withChildren, this.parentDeviceId);
                filteredSize = yield this.deviceGridService.getCountChildDevices(dataSourceModifier.columns, dataSourceModifier.pagination, this.baseQuery, this.parentDeviceId);
                size = yield this.deviceGridService.getTotalChildDevices(this.baseQuery, this.parentDeviceId);
                serverSideDataResult = {
                    res,
                    data,
                    paging,
                    filteredSize,
                    size
                };
            }
            else {
                const { res, data, paging } = yield this.deviceGridService.getData(dataSourceModifier.columns, dataSourceModifier.pagination, this.baseQuery, this.withChildren);
                filteredSize = yield this.deviceGridService.getCount(dataSourceModifier.columns, dataSourceModifier.pagination, this.baseQuery);
                size = yield this.deviceGridService.getTotal(this.baseQuery);
                serverSideDataResult = {
                    res,
                    data,
                    paging,
                    filteredSize,
                    size
                };
            }
            this.onColumnsChange.emit(dataSourceModifier.columns);
            this.onDeviceQueryStringChange.emit(this.deviceGridService.getDeviceQueryString(dataSourceModifier.columns, this.baseQuery));
            if (this.dataCallback) {
                serverSideDataResult = this.dataCallback(serverSideDataResult);
            }
            return serverSideDataResult;
        });
    }
    filterChange({ columnName, filteringModifier }) {
        const index = this.appliedFilters.findIndex(el => el.columnName === columnName);
        if (index > -1) {
            this.appliedFilters[index].filteringModifier = filteringModifier;
        }
        else {
            this.appliedFilters.push({ columnName, filteringModifier });
        }
        this.onFilterChange.emit(this.appliedFilters);
        this.updateFilterConfig(columnName, filteringModifier);
    }
    updateFilterConfig(columnName, filteringModifier) {
        // Here I needed to take the current columns because if there isn't any stored config
        // and custom columns are provided through parent element we need to use them.
        combineLatest([this.deviceGridService.getConfig$(this.columnsConfigKey), this.columns$])
            .pipe(tap(([config, columns]) => {
            var _a;
            const columnsConfig = (((_a = config === null || config === void 0 ? void 0 : config.columns) === null || _a === void 0 ? void 0 : _a.length) > 0 ? config.columns : columns).map(({ name, visible, sortOrder, filter, custom, header, path }) => ({
                name,
                visible: visible !== null && visible !== void 0 ? visible : true,
                sortOrder,
                custom,
                header,
                path,
                filter: columnName && columnName !== name ? filter : filteringModifier
            }));
            if (!columnsConfig.filter) {
                delete columnsConfig.filter;
            }
            this.configChange({ columns: columnsConfig, pagination: config.pagination });
        }), take(1), takeUntil(this.destroyed$))
            .subscribe();
    }
    setActionControls() {
        return __awaiter(this, void 0, void 0, function* () {
            const deleteAction = {
                type: "DELETE" /* Delete */,
                callback: (device) => this.onDeleteDevice(device)
            };
            this.actionControls.push(deleteAction);
        });
    }
    onDeleteDevice(device) {
        this.deviceGridService
            .delete(device)
            .then(() => this.refresh.emit())
            .catch(() => ({}));
    }
    updateFiltering(columnNames, action) {
        const { type } = action;
        if (type === FilteringActionType.ResetFilter) {
            this.dataGrid.clearFilters();
        }
        else {
            this.dataGrid.updateFiltering(columnNames, action);
        }
    }
    configChange(config) {
        /* Semaphore ensures that the first request to DeviceGridService.saveConfig$() is completed
         * before the next requests are sent out. This prevents multiple configuration objects to be
         * created in Inventory in case a config does not yet exist.
         */
        this.saveGridConfigSemaphore$
            .pipe(filterRxJS(semaphore => semaphore !== 1), tap(() => {
            if (this.saveGridConfigSemaphore$.value < 1) {
                this.saveGridConfigSemaphore$.next(this.saveGridConfigSemaphore$.value + 1);
            }
        }), concatMap(() => this.deviceGridService.saveConfig$(config, this.columnsConfigKey)), tap(() => {
            if (this.saveGridConfigSemaphore$.value < 2) {
                this.saveGridConfigSemaphore$.next(this.saveGridConfigSemaphore$.value + 1);
            }
        }), take(1), takeUntil(this.destroyed$))
            .subscribe();
    }
    addCustomColumn(columnConfig) {
        this.deviceGridService
            .getConfig$(this.columnsConfigKey)
            .pipe(tap(config => (config.columns = [
            ...(config.columns.length === 0 ? this.getDefalultConfigColumns() : config.columns),
            columnConfig
        ])), concatMap(config => this.deviceGridService.saveConfig$(config, this.columnsConfigKey)), switchMap(() => this.deviceGridService.getUserConfiguredColumns$(this.columns$, this.columnsConfigKey)), 
        // Let data-grid re-render with new columns;
        // Columns are set in a separate step in the pipe to avoid flickering
        // in the grid in the time where get config request is executing
        tap(columns => (this.columns$ = of(columns))), take(1), takeUntil(this.destroyed$))
            .subscribe();
    }
    removeCustomColumn(columnToRemove) {
        this.deviceGridService
            .getConfig$(this.columnsConfigKey)
            .pipe(first(), tap(config => (config.columns = config.columns.filter(column => column.name !== columnToRemove.name))), concatMap(config => this.deviceGridService.saveConfig$(config, this.columnsConfigKey)), switchMap(() => this.deviceGridService.getUserConfiguredColumns$(this.columns$.pipe(map(columns => columns.filter(column => column.name !== columnToRemove.name))), this.columnsConfigKey)), 
        // Let data-grid re-render with new columns;
        // Columns are set in a separate step in the pipe to avoid flickering
        // in the grid in the time where get config request is executing
        tap(columns => (this.columns$ = of(columns))), take(1), takeUntil(this.destroyed$))
            .subscribe();
    }
    getDefalultConfigColumns() {
        return this.deviceGridService
            .getDefaultColumns()
            .map(column => ({ name: column.name, visible: true }));
    }
}
DeviceGridComponent.ɵfac = function DeviceGridComponent_Factory(t) { return new (t || DeviceGridComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.DeviceGridService)); };
DeviceGridComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: DeviceGridComponent, selectors: [["c8y-device-grid"]], viewQuery: function DeviceGridComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(DataGridComponent, 7);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.dataGrid = _t.first);
    } }, inputs: { refresh: "refresh", title: "title", loadMoreItemsLabel: "loadMoreItemsLabel", loadingItemsLabel: "loadingItemsLabel", selectable: "selectable", baseQuery: "baseQuery", childDeviceGrid: "childDeviceGrid", withChildren: "withChildren", _pagination: ["pagination", "_pagination"], _infiniteScroll: ["infiniteScroll", "_infiniteScroll"], _actionControls: ["actionControls", "_actionControls"], _bulkActionControls: ["bulkActionControls", "_bulkActionControls"], _headerActionControls: ["headerActionControls", "_headerActionControls"], dataCallback: "dataCallback", columnsConfigKey: "columnsConfigKey", columnsConfig: ["columns", "columnsConfig"], parentDeviceId: "parentDeviceId" }, outputs: { onColumnsChange: "onColumnsChange", onFilterChange: "onFilterChange", onDeviceQueryStringChange: "onDeviceQueryStringChange", itemsSelect: "itemsSelect" }, decls: 7, vars: 27, consts: [[3, "title", "loadMoreItemsLabel", "loadingItemsLabel", "columns", "pagination", "infiniteScroll", "actionControls", "selectable", "bulkActionControls", "serverSideDataCallback", "refresh", "headerActionControls", "configureColumnsEnabled", "itemsSelect", "onConfigChange", "onAddCustomColumn", "onRemoveCustomColumn", "onFilter"], [3, "icon", "title", "subtitle", "horizontal"], [4, "ngFor", "ngForOf", "ngForTrackBy"], [3, "name"]], template: function DeviceGridComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "c8y-data-grid", 0);
        ɵngcc0.ɵɵlistener("itemsSelect", function DeviceGridComponent_Template_c8y_data_grid_itemsSelect_0_listener($event) { return ctx.itemsSelect.emit($event); })("onConfigChange", function DeviceGridComponent_Template_c8y_data_grid_onConfigChange_0_listener($event) { return ctx.configChange($event); })("onAddCustomColumn", function DeviceGridComponent_Template_c8y_data_grid_onAddCustomColumn_0_listener($event) { return ctx.addCustomColumn($event); })("onRemoveCustomColumn", function DeviceGridComponent_Template_c8y_data_grid_onRemoveCustomColumn_0_listener($event) { return ctx.removeCustomColumn($event); })("onFilter", function DeviceGridComponent_Template_c8y_data_grid_onFilter_0_listener($event) { return ctx.filterChange($event); });
        ɵngcc0.ɵɵpipe(1, "async");
        ɵngcc0.ɵɵelement(2, "c8y-ui-empty-state", 1);
        ɵngcc0.ɵɵpipe(3, "translate");
        ɵngcc0.ɵɵpipe(4, "translate");
        ɵngcc0.ɵɵtemplate(5, DeviceGridComponent_ng_container_5_Template, 2, 1, "ng-container", 2);
        ɵngcc0.ɵɵpipe(6, "async");
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("title", ctx.title)("loadMoreItemsLabel", ctx.loadMoreItemsLabel)("loadingItemsLabel", ctx.loadingItemsLabel)("columns", ɵngcc0.ɵɵpipeBind1(1, 19, ctx.columns$))("pagination", ctx.pagination)("infiniteScroll", ctx.infiniteScroll)("actionControls", ctx.actionControls)("selectable", ctx.selectable)("bulkActionControls", ctx.bulkActionControls)("serverSideDataCallback", ctx.serverSideDataCallback)("refresh", ctx.refresh)("headerActionControls", ctx.headerActionControls)("configureColumnsEnabled", ctx.configureColumnsEnabled);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("icon", "search")("title", ɵngcc0.ɵɵpipeBind1(3, 21, "No matching devices."))("subtitle", ɵngcc0.ɵɵpipeBind1(4, 23, "Refine your search terms"))("horizontal", true);
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(6, 25, ctx.columns$))("ngForTrackBy", ctx.trackByName);
    } }, directives: [ɵngcc2.DataGridComponent, ɵngcc2.EmptyStateComponent, ɵngcc3.NgForOf, ɵngcc2.ColumnDirective], pipes: [ɵngcc3.AsyncPipe, ɵngcc2.C8yTranslatePipe], encapsulation: 2 });
DeviceGridComponent.ctorParameters = () => [
    { type: DeviceGridService }
];
DeviceGridComponent.propDecorators = {
    dataCallback: [{ type: Input }],
    refresh: [{ type: Input }],
    title: [{ type: Input }],
    loadMoreItemsLabel: [{ type: Input }],
    loadingItemsLabel: [{ type: Input }],
    columnsConfigKey: [{ type: Input }],
    columnsConfig: [{ type: Input, args: ['columns',] }],
    _pagination: [{ type: Input, args: ['pagination',] }],
    _infiniteScroll: [{ type: Input, args: ['infiniteScroll',] }],
    _actionControls: [{ type: Input, args: ['actionControls',] }],
    selectable: [{ type: Input }],
    baseQuery: [{ type: Input }],
    _bulkActionControls: [{ type: Input, args: ['bulkActionControls',] }],
    _headerActionControls: [{ type: Input, args: ['headerActionControls',] }],
    childDeviceGrid: [{ type: Input }],
    parentDeviceId: [{ type: Input }],
    withChildren: [{ type: Input }],
    onColumnsChange: [{ type: Output }],
    onFilterChange: [{ type: Output }],
    onDeviceQueryStringChange: [{ type: Output }],
    itemsSelect: [{ type: Output }],
    dataGrid: [{ type: ViewChild, args: [DataGridComponent, { static: true },] }]
};
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(DeviceGridComponent, [{
        type: Component,
        args: [{
                selector: 'c8y-device-grid',
                template: "<c8y-data-grid\n  [title]=\"title\"\n  [loadMoreItemsLabel]=\"loadMoreItemsLabel\"\n  [loadingItemsLabel]=\"loadingItemsLabel\"\n  [columns]=\"columns$ | async\"\n  [pagination]=\"pagination\"\n  [infiniteScroll]=\"infiniteScroll\"\n  [actionControls]=\"actionControls\"\n  [selectable]=\"selectable\"\n  [bulkActionControls]=\"bulkActionControls\"\n  [serverSideDataCallback]=\"serverSideDataCallback\"\n  (itemsSelect)=\"itemsSelect.emit($event)\"\n  (onConfigChange)=\"configChange($event)\"\n  (onAddCustomColumn)=\"addCustomColumn($event)\"\n  (onRemoveCustomColumn)=\"removeCustomColumn($event)\"\n  (onFilter)=\"filterChange($event)\"\n  [refresh]=\"refresh\"\n  [headerActionControls]=\"headerActionControls\"\n  [configureColumnsEnabled]=\"configureColumnsEnabled\"\n>\n  <c8y-ui-empty-state\n    [icon]=\"'search'\"\n    [title]=\"'No matching devices.' | translate\"\n    [subtitle]=\"'Refine your search terms' | translate\"\n    [horizontal]=\"true\"\n  >\n  </c8y-ui-empty-state>\n\n  <ng-container *ngFor=\"let column of columns$ | async; trackBy: trackByName\">\n    <c8y-column [name]=\"column.name\"></c8y-column>\n  </ng-container>\n</c8y-data-grid>\n"
            }]
    }], function () { return [{ type: ɵngcc1.DeviceGridService }]; }, { refresh: [{
            type: Input
        }], title: [{
            type: Input
        }], loadMoreItemsLabel: [{
            type: Input
        }], loadingItemsLabel: [{
            type: Input
        }], selectable: [{
            type: Input
        }], baseQuery: [{
            type: Input
        }], childDeviceGrid: [{
            type: Input
        }], withChildren: [{
            type: Input
        }], onColumnsChange: [{
            type: Output
        }], onFilterChange: [{
            type: Output
        }], onDeviceQueryStringChange: [{
            type: Output
        }], itemsSelect: [{
            type: Output
        }], _pagination: [{
            type: Input,
            args: ['pagination']
        }], _infiniteScroll: [{
            type: Input,
            args: ['infiniteScroll']
        }], _actionControls: [{
            type: Input,
            args: ['actionControls']
        }], _bulkActionControls: [{
            type: Input,
            args: ['bulkActionControls']
        }], _headerActionControls: [{
            type: Input,
            args: ['headerActionControls']
        }], dataCallback: [{
            type: Input
        }], columnsConfigKey: [{
            type: Input
        }], columnsConfig: [{
            type: Input,
            args: ['columns']
        }], parentDeviceId: [{
            type: Input
        }], dataGrid: [{
            type: ViewChild,
            args: [DataGridComponent, { static: true }]
        }] }); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGV2aWNlLWdyaWQuY29tcG9uZW50LmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi9kZXZpY2UtZ3JpZC9kZXZpY2UtZ3JpZC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFDTCxTQUFTLEVBQ1QsWUFBWSxFQUNaLEtBQUssRUFHTCxNQUFNLEVBQ04sU0FBUyxFQUNWLE1BQU0sZUFBZSxDQUFDO0FBRXZCLE9BQU8sRUFNTCxpQkFBaUIsRUFFakIsbUJBQW1CLEVBRW5CLE9BQU8sRUFPUixNQUFNLHFCQUFxQixDQUFDO0FBQzdCLE9BQU8sRUFBRSxlQUFlLEVBQUUsYUFBYSxFQUFjLEVBQUUsRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDL0UsT0FBTyxFQUNMLFNBQVMsRUFDVCxNQUFNLElBQUksVUFBVSxFQUNwQixLQUFLLEVBQ0wsR0FBRyxFQUNILFNBQVMsRUFDVCxJQUFJLEVBQ0osU0FBUyxFQUNULEdBQUcsRUFDSixNQUFNLGdCQUFnQixDQUFDO0FBRXhCLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHVCQUF1QixDQUFDOzs7Ozs7Ozs7Ozs7Ozs7QUFNMUQsTUFBTSxPQUFPLG1CQUFtQjtBQUFHLElBOEZqQyxZQUFtQixpQkFBb0M7QUFDekQsUUFEcUIsc0JBQWlCLEdBQWpCLGlCQUFpQixDQUFtQjtBQUFDLFFBM0Z4RCxtRkFBbUY7QUFDckYsUUFBVyxZQUFPLEdBQXNCLElBQUksWUFBWSxFQUFFLENBQUM7QUFDM0QsUUFBRSx3RUFBd0U7QUFDMUUsUUFBVyxVQUFLLEdBQVcsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQzlDLFFBQUUsc0NBQXNDO0FBQ3hDLFFBQVcsdUJBQWtCLEdBQUcsT0FBTyxDQUFDLG1CQUFtQixDQUFDLENBQUM7QUFDN0QsUUFBRSx1Q0FBdUM7QUFDekMsUUFBVyxzQkFBaUIsR0FBVyxPQUFPLENBQUMsa0JBQWtCLENBQUMsQ0FBQztBQUNuRSxRQTRCRSwyRkFBMkY7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QUMsZ0JBQWdCO0FBQU8seUJBUTdCLEtBQUs7QUFBSyx3QkFFVixLQUFLO0FBQUssa0NBRVYsS0FBSyxTQUFDLG9CQUFvQjtBQUFPLG9DQVFqQyxLQUFLLFNBQUMsc0JBQXNCO0FBQU8sOEJBT25DLEtBQUs7QUFBSyw2QkFDVixLQUFLO0FBQUssMkJBRVYsS0FBSztBQUFLLDhCQUVWLE1BQU07QUFBSyw2QkFHWCxNQUFNO0FBQUssd0NBQ1gsTUFBTTtBQUFLLDBCQUVYLE1BQU07QUFBSyx1QkFZWCxTQUFTLFNBQUMsaUJBQWlCLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFO0FBQzVDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQUFFO0FBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBDb21wb25lbnQsXG4gIEV2ZW50RW1pdHRlcixcbiAgSW5wdXQsXG4gIE9uRGVzdHJveSxcbiAgT25Jbml0LFxuICBPdXRwdXQsXG4gIFZpZXdDaGlsZFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IElNYW5hZ2VkT2JqZWN0IH0gZnJvbSAnQGM4eS9jbGllbnQnO1xuaW1wb3J0IHtcbiAgQWN0aW9uQ29udHJvbCxcbiAgQnVpbHRJbkFjdGlvblR5cGUsXG4gIEJ1bGtBY3Rpb25Db250cm9sLFxuICBDb2x1bW4sXG4gIEN1c3RvbUNvbHVtbkNvbmZpZyxcbiAgRGF0YUdyaWRDb21wb25lbnQsXG4gIERhdGFTb3VyY2VNb2RpZmllcixcbiAgRmlsdGVyaW5nQWN0aW9uVHlwZSxcbiAgRmlsdGVyaW5nTW9kaWZpZXIsXG4gIGdldHRleHQsXG4gIEdyaWRDb25maWcsXG4gIEhlYWRlckFjdGlvbkNvbnRyb2wsXG4gIExvYWRNb3JlTW9kZSxcbiAgUGFnaW5hdGlvbixcbiAgUm93LFxuICBTZXJ2ZXJTaWRlRGF0YVJlc3VsdFxufSBmcm9tICdAYzh5L25neC1jb21wb25lbnRzJztcbmltcG9ydCB7IEJlaGF2aW9yU3ViamVjdCwgY29tYmluZUxhdGVzdCwgT2JzZXJ2YWJsZSwgb2YsIFN1YmplY3QgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7XG4gIGNvbmNhdE1hcCxcbiAgZmlsdGVyIGFzIGZpbHRlclJ4SlMsXG4gIGZpcnN0LFxuICBtYXAsXG4gIHN3aXRjaE1hcCxcbiAgdGFrZSxcbiAgdGFrZVVudGlsLFxuICB0YXBcbn0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgRGF0YUNhbGxiYWNrLCBEZXZpY2VHcmlkQ29sdW1uLCBGaWx0ZXJDb25maWcgfSBmcm9tICcuL2RldmljZS1ncmlkLm1vZGVsJztcbmltcG9ydCB7IERldmljZUdyaWRTZXJ2aWNlIH0gZnJvbSAnLi9kZXZpY2UtZ3JpZC5zZXJ2aWNlJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYzh5LWRldmljZS1ncmlkJyxcbiAgdGVtcGxhdGVVcmw6ICcuL2RldmljZS1ncmlkLmNvbXBvbmVudC5odG1sJ1xufSlcbmV4cG9ydCBjbGFzcyBEZXZpY2VHcmlkQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3kge1xuICAvKiogT3B0aW9uYWwgY2FsbGJhY2sgZnVuY3Rpb24gdGhhdCBhbGxvd3MgdG8gbW9kaWZ5IHNlcnZlciBzaWRlIGRhdGEgcmVzdWx0IGJlZm9yZSBpdCdzIHJlbmRlcmVkLiAqL1xuICBASW5wdXQoKSBkYXRhQ2FsbGJhY2s6IERhdGFDYWxsYmFjaztcbiAgLyoqIFRha2VzIGFuIGV2ZW50IGVtaXR0ZXIuIFdoZW4gYW4gZXZlbnQgaXMgZW1pdHRlZCwgdGhlIGdyaWQgd2lsbCBiZSByZWxvYWRlZC4gKi9cbiAgQElucHV0KCkgcmVmcmVzaDogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIC8qKiBUaGUgdGl0bGUgZm9yIHRoZSBkYXRhIGdyaWQsIGl0J3MgZGlzcGxheWVkIGluIHRoZSBncmlkJ3MgaGVhZGVyLiAqL1xuICBASW5wdXQoKSB0aXRsZTogc3RyaW5nID0gZ2V0dGV4dCgnRGV2aWNlcycpO1xuICAvKiogVGhlIGxhYmVsIGZvciBsb2FkIG1vcmUgYnV0dG9uLiAqL1xuICBASW5wdXQoKSBsb2FkTW9yZUl0ZW1zTGFiZWwgPSBnZXR0ZXh0KCdMb2FkIG1vcmUgZGV2aWNlcycpO1xuICAvKiogVGhlIGxhYmVsIGZvciBsb2FkaW5nIGluZGljYXRvci4gKi9cbiAgQElucHV0KCkgbG9hZGluZ0l0ZW1zTGFiZWw6IHN0cmluZyA9IGdldHRleHQoJ0xvYWRpbmcgZGV2aWNlc+KApicpO1xuICAvKiogVGhlIG5hbWUgb2YgdGhlIGtleSB3aGVyZSBjb2x1bW5zIGNvbmZpZ3VyYXRpb24gd2lsbCBiZSBzdG9yZWQuICovXG4gIEBJbnB1dCgpIGNvbHVtbnNDb25maWdLZXk6IHN0cmluZztcbiAgLyoqIFRoZSBsaXN0IG9mIGNvbHVtbnMgdG8gYmUgZGlzcGxheWVkIGluIHRoZSBncmlkLiBJZiBub3QgZ2l2ZW4sIGl0IGRlZmF1bHRzIHRvIHN0YW5kYXJkIGNvbHVtbnMuICovXG4gIEBJbnB1dCgnY29sdW1ucycpIGNvbHVtbnNDb25maWc6IERldmljZUdyaWRDb2x1bW5bXTtcbiAgLyoqIFBhZ2luYXRpb24gc2V0dGluZ3MsIGUuZy4gYWxsb3dzIGZvciBzZXR0aW5nIGN1cnJlbnQgcGFnZSBvciBwYWdlIHNpemUuIElmIG5vdCBnaXZlbiwgZGVmYXVsdHMgdG8gc3RhbmRhcmQgc2V0dGluZ3MuICovXG4gIEBJbnB1dCgncGFnaW5hdGlvbicpIHNldCBfcGFnaW5hdGlvbih2YWx1ZTogUGFnaW5hdGlvbikge1xuICAgIGlmICh2YWx1ZSkge1xuICAgICAgdGhpcy5wYWdpbmF0aW9uID0gdmFsdWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucGFnaW5hdGlvbiA9IHRoaXMuZGV2aWNlR3JpZFNlcnZpY2UuZ2V0RGVmYXVsdFBhZ2luYXRpb24oKTtcbiAgICB9XG4gIH1cbiAgaW5maW5pdGVTY3JvbGw6IExvYWRNb3JlTW9kZTtcbiAgLyoqIFNldHMgbG9hZCBtb3JlIG1vZGUuICovXG4gIEBJbnB1dCgnaW5maW5pdGVTY3JvbGwnKSBzZXQgX2luZmluaXRlU2Nyb2xsKGluZmluaXRlU2Nyb2xsOiBMb2FkTW9yZU1vZGUpIHtcbiAgICB0aGlzLmluZmluaXRlU2Nyb2xsID0gaW5maW5pdGVTY3JvbGw7XG4gICAgaWYgKGluZmluaXRlU2Nyb2xsKSB7XG4gICAgICB0aGlzLnBhZ2luYXRpb24gPSB0aGlzLmRldmljZUdyaWRTZXJ2aWNlLmdldEluZmluaXRlU2Nyb2xsUGFnaW5hdGlvbigpO1xuICAgIH1cbiAgfVxuICAvKiogU2V0cyBhY3Rpb24gY29udHJvbHMgKGFjdGlvbnMgYXZhaWxhYmxlIGZvciBpbmRpdmlkdWFsIGl0ZW1zKS4gSWYgbm90IGdpdmVuLCBpdCBkZWZhdWx0cyB0byBzdGFuZGFyZCBhY3Rpb25zLiAqL1xuICBASW5wdXQoJ2FjdGlvbkNvbnRyb2xzJykgc2V0IF9hY3Rpb25Db250cm9scyh2YWx1ZTogQWN0aW9uQ29udHJvbFtdKSB7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICB0aGlzLmFjdGlvbkNvbnRyb2xzID0gdmFsdWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYWN0aW9uQ29udHJvbHMgPSB0aGlzLmRldmljZUdyaWRTZXJ2aWNlLmdldERlZmF1bHRBY3Rpb25Db250cm9scygpO1xuICAgIH1cbiAgfVxuICAvKiogRGV0ZXJtaW5lcyB3aGV0aGVyIGl0ZW1zIGNhbiBiZSBzZWxlY3RlZCBieSBjbGlja2luZyBhIGNoZWNrYm94IGluIHRoZSBmaXJzdCBjb2x1bW4uICovXG4gIEBJbnB1dCgpIHNlbGVjdGFibGU6IGJvb2xlYW4gPSBmYWxzZTtcbiAgLyoqIFNldHMgdGhlIGJhc2UgcXVlcnkgd2hpY2ggaXMgYXBwZW5kZWQgdG8gdGhlIHJlcXVlc3QgZm9yIGRhdGEuICovXG4gIEBJbnB1dCgpIGJhc2VRdWVyeTogYW55ID0ge307XG4gIC8qKiBTZXRzIGJ1bGsgYWN0aW9uIGNvbnRyb2xzIChhY3Rpb25zIGF2YWlsYWJsZSBmb3IgaXRlbXMgc2VsZWN0ZWQgYnkgdXNlcikuIElmIG5vdCBnaXZlbiwgaXQgZGVmYXVsdHMgdG8gc3RhbmRhcmQgYnVsayBhY3Rpb25zLiAqL1xuICBASW5wdXQoJ2J1bGtBY3Rpb25Db250cm9scycpIHNldCBfYnVsa0FjdGlvbkNvbnRyb2xzKHZhbHVlOiBCdWxrQWN0aW9uQ29udHJvbFtdKSB7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICB0aGlzLmJ1bGtBY3Rpb25Db250cm9scyA9IHZhbHVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmJ1bGtBY3Rpb25Db250cm9scyA9IHRoaXMuZGV2aWNlR3JpZFNlcnZpY2UuZ2V0RGVmYXVsdEJ1bGtBY3Rpb25Db250cm9scygpO1xuICAgIH1cbiAgfVxuICAvKiogU2V0cyBoZWFkZXIgYWN0aW9uIGNvbnRyb2xzIChhY3Rpb25zIGF2YWlsYWJsZSBmcm9tIHRoZSBncmlkIGhlYWRlcikuIElmIG5vdCBnaXZlbiwgaXQgZGVmYXVsdHMgdG8gZW1wdHkgbGlzdCBvZiBhY3Rpb25zLiAqL1xuICBASW5wdXQoJ2hlYWRlckFjdGlvbkNvbnRyb2xzJykgc2V0IF9oZWFkZXJBY3Rpb25Db250cm9scyh2YWx1ZTogSGVhZGVyQWN0aW9uQ29udHJvbFtdKSB7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICB0aGlzLmhlYWRlckFjdGlvbkNvbnRyb2xzID0gdmFsdWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaGVhZGVyQWN0aW9uQ29udHJvbHMgPSB0aGlzLmRldmljZUdyaWRTZXJ2aWNlLmdldERlZmF1bHRIZWFkZXJBY3Rpb25Db250cm9scygpO1xuICAgIH1cbiAgfVxuICBASW5wdXQoKSBjaGlsZERldmljZUdyaWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgQElucHV0KCkgcGFyZW50RGV2aWNlSWQ6IHN0cmluZztcbiAgLyoqIFNldHMgdGhlIHdpdGhDaGlsZHJlbiBxdWVyeSB3aGljaCBpcyBhcHBlbmRlZCB0byB0aGUgcmVxdWVzdC4gKi9cbiAgQElucHV0KCkgd2l0aENoaWxkcmVuOiBib29sZWFuID0gZmFsc2U7XG4gIC8qKiBFbWl0cyBhbiBldmVudCB3aGVuIGNvbHVtbnMgY29uZmlndXJhdGlvbiBjaGFuZ2VzLiAqL1xuICBAT3V0cHV0KCkgb25Db2x1bW5zQ2hhbmdlOiBFdmVudEVtaXR0ZXI8RGV2aWNlR3JpZENvbHVtbltdPiA9IG5ldyBFdmVudEVtaXR0ZXI8XG4gICAgRGV2aWNlR3JpZENvbHVtbltdXG4gID4oKTtcbiAgQE91dHB1dCgpIG9uRmlsdGVyQ2hhbmdlOiBFdmVudEVtaXR0ZXI8RmlsdGVyQ29uZmlnW10+ID0gbmV3IEV2ZW50RW1pdHRlcjxGaWx0ZXJDb25maWdbXT4oKTtcbiAgQE91dHB1dCgpIG9uRGV2aWNlUXVlcnlTdHJpbmdDaGFuZ2U6IEV2ZW50RW1pdHRlcjxzdHJpbmc+ID0gbmV3IEV2ZW50RW1pdHRlcjxzdHJpbmc+KCk7XG4gIC8qKiBFbWl0cyBhbiBldmVudCB3aGVuIGl0ZW1zIHNlbGVjdGlvbiBjaGFuZ2VzLiBUaGUgYXJyYXkgY29udGFpbnMgaWRzIG9mIHNlbGVjdGVkIGl0ZW1zLiAqL1xuICBAT3V0cHV0KCkgaXRlbXNTZWxlY3QgPSBuZXcgRXZlbnRFbWl0dGVyPHN0cmluZ1tdPigpO1xuXG4gIGNvbmZpZ3VyZUNvbHVtbnNFbmFibGVkOiBib29sZWFuID0gdHJ1ZTtcbiAgYWN0aW9uQ29udHJvbHM6IEFjdGlvbkNvbnRyb2xbXSA9IFtdO1xuICBjb2x1bW5zJDogT2JzZXJ2YWJsZTxEZXZpY2VHcmlkQ29sdW1uW10+ID0gb2YodGhpcy5kZXZpY2VHcmlkU2VydmljZS5nZXREZWZhdWx0Q29sdW1ucygpKTtcbiAgYXBwbGllZEZpbHRlcnM6IEZpbHRlckNvbmZpZ1tdID0gW107XG4gIHBhZ2luYXRpb246IFBhZ2luYXRpb24gPSB0aGlzLmRldmljZUdyaWRTZXJ2aWNlLmdldERlZmF1bHRQYWdpbmF0aW9uKCk7XG4gIGJ1bGtBY3Rpb25Db250cm9sczogQnVsa0FjdGlvbkNvbnRyb2xbXSA9IHRoaXMuZGV2aWNlR3JpZFNlcnZpY2UuZ2V0RGVmYXVsdEJ1bGtBY3Rpb25Db250cm9scygpO1xuICBoZWFkZXJBY3Rpb25Db250cm9sczogSGVhZGVyQWN0aW9uQ29udHJvbFtdID1cbiAgICB0aGlzLmRldmljZUdyaWRTZXJ2aWNlLmdldERlZmF1bHRIZWFkZXJBY3Rpb25Db250cm9scygpO1xuICBzZXJ2ZXJTaWRlRGF0YUNhbGxiYWNrOiBhbnk7XG5cbiAgQFZpZXdDaGlsZChEYXRhR3JpZENvbXBvbmVudCwgeyBzdGF0aWM6IHRydWUgfSlcbiAgZGF0YUdyaWQ6IERhdGFHcmlkQ29tcG9uZW50O1xuXG4gIC8qKlxuICAgKiBNYW5hZ2VzIHRoZSByZXF1ZXN0cyB0byB0aGUgRGV2aWNlR3JpZFNlcnZpY2Uuc2F2ZUNvbmZpZyQoKSBtZXRob2Q6XG4gICAqIDAgLSBTZW1hcGhvcmUgaXMgaW4gaW5pdGlhbCBzdGF0ZSwgcmVxdWVzdCBjYW4gYmUgZXhlY3V0ZWQ7XG4gICAqIDEgLSBTZW1hcGhvcmUgaXMgYmxvY2tlZCwgZnVydGhlciByZXF1ZXN0cyBuZWVkIHRvIHdhaXQgZm9yIGxvY2sgdG8gZ2V0IHJlbGVhc2VkO1xuICAgKiAyIC0gU2VtYXBob3JlIGlzIFwiZ3JlZW5cIiwgcmVxdWVzdHMgY2FuIGJlIGRvbmU7XG4gICAqL1xuICBwcml2YXRlIHNhdmVHcmlkQ29uZmlnU2VtYXBob3JlJDogQmVoYXZpb3JTdWJqZWN0PG51bWJlcj4gPSBuZXcgQmVoYXZpb3JTdWJqZWN0KDApO1xuICBwcml2YXRlIGRlc3Ryb3llZCQ6IFN1YmplY3Q8dm9pZD4gPSBuZXcgU3ViamVjdCgpO1xuXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBkZXZpY2VHcmlkU2VydmljZTogRGV2aWNlR3JpZFNlcnZpY2UpIHtcbiAgICB0aGlzLnNlcnZlclNpZGVEYXRhQ2FsbGJhY2sgPSB0aGlzLm9uRGF0YVNvdXJjZU1vZGlmaWVyLmJpbmQodGhpcyk7XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICB0aGlzLnNldEFjdGlvbkNvbnRyb2xzKCk7XG5cbiAgICBpZiAodGhpcy5jb2x1bW5zQ29uZmlnICYmICF0aGlzLmNvbHVtbnNDb25maWdLZXkpIHtcbiAgICAgIHRoaXMuY29sdW1ucyQgPSBvZih0aGlzLmNvbHVtbnNDb25maWcpO1xuICAgICAgdGhpcy5jb25maWd1cmVDb2x1bW5zRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAnRGV2aWNlIGdyaWQgZXhwZWN0cyBjb2x1bW5zQ29uZmlnS2V5IHRvIGJlIHNldCBpZiBzZXR0aW5nIGN1c3RvbWl6ZWQgY29sdW1ucyBsaXN0LiBXaXRob3V0IGl0IHRoZSBjaGFuZ2VzIHRvIHRoZSBncmlkIHdsbCBub3QgYmUgc2F2ZWQgYW55d2hlcmUuJ1xuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jb2x1bW5zJCA9IHRoaXMuZGV2aWNlR3JpZFNlcnZpY2UuZ2V0VXNlckNvbmZpZ3VyZWRDb2x1bW5zJChcbiAgICAgICAgdGhpcy5jb2x1bW5zQ29uZmlnID8gdGhpcy5jb2x1bW5zQ29uZmlnIDogdGhpcy5kZXZpY2VHcmlkU2VydmljZS5nZXREZWZhdWx0Q29sdW1ucygpLFxuICAgICAgICB0aGlzLmNvbHVtbnNDb25maWdLZXlcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XG4gICAgdGhpcy5kZXN0cm95ZWQkLm5leHQoKTtcbiAgICB0aGlzLmRlc3Ryb3llZCQuY29tcGxldGUoKTtcbiAgfVxuXG4gIHRyYWNrQnlOYW1lKF9pbmRleCwgY29sdW1uOiBEZXZpY2VHcmlkQ29sdW1uKTogc3RyaW5nIHtcbiAgICByZXR1cm4gY29sdW1uLm5hbWU7XG4gIH1cblxuICBhc3luYyBvbkRhdGFTb3VyY2VNb2RpZmllcihcbiAgICBkYXRhU291cmNlTW9kaWZpZXI6IERhdGFTb3VyY2VNb2RpZmllclxuICApOiBQcm9taXNlPFNlcnZlclNpZGVEYXRhUmVzdWx0PiB7XG4gICAgbGV0IHNlcnZlclNpZGVEYXRhUmVzdWx0OiBTZXJ2ZXJTaWRlRGF0YVJlc3VsdDtcbiAgICBsZXQgZmlsdGVyZWRTaXplOiBudW1iZXI7XG4gICAgbGV0IHNpemU6IG51bWJlcjtcbiAgICBpZiAodGhpcy5jaGlsZERldmljZUdyaWQpIHtcbiAgICAgIGNvbnN0IHsgcmVzLCBkYXRhLCBwYWdpbmcgfSA9IGF3YWl0IHRoaXMuZGV2aWNlR3JpZFNlcnZpY2UuZ2V0Q2hpbGREZXZpY2VEYXRhKFxuICAgICAgICBkYXRhU291cmNlTW9kaWZpZXIuY29sdW1ucyxcbiAgICAgICAgZGF0YVNvdXJjZU1vZGlmaWVyLnBhZ2luYXRpb24sXG4gICAgICAgIHRoaXMuYmFzZVF1ZXJ5LFxuICAgICAgICB0aGlzLndpdGhDaGlsZHJlbixcbiAgICAgICAgdGhpcy5wYXJlbnREZXZpY2VJZFxuICAgICAgKTtcblxuICAgICAgZmlsdGVyZWRTaXplID0gYXdhaXQgdGhpcy5kZXZpY2VHcmlkU2VydmljZS5nZXRDb3VudENoaWxkRGV2aWNlcyhcbiAgICAgICAgZGF0YVNvdXJjZU1vZGlmaWVyLmNvbHVtbnMsXG4gICAgICAgIGRhdGFTb3VyY2VNb2RpZmllci5wYWdpbmF0aW9uLFxuICAgICAgICB0aGlzLmJhc2VRdWVyeSxcbiAgICAgICAgdGhpcy5wYXJlbnREZXZpY2VJZFxuICAgICAgKTtcbiAgICAgIHNpemUgPSBhd2FpdCB0aGlzLmRldmljZUdyaWRTZXJ2aWNlLmdldFRvdGFsQ2hpbGREZXZpY2VzKHRoaXMuYmFzZVF1ZXJ5LCB0aGlzLnBhcmVudERldmljZUlkKTtcblxuICAgICAgc2VydmVyU2lkZURhdGFSZXN1bHQgPSB7XG4gICAgICAgIHJlcyxcbiAgICAgICAgZGF0YSxcbiAgICAgICAgcGFnaW5nLFxuICAgICAgICBmaWx0ZXJlZFNpemUsXG4gICAgICAgIHNpemVcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHsgcmVzLCBkYXRhLCBwYWdpbmcgfSA9IGF3YWl0IHRoaXMuZGV2aWNlR3JpZFNlcnZpY2UuZ2V0RGF0YShcbiAgICAgICAgZGF0YVNvdXJjZU1vZGlmaWVyLmNvbHVtbnMsXG4gICAgICAgIGRhdGFTb3VyY2VNb2RpZmllci5wYWdpbmF0aW9uLFxuICAgICAgICB0aGlzLmJhc2VRdWVyeSxcbiAgICAgICAgdGhpcy53aXRoQ2hpbGRyZW5cbiAgICAgICk7XG5cbiAgICAgIGZpbHRlcmVkU2l6ZSA9IGF3YWl0IHRoaXMuZGV2aWNlR3JpZFNlcnZpY2UuZ2V0Q291bnQoXG4gICAgICAgIGRhdGFTb3VyY2VNb2RpZmllci5jb2x1bW5zLFxuICAgICAgICBkYXRhU291cmNlTW9kaWZpZXIucGFnaW5hdGlvbixcbiAgICAgICAgdGhpcy5iYXNlUXVlcnlcbiAgICAgICk7XG4gICAgICBzaXplID0gYXdhaXQgdGhpcy5kZXZpY2VHcmlkU2VydmljZS5nZXRUb3RhbCh0aGlzLmJhc2VRdWVyeSk7XG5cbiAgICAgIHNlcnZlclNpZGVEYXRhUmVzdWx0ID0ge1xuICAgICAgICByZXMsXG4gICAgICAgIGRhdGEsXG4gICAgICAgIHBhZ2luZyxcbiAgICAgICAgZmlsdGVyZWRTaXplLFxuICAgICAgICBzaXplXG4gICAgICB9O1xuICAgIH1cblxuICAgIHRoaXMub25Db2x1bW5zQ2hhbmdlLmVtaXQoZGF0YVNvdXJjZU1vZGlmaWVyLmNvbHVtbnMpO1xuICAgIHRoaXMub25EZXZpY2VRdWVyeVN0cmluZ0NoYW5nZS5lbWl0KFxuICAgICAgdGhpcy5kZXZpY2VHcmlkU2VydmljZS5nZXREZXZpY2VRdWVyeVN0cmluZyhkYXRhU291cmNlTW9kaWZpZXIuY29sdW1ucywgdGhpcy5iYXNlUXVlcnkpXG4gICAgKTtcblxuICAgIGlmICh0aGlzLmRhdGFDYWxsYmFjaykge1xuICAgICAgc2VydmVyU2lkZURhdGFSZXN1bHQgPSB0aGlzLmRhdGFDYWxsYmFjayhzZXJ2ZXJTaWRlRGF0YVJlc3VsdCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHNlcnZlclNpZGVEYXRhUmVzdWx0O1xuICB9XG5cbiAgZmlsdGVyQ2hhbmdlKHsgY29sdW1uTmFtZSwgZmlsdGVyaW5nTW9kaWZpZXIgfSkge1xuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5hcHBsaWVkRmlsdGVycy5maW5kSW5kZXgoZWwgPT4gZWwuY29sdW1uTmFtZSA9PT0gY29sdW1uTmFtZSk7XG5cbiAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgdGhpcy5hcHBsaWVkRmlsdGVyc1tpbmRleF0uZmlsdGVyaW5nTW9kaWZpZXIgPSBmaWx0ZXJpbmdNb2RpZmllcjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5hcHBsaWVkRmlsdGVycy5wdXNoKHsgY29sdW1uTmFtZSwgZmlsdGVyaW5nTW9kaWZpZXIgfSk7XG4gICAgfVxuXG4gICAgdGhpcy5vbkZpbHRlckNoYW5nZS5lbWl0KHRoaXMuYXBwbGllZEZpbHRlcnMpO1xuICAgIHRoaXMudXBkYXRlRmlsdGVyQ29uZmlnKGNvbHVtbk5hbWUsIGZpbHRlcmluZ01vZGlmaWVyKTtcbiAgfVxuXG4gIHVwZGF0ZUZpbHRlckNvbmZpZyhjb2x1bW5OYW1lLCBmaWx0ZXJpbmdNb2RpZmllcikge1xuICAgIC8vIEhlcmUgSSBuZWVkZWQgdG8gdGFrZSB0aGUgY3VycmVudCBjb2x1bW5zIGJlY2F1c2UgaWYgdGhlcmUgaXNuJ3QgYW55IHN0b3JlZCBjb25maWdcbiAgICAvLyBhbmQgY3VzdG9tIGNvbHVtbnMgYXJlIHByb3ZpZGVkIHRocm91Z2ggcGFyZW50IGVsZW1lbnQgd2UgbmVlZCB0byB1c2UgdGhlbS5cbiAgICBjb21iaW5lTGF0ZXN0KFt0aGlzLmRldmljZUdyaWRTZXJ2aWNlLmdldENvbmZpZyQodGhpcy5jb2x1bW5zQ29uZmlnS2V5KSwgdGhpcy5jb2x1bW5zJF0pXG4gICAgICAucGlwZShcbiAgICAgICAgdGFwKChbY29uZmlnLCBjb2x1bW5zXSkgPT4ge1xuICAgICAgICAgIGNvbnN0IGNvbHVtbnNDb25maWcgPSAoY29uZmlnPy5jb2x1bW5zPy5sZW5ndGggPiAwID8gY29uZmlnLmNvbHVtbnMgOiBjb2x1bW5zKS5tYXAoXG4gICAgICAgICAgICAoeyBuYW1lLCB2aXNpYmxlLCBzb3J0T3JkZXIsIGZpbHRlciwgY3VzdG9tLCBoZWFkZXIsIHBhdGggfSkgPT4gKHtcbiAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgdmlzaWJsZTogdmlzaWJsZSA/PyB0cnVlLFxuICAgICAgICAgICAgICBzb3J0T3JkZXIsXG4gICAgICAgICAgICAgIGN1c3RvbSxcbiAgICAgICAgICAgICAgaGVhZGVyLFxuICAgICAgICAgICAgICBwYXRoLFxuICAgICAgICAgICAgICBmaWx0ZXI6IGNvbHVtbk5hbWUgJiYgY29sdW1uTmFtZSAhPT0gbmFtZSA/IGZpbHRlciA6IGZpbHRlcmluZ01vZGlmaWVyXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICk7XG5cbiAgICAgICAgICBpZiAoIWNvbHVtbnNDb25maWcuZmlsdGVyKSB7XG4gICAgICAgICAgICBkZWxldGUgY29sdW1uc0NvbmZpZy5maWx0ZXI7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhpcy5jb25maWdDaGFuZ2UoeyBjb2x1bW5zOiBjb2x1bW5zQ29uZmlnLCBwYWdpbmF0aW9uOiBjb25maWcucGFnaW5hdGlvbiB9KTtcbiAgICAgICAgfSksXG4gICAgICAgIHRha2UoMSksXG4gICAgICAgIHRha2VVbnRpbCh0aGlzLmRlc3Ryb3llZCQpXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKCk7XG4gIH1cblxuICBhc3luYyBzZXRBY3Rpb25Db250cm9scygpIHtcbiAgICBjb25zdCBkZWxldGVBY3Rpb246IEFjdGlvbkNvbnRyb2wgPSB7XG4gICAgICB0eXBlOiBCdWlsdEluQWN0aW9uVHlwZS5EZWxldGUsXG4gICAgICBjYWxsYmFjazogKGRldmljZTogUm93KSA9PiB0aGlzLm9uRGVsZXRlRGV2aWNlKGRldmljZSBhcyBJTWFuYWdlZE9iamVjdClcbiAgICB9O1xuICAgIHRoaXMuYWN0aW9uQ29udHJvbHMucHVzaChkZWxldGVBY3Rpb24pO1xuICB9XG5cbiAgb25EZWxldGVEZXZpY2UoZGV2aWNlKSB7XG4gICAgdGhpcy5kZXZpY2VHcmlkU2VydmljZVxuICAgICAgLmRlbGV0ZShkZXZpY2UpXG4gICAgICAudGhlbigoKSA9PiB0aGlzLnJlZnJlc2guZW1pdCgpKVxuICAgICAgLmNhdGNoKCgpID0+ICh7fSkpO1xuICB9XG5cbiAgdXBkYXRlRmlsdGVyaW5nKFxuICAgIGNvbHVtbk5hbWVzOiBzdHJpbmdbXSxcbiAgICBhY3Rpb246IHtcbiAgICAgIHR5cGU6IEZpbHRlcmluZ0FjdGlvblR5cGU7XG4gICAgICBwYXlsb2FkPzogeyBmaWx0ZXJpbmdNb2RpZmllcjogRmlsdGVyaW5nTW9kaWZpZXIgfTtcbiAgICB9XG4gICkge1xuICAgIGNvbnN0IHsgdHlwZSB9ID0gYWN0aW9uO1xuICAgIGlmICh0eXBlID09PSBGaWx0ZXJpbmdBY3Rpb25UeXBlLlJlc2V0RmlsdGVyKSB7XG4gICAgICB0aGlzLmRhdGFHcmlkLmNsZWFyRmlsdGVycygpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmRhdGFHcmlkLnVwZGF0ZUZpbHRlcmluZyhjb2x1bW5OYW1lcywgYWN0aW9uKTtcbiAgICB9XG4gIH1cblxuICBjb25maWdDaGFuZ2UoY29uZmlnOiBHcmlkQ29uZmlnKSB7XG4gICAgLyogU2VtYXBob3JlIGVuc3VyZXMgdGhhdCB0aGUgZmlyc3QgcmVxdWVzdCB0byBEZXZpY2VHcmlkU2VydmljZS5zYXZlQ29uZmlnJCgpIGlzIGNvbXBsZXRlZFxuICAgICAqIGJlZm9yZSB0aGUgbmV4dCByZXF1ZXN0cyBhcmUgc2VudCBvdXQuIFRoaXMgcHJldmVudHMgbXVsdGlwbGUgY29uZmlndXJhdGlvbiBvYmplY3RzIHRvIGJlXG4gICAgICogY3JlYXRlZCBpbiBJbnZlbnRvcnkgaW4gY2FzZSBhIGNvbmZpZyBkb2VzIG5vdCB5ZXQgZXhpc3QuXG4gICAgICovXG4gICAgdGhpcy5zYXZlR3JpZENvbmZpZ1NlbWFwaG9yZSRcbiAgICAgIC5waXBlKFxuICAgICAgICBmaWx0ZXJSeEpTKHNlbWFwaG9yZSA9PiBzZW1hcGhvcmUgIT09IDEpLFxuICAgICAgICB0YXAoKCkgPT4ge1xuICAgICAgICAgIGlmICh0aGlzLnNhdmVHcmlkQ29uZmlnU2VtYXBob3JlJC52YWx1ZSA8IDEpIHtcbiAgICAgICAgICAgIHRoaXMuc2F2ZUdyaWRDb25maWdTZW1hcGhvcmUkLm5leHQodGhpcy5zYXZlR3JpZENvbmZpZ1NlbWFwaG9yZSQudmFsdWUgKyAxKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pLFxuICAgICAgICBjb25jYXRNYXAoKCkgPT4gdGhpcy5kZXZpY2VHcmlkU2VydmljZS5zYXZlQ29uZmlnJChjb25maWcsIHRoaXMuY29sdW1uc0NvbmZpZ0tleSkpLFxuICAgICAgICB0YXAoKCkgPT4ge1xuICAgICAgICAgIGlmICh0aGlzLnNhdmVHcmlkQ29uZmlnU2VtYXBob3JlJC52YWx1ZSA8IDIpIHtcbiAgICAgICAgICAgIHRoaXMuc2F2ZUdyaWRDb25maWdTZW1hcGhvcmUkLm5leHQodGhpcy5zYXZlR3JpZENvbmZpZ1NlbWFwaG9yZSQudmFsdWUgKyAxKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pLFxuICAgICAgICB0YWtlKDEpLFxuICAgICAgICB0YWtlVW50aWwodGhpcy5kZXN0cm95ZWQkKVxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZSgpO1xuICB9XG5cbiAgYWRkQ3VzdG9tQ29sdW1uKGNvbHVtbkNvbmZpZzogQ3VzdG9tQ29sdW1uQ29uZmlnKSB7XG4gICAgdGhpcy5kZXZpY2VHcmlkU2VydmljZVxuICAgICAgLmdldENvbmZpZyQodGhpcy5jb2x1bW5zQ29uZmlnS2V5KVxuICAgICAgLnBpcGUoXG4gICAgICAgIHRhcChcbiAgICAgICAgICBjb25maWcgPT5cbiAgICAgICAgICAgIChjb25maWcuY29sdW1ucyA9IFtcbiAgICAgICAgICAgICAgLi4uKGNvbmZpZy5jb2x1bW5zLmxlbmd0aCA9PT0gMCA/IHRoaXMuZ2V0RGVmYWx1bHRDb25maWdDb2x1bW5zKCkgOiBjb25maWcuY29sdW1ucyksXG4gICAgICAgICAgICAgIGNvbHVtbkNvbmZpZ1xuICAgICAgICAgICAgXSlcbiAgICAgICAgKSxcbiAgICAgICAgY29uY2F0TWFwKGNvbmZpZyA9PiB0aGlzLmRldmljZUdyaWRTZXJ2aWNlLnNhdmVDb25maWckKGNvbmZpZywgdGhpcy5jb2x1bW5zQ29uZmlnS2V5KSksXG4gICAgICAgIHN3aXRjaE1hcCgoKSA9PlxuICAgICAgICAgIHRoaXMuZGV2aWNlR3JpZFNlcnZpY2UuZ2V0VXNlckNvbmZpZ3VyZWRDb2x1bW5zJCh0aGlzLmNvbHVtbnMkLCB0aGlzLmNvbHVtbnNDb25maWdLZXkpXG4gICAgICAgICksXG4gICAgICAgIC8vIExldCBkYXRhLWdyaWQgcmUtcmVuZGVyIHdpdGggbmV3IGNvbHVtbnM7XG4gICAgICAgIC8vIENvbHVtbnMgYXJlIHNldCBpbiBhIHNlcGFyYXRlIHN0ZXAgaW4gdGhlIHBpcGUgdG8gYXZvaWQgZmxpY2tlcmluZ1xuICAgICAgICAvLyBpbiB0aGUgZ3JpZCBpbiB0aGUgdGltZSB3aGVyZSBnZXQgY29uZmlnIHJlcXVlc3QgaXMgZXhlY3V0aW5nXG4gICAgICAgIHRhcChjb2x1bW5zID0+ICh0aGlzLmNvbHVtbnMkID0gb2YoY29sdW1ucykpKSxcbiAgICAgICAgdGFrZSgxKSxcbiAgICAgICAgdGFrZVVudGlsKHRoaXMuZGVzdHJveWVkJClcbiAgICAgIClcbiAgICAgIC5zdWJzY3JpYmUoKTtcbiAgfVxuXG4gIHJlbW92ZUN1c3RvbUNvbHVtbihjb2x1bW5Ub1JlbW92ZTogQ29sdW1uKSB7XG4gICAgdGhpcy5kZXZpY2VHcmlkU2VydmljZVxuICAgICAgLmdldENvbmZpZyQodGhpcy5jb2x1bW5zQ29uZmlnS2V5KVxuICAgICAgLnBpcGUoXG4gICAgICAgIGZpcnN0KCksXG4gICAgICAgIHRhcChcbiAgICAgICAgICBjb25maWcgPT5cbiAgICAgICAgICAgIChjb25maWcuY29sdW1ucyA9IGNvbmZpZy5jb2x1bW5zLmZpbHRlcihjb2x1bW4gPT4gY29sdW1uLm5hbWUgIT09IGNvbHVtblRvUmVtb3ZlLm5hbWUpKVxuICAgICAgICApLFxuICAgICAgICBjb25jYXRNYXAoY29uZmlnID0+IHRoaXMuZGV2aWNlR3JpZFNlcnZpY2Uuc2F2ZUNvbmZpZyQoY29uZmlnLCB0aGlzLmNvbHVtbnNDb25maWdLZXkpKSxcbiAgICAgICAgc3dpdGNoTWFwKCgpID0+XG4gICAgICAgICAgdGhpcy5kZXZpY2VHcmlkU2VydmljZS5nZXRVc2VyQ29uZmlndXJlZENvbHVtbnMkKFxuICAgICAgICAgICAgdGhpcy5jb2x1bW5zJC5waXBlKFxuICAgICAgICAgICAgICBtYXAoY29sdW1ucyA9PiBjb2x1bW5zLmZpbHRlcihjb2x1bW4gPT4gY29sdW1uLm5hbWUgIT09IGNvbHVtblRvUmVtb3ZlLm5hbWUpKVxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIHRoaXMuY29sdW1uc0NvbmZpZ0tleVxuICAgICAgICAgIClcbiAgICAgICAgKSxcbiAgICAgICAgLy8gTGV0IGRhdGEtZ3JpZCByZS1yZW5kZXIgd2l0aCBuZXcgY29sdW1ucztcbiAgICAgICAgLy8gQ29sdW1ucyBhcmUgc2V0IGluIGEgc2VwYXJhdGUgc3RlcCBpbiB0aGUgcGlwZSB0byBhdm9pZCBmbGlja2VyaW5nXG4gICAgICAgIC8vIGluIHRoZSBncmlkIGluIHRoZSB0aW1lIHdoZXJlIGdldCBjb25maWcgcmVxdWVzdCBpcyBleGVjdXRpbmdcbiAgICAgICAgdGFwKGNvbHVtbnMgPT4gKHRoaXMuY29sdW1ucyQgPSBvZihjb2x1bW5zKSkpLFxuICAgICAgICB0YWtlKDEpLFxuICAgICAgICB0YWtlVW50aWwodGhpcy5kZXN0cm95ZWQkKVxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZSgpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXREZWZhbHVsdENvbmZpZ0NvbHVtbnMoKSB7XG4gICAgcmV0dXJuIHRoaXMuZGV2aWNlR3JpZFNlcnZpY2VcbiAgICAgIC5nZXREZWZhdWx0Q29sdW1ucygpXG4gICAgICAubWFwKGNvbHVtbiA9PiAoeyBuYW1lOiBjb2x1bW4ubmFtZSwgdmlzaWJsZTogdHJ1ZSB9KSk7XG4gIH1cbn1cbiJdfQ==