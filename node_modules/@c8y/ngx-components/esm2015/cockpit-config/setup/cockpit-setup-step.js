import { __awaiter } from "tslib";
import { DEFAULT_CONFIG } from '../cockpit-config.model';
export class CockpitSetupStep {
    constructor(stepper, step, setup, appState, alert) {
        this.stepper = stepper;
        this.step = step;
        this.setup = setup;
        this.appState = appState;
        this.alert = alert;
        this.config = DEFAULT_CONFIG;
        this.pending = false;
    }
    next() {
        return __awaiter(this, void 0, void 0, function* () {
            this.pending = true;
            try {
                const newConfig = Object.assign(Object.assign({}, this.setup.data$.value), this.config);
                yield this.appState.updateApplicationConfig(newConfig);
                this.setup.stepCompleted(this.stepper.selectedIndex);
                this.setup.data$.next(newConfig);
                this.stepper.next();
            }
            catch (ex) {
                this.alert.addServerFailure(ex);
            }
            finally {
                this.pending = false;
            }
        });
    }
    back() {
        this.stepper.previous();
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29ja3BpdC1zZXR1cC1zdGVwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vY29ja3BpdC1jb25maWcvc2V0dXAvY29ja3BpdC1zZXR1cC1zdGVwLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFFQSxPQUFPLEVBQWlCLGNBQWMsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBRXhFLE1BQU0sT0FBZ0IsZ0JBQWdCO0lBSXBDLFlBQ1MsT0FBbUIsRUFDaEIsSUFBYSxFQUNiLEtBQXFCLEVBQ3JCLFFBQXlCLEVBQ3pCLEtBQW1CO1FBSnRCLFlBQU8sR0FBUCxPQUFPLENBQVk7UUFDaEIsU0FBSSxHQUFKLElBQUksQ0FBUztRQUNiLFVBQUssR0FBTCxLQUFLLENBQWdCO1FBQ3JCLGFBQVEsR0FBUixRQUFRLENBQWlCO1FBQ3pCLFVBQUssR0FBTCxLQUFLLENBQWM7UUFSL0IsV0FBTSxHQUFrQixjQUFjLENBQUM7UUFDdkMsWUFBTyxHQUFHLEtBQUssQ0FBQztJQVFiLENBQUM7SUFFRSxJQUFJOztZQUNSLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDO1lBQ3BCLElBQUk7Z0JBQ0YsTUFBTSxTQUFTLG1DQUFRLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBSyxJQUFJLENBQUMsTUFBTSxDQUFFLENBQUM7Z0JBQ2hFLE1BQU0sSUFBSSxDQUFDLFFBQVEsQ0FBQyx1QkFBdUIsQ0FBQyxTQUFTLENBQUMsQ0FBQztnQkFDdkQsSUFBSSxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsQ0FBQztnQkFDckQsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO2dCQUNqQyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxDQUFDO2FBQ3JCO1lBQUMsT0FBTyxFQUFFLEVBQUU7Z0JBQ1gsSUFBSSxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLENBQUMsQ0FBQzthQUNqQztvQkFBUztnQkFDUixJQUFJLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQzthQUN0QjtRQUNILENBQUM7S0FBQTtJQUVELElBQUk7UUFDRixJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQzFCLENBQUM7Q0FDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENka1N0ZXAgfSBmcm9tICdAYW5ndWxhci9jZGsvc3RlcHBlcic7XG5pbXBvcnQgeyBBcHBTdGF0ZVNlcnZpY2UsIEFsZXJ0U2VydmljZSwgQzh5U3RlcHBlciwgU2V0dXBDb21wb25lbnQgfSBmcm9tICdAYzh5L25neC1jb21wb25lbnRzJztcbmltcG9ydCB7IENvY2twaXRDb25maWcsIERFRkFVTFRfQ09ORklHIH0gZnJvbSAnLi4vY29ja3BpdC1jb25maWcubW9kZWwnO1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQ29ja3BpdFNldHVwU3RlcCB7XG4gIGNvbmZpZzogQ29ja3BpdENvbmZpZyA9IERFRkFVTFRfQ09ORklHO1xuICBwZW5kaW5nID0gZmFsc2U7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHVibGljIHN0ZXBwZXI6IEM4eVN0ZXBwZXIsXG4gICAgcHJvdGVjdGVkIHN0ZXA6IENka1N0ZXAsXG4gICAgcHJvdGVjdGVkIHNldHVwOiBTZXR1cENvbXBvbmVudCxcbiAgICBwcm90ZWN0ZWQgYXBwU3RhdGU6IEFwcFN0YXRlU2VydmljZSxcbiAgICBwcm90ZWN0ZWQgYWxlcnQ6IEFsZXJ0U2VydmljZVxuICApIHt9XG5cbiAgYXN5bmMgbmV4dCgpIHtcbiAgICB0aGlzLnBlbmRpbmcgPSB0cnVlO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBuZXdDb25maWcgPSB7IC4uLnRoaXMuc2V0dXAuZGF0YSQudmFsdWUsIC4uLnRoaXMuY29uZmlnIH07XG4gICAgICBhd2FpdCB0aGlzLmFwcFN0YXRlLnVwZGF0ZUFwcGxpY2F0aW9uQ29uZmlnKG5ld0NvbmZpZyk7XG4gICAgICB0aGlzLnNldHVwLnN0ZXBDb21wbGV0ZWQodGhpcy5zdGVwcGVyLnNlbGVjdGVkSW5kZXgpO1xuICAgICAgdGhpcy5zZXR1cC5kYXRhJC5uZXh0KG5ld0NvbmZpZyk7XG4gICAgICB0aGlzLnN0ZXBwZXIubmV4dCgpO1xuICAgIH0gY2F0Y2ggKGV4KSB7XG4gICAgICB0aGlzLmFsZXJ0LmFkZFNlcnZlckZhaWx1cmUoZXgpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICB0aGlzLnBlbmRpbmcgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBiYWNrKCkge1xuICAgIHRoaXMuc3RlcHBlci5wcmV2aW91cygpO1xuICB9XG59XG4iXX0=