{"version":3,"file":"c8y-ngx-components-repository-shared.umd.js","sources":["../../../../node_modules/tslib/tslib.es6.js","../../repository/shared/advanced-software.service.ts","../../repository/shared/repository.model.ts","../../repository/shared/repository.service.ts","../../repository/shared/file-download/link-render-type.enum.ts","../../repository/shared/file-download/file-download.component.ts","../../repository/shared/select-modal/repository-select-modal.component.ts","../../repository/shared/software-type/software-type.component.ts","../../repository/shared/shared-repository.module.ts","../../repository/shared/c8y-ngx-components-repository-shared.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","import { Injectable } from '@angular/core';\nimport { ApplicationService, FetchClient, IManagedObject, IResultList, Service } from '@c8y/client';\n\n@Injectable()\nexport class AdvancedSoftwareService extends Service<IManagedObject> {\n  private static readonly applicationName = 'advanced-software-mgmt';\n\n  protected baseUrl: string = 'service/advanced-software-mgmt';\n  protected listUrl: string = 'software';\n  protected propertyName = 'softwareList';\n\n  private isAvailable: Promise<boolean>;\n\n  constructor(client: FetchClient, private applicationService: ApplicationService) {\n    super(client);\n  }\n\n  list(filter: object = {}): Promise<IResultList<IManagedObject>> {\n    return super.list(filter);\n  }\n\n  isASMAvailable(): Promise<boolean> {\n    if (this.isAvailable === undefined) {\n      this.isAvailable = this.applicationService\n        .isAvailable(AdvancedSoftwareService.applicationName)\n        .then(result => !!result?.data);\n    }\n\n    return this.isAvailable;\n  }\n}\n","import { IManagedObject } from '@c8y/client';\n\nexport enum RepositoryType {\n  FIRMWARE = 'c8y_Firmware',\n  SOFTWARE = 'c8y_Software',\n  CONFIGURATION = 'c8y_ConfigurationDump'\n}\n\nexport const REPOSITORY_BINARY_TYPES = {\n  [RepositoryType.SOFTWARE]: 'c8y_SoftwareBinary',\n  [RepositoryType.FIRMWARE]: 'c8y_FirmwareBinary',\n  [RepositoryType.CONFIGURATION]: 'c8y_ConfigurationDumpBinary'\n};\n\nexport interface ModalModel {\n  selected?: { id?: string; name?: string; [key: string]: any };\n  version?: string;\n  dependency?: { c8y_Firmware: { version: string } };\n  patchVersion?: string;\n  description?: string;\n  deviceType?: string;\n  softwareType?;\n  binary?: {\n    file?: File;\n    url?: string;\n  };\n}\n\nexport interface RepositoryCategory extends Partial<IManagedObject> {\n  type: string;\n  description?: string;\n  c8y_Filter?: {\n    type: string;\n  };\n  softwareType?: string;\n}\n\nexport interface FirmwareBinary extends Partial<IManagedObject> {\n  type: 'c8y_FirmwareBinary';\n  c8y_Firmware: {\n    version: string;\n    url: string;\n  };\n}\n\nexport interface FirmwarePatchBinary extends FirmwareBinary {\n  c8y_Patch: {\n    dependency: string;\n  };\n}\n\nexport interface SoftwareBinary extends Partial<IManagedObject> {\n  type: string;\n  c8y_Software: {\n    version: string;\n    url: string;\n  };\n}\n\nexport type RepositoryBinary = FirmwareBinary | SoftwareBinary | FirmwarePatchBinary;\n\nexport interface SelectedRepositoryBinary {\n  id?: string;\n  name: string;\n  version: string;\n  url: string;\n  dependency?: string;\n  c8y_Patch?: boolean;\n  isPatch?: boolean;\n  patchDependency?: string;\n}\n\nexport interface DeviceFirmware {\n  version: string;\n  url: string;\n  name: string;\n}\n\nexport interface DeviceSoftware {\n  name: string;\n  version?: string;\n  url: string;\n  softwareType?: string;\n}\n\nexport interface DeviceSoftwareChange extends DeviceSoftware {\n  action: 'install' | 'delete';\n}\n\nexport interface ConfigurationSnapshot {\n  id?: string;\n  time: string;\n  name: string;\n  binaryUrl?: string;\n  binary?: any;\n  binaryType?: any;\n  deviceType?: string;\n  configurationType?: string;\n  description?: string;\n}\n\nexport interface SupportedConfigurationItem {\n  name: string;\n  deviceType?: string;\n  configurationType?: string;\n  isLegacy?: boolean;\n}\n\nexport interface DeviceConfigurationListEmptyState {\n  icon?: string;\n  title?: string;\n  text?: string;\n}\n\nexport enum DeviceConfigurationOperation {\n  UPLOAD_CONFIG = 'c8y_UploadConfigFile',\n  DOWNLOAD_CONFIG = 'c8y_DownloadConfigFile',\n  CONFIG = 'c8y_Configuration',\n  SEND_CONFIG = 'c8y_SendConfiguration'\n}\nexport interface FilterCriteria {\n  name?: string;\n  [key: string]: any;\n}\n","import { Injectable } from '@angular/core';\nimport {\n  EventBinaryService,\n  EventService,\n  IdReference,\n  IEvent,\n  IFetchResponse,\n  IIdentified,\n  IManagedObject,\n  IManagedObjectBinary,\n  InventoryBinaryService,\n  InventoryService,\n  IOperation,\n  IResult,\n  IResultList,\n  OperationService,\n  OperationStatus,\n  QueriesUtil\n} from '@c8y/client';\nimport { AlertService, gettext, OperationRealtimeService } from '@c8y/ngx-components';\nimport {\n  assign,\n  cloneDeep,\n  find,\n  forEach,\n  get,\n  head,\n  isNil,\n  isString,\n  isUndefined,\n  map as _map,\n  omitBy,\n  pick,\n  remove,\n  set\n} from 'lodash-es';\nimport { defer, from, merge, Observable, of, throwError } from 'rxjs';\nimport { filter, map, switchMap, take, takeWhile, withLatestFrom } from 'rxjs/operators';\nimport { AdvancedSoftwareService } from './advanced-software.service';\nimport {\n  ConfigurationSnapshot,\n  DeviceFirmware,\n  DeviceSoftware,\n  DeviceSoftwareChange,\n  FirmwareBinary,\n  FirmwarePatchBinary,\n  ModalModel,\n  RepositoryBinary,\n  RepositoryCategory,\n  RepositoryType,\n  REPOSITORY_BINARY_TYPES,\n  SelectedRepositoryBinary,\n  SoftwareBinary\n} from './repository.model';\n\n@Injectable()\nexport class RepositoryService {\n  readonly dateFrom = new Date(0);\n  readonly dateTo = new Date(Date.now() + 86400000); // 1 day in the future\n  private queriesUtil: QueriesUtil;\n\n  constructor(\n    private inventory: InventoryService,\n    private inventoryBinary: InventoryBinaryService,\n    private operation: OperationService,\n    private alert: AlertService,\n    private event: EventService,\n    private operationRealtime: OperationRealtimeService,\n    private eventBinary: EventBinaryService,\n    private advancedSoftwareService: AdvancedSoftwareService\n  ) {\n    this.queriesUtil = new QueriesUtil();\n  }\n\n  /**\n   * Lists repository entries of given type.\n   * @param type The type of repository entries to list.\n   * @param options Extra listing options.\n   */\n  listRepositoryEntries(\n    type: RepositoryType,\n    options?: {\n      /** Additional query. */\n      query?: any;\n      /** (deprecated - to be removed) Only include entries with matching partial names. */\n      partialName?: string;\n      /** Include entries with matching partial text in the specified properties. */\n      partialTextFilter?: { partialText: string; properties: string[] };\n      /** Exclude legacy entries. */\n      skipLegacy?: boolean;\n      /** Exclude default ordering. */\n      skipDefaultOrder?: boolean;\n      /** Other request params. */\n      params?: any;\n    }\n  ) {\n    const defaultOrder = [{ name: 1 }];\n    const defaultFilters = { type };\n    const legacyFilters = { __has: `url` };\n    let filters = {};\n\n    let fullQuery = (options && options.query) || {};\n    if (!options || (options && !options.skipDefaultOrder)) {\n      fullQuery = this.queriesUtil.addOrderbys(fullQuery, defaultOrder, 'prepend');\n    }\n\n    fullQuery = this.queriesUtil.addAndFilter(fullQuery, defaultFilters);\n\n    if (options && options.partialTextFilter) {\n      const { partialText, properties } = options.partialTextFilter;\n      const orFilter = { __or: properties.map(property => ({ [property]: `*${partialText}*` })) };\n      fullQuery = this.queriesUtil.addAndFilter(fullQuery, orFilter);\n    }\n\n    if (options && options.partialName) {\n      // backwards compatibility if\n      fullQuery = this.queriesUtil.addAndFilter(fullQuery, { name: `*${options.partialName}*` });\n    }\n\n    if (options && options.skipLegacy) {\n      fullQuery = this.queriesUtil.addAndFilter(fullQuery, { __not: legacyFilters });\n    }\n\n    filters = {\n      query: this.queriesUtil.buildQuery(fullQuery),\n      pageSize: 50,\n      withTotalPages: true,\n      ...((options && options.params) || {})\n    };\n    return this.inventory.list(filters);\n  }\n\n  // TODO: merge with create()\n  async save(data: ModalModel, type: RepositoryType, mo: Partial<IManagedObject> = {}) {\n    switch (type) {\n      case RepositoryType.CONFIGURATION: {\n        Object.assign(mo, {\n          type: RepositoryType.CONFIGURATION,\n          configurationType: data.selected ? data.selected.configurationType : undefined,\n          name: data.version,\n          description: data.description,\n          deviceType: data.deviceType,\n          c8y_Global: {}\n        });\n        if (!data.deviceType && mo.id) {\n          mo.deviceType = null;\n        }\n        if (!data.selected && mo.id) {\n          mo.configurationType = null;\n        }\n        break;\n      }\n    }\n\n    const existingUrl = mo.url;\n    if (data.binary.url) {\n      mo.url = data.binary.url;\n    } else if (data.binary.file) {\n      const response = await this.inventoryBinary.create(data.binary.file, {\n        c8y_Global: {}\n      } as Partial<IManagedObject>);\n      mo.url = response.data.self;\n    }\n\n    if (mo.id) {\n      return this.updateEntry(mo, existingUrl);\n    }\n    return this.createEntry(mo);\n  }\n\n  async create(modal: ModalModel, type: RepositoryType) {\n    switch (type) {\n      case RepositoryType.FIRMWARE:\n      case RepositoryType.SOFTWARE:\n        return this.createFirmwareOrSoftware(modal, type);\n    }\n  }\n\n  async createFirmwareOrSoftware(\n    modal: ModalModel,\n    type: RepositoryType\n  ): Promise<RepositoryCategory> {\n    let binary: IManagedObjectBinary;\n    let binaryURL: string;\n    let repositoryEntry: RepositoryCategory;\n    let repositoryBinary: FirmwareBinary | SoftwareBinary;\n    const mos = [];\n    const {\n      selected: { id: selectedId },\n      binary: { file, url }\n    } = modal;\n    try {\n      if (file) {\n        ({ data: binary } = await this.saveBinary(file));\n        ({ self: binaryURL } = binary);\n        mos.push(binary);\n      } else {\n        binaryURL = url;\n      }\n\n      ({ data: repositoryEntry } = await this.createOrUpdateRepositoryEntry(modal, type));\n      if (isNil(selectedId)) {\n        mos.push(repositoryEntry);\n      }\n\n      ({ data: repositoryBinary } = await this.createRepositoryBinary(\n        modal,\n        binaryURL,\n        type,\n        repositoryEntry\n      ));\n      mos.push(repositoryBinary);\n\n      if (file) {\n        await this.linkBinary(repositoryBinary, binary);\n      }\n\n      return repositoryEntry;\n    } catch (error) {\n      this.cleanUp(mos);\n      this.errorMsg();\n\n      // Propagate error\n      throw error;\n    }\n  }\n\n  saveBinary(file: File): Promise<IResult<IManagedObjectBinary>> {\n    return this.inventoryBinary.create(file, { c8y_Global: {} } as Partial<IManagedObject>);\n  }\n\n  createOrUpdateRepositoryEntry(\n    modal: ModalModel,\n    type: RepositoryType\n  ): Promise<IResult<RepositoryCategory>> {\n    const {\n      selected: { id, name },\n      description,\n      deviceType\n    } = modal;\n\n    const mo = {\n      id,\n      name: id ? undefined : name,\n      description,\n      type: id ? undefined : type,\n      c8y_Global: {}\n    };\n\n    if (deviceType) {\n      set(mo, 'c8y_Filter.type', deviceType);\n    }\n\n    if (modal.softwareType) {\n      set(mo, 'softwareType', modal.softwareType.softwareType);\n    }\n\n    return id\n      ? (this.inventory.update(mo) as Promise<IResult<RepositoryCategory>>)\n      : (this.inventory.create(mo) as Promise<IResult<RepositoryCategory>>);\n  }\n\n  createRepositoryBinary(\n    modal: ModalModel,\n    binaryURL: string,\n    type: RepositoryType,\n    parent: RepositoryCategory\n  ): Promise<IResult<FirmwareBinary | SoftwareBinary | FirmwarePatchBinary>> {\n    const mo = this.prepareRepositoryBinaryMO(modal, binaryURL, type);\n\n    return this.inventory.childAdditionsCreate(mo, parent) as Promise<\n      IResult<FirmwareBinary | SoftwareBinary | FirmwarePatchBinary>\n    >;\n  }\n\n  prepareRepositoryBinaryMO(modal: ModalModel, binaryURL: string, type: RepositoryType) {\n    const { version, patchVersion, dependency } = modal;\n    const result = {\n      type: REPOSITORY_BINARY_TYPES[type],\n      [type]: {\n        url: binaryURL\n      },\n      c8y_Global: {}\n    };\n\n    if (dependency) {\n      set(result, [type, 'version'], patchVersion);\n      assign(result, {\n        c8y_Patch: {\n          dependency: dependency.c8y_Firmware.version\n        }\n      });\n    } else {\n      set(result, [type, 'version'], version);\n    }\n    return result;\n  }\n\n  async linkBinary(\n    repositoryBinary: FirmwareBinary | SoftwareBinary,\n    binary: IManagedObjectBinary\n  ) {\n    const { id: repositoryBinaryId } = repositoryBinary;\n    if (binary) {\n      const { id: binaryId } = binary;\n      return this.inventory.childAdditionsAdd(binaryId, repositoryBinaryId);\n    }\n  }\n\n  cleanUp(mosToDelete: IIdentified[]) {\n    mosToDelete.forEach(mo => {\n      const { c8y_IsBinary } = mo;\n      isUndefined(c8y_IsBinary) ? this.delete(mo) : this.inventoryBinary.delete(mo);\n    });\n  }\n\n  delete(entity: IIdentified): Promise<IResult<null>> {\n    return this.inventory.delete(entity, { forceCascade: true });\n  }\n\n  errorMsg() {\n    const msg = gettext('Failed to save');\n    this.alert.danger(msg);\n  }\n\n  getBaseVersionsCount$(entry: IManagedObject): Observable<number> {\n    if (this.isLegacyEntry(entry)) {\n      return of(1);\n    }\n    return from(this.listBaseVersions(entry, { pageSize: 1, withTotalPages: true })).pipe(\n      map(({ paging }) => paging.totalPages)\n    );\n  }\n\n  getBaseVersionFromMO(mo: RepositoryBinary): string {\n    return this.isPatch(mo) ? get(mo, 'c8y_Patch.dependency') : get(mo, 'c8y_Firmware.version');\n  }\n\n  isPatch(mo: RepositoryBinary): boolean {\n    return !!get(mo, 'c8y_Patch.dependency');\n  }\n\n  getPatchVersionsCount$(entry: IManagedObject, baseVersion: FirmwareBinary): Observable<number> {\n    if (this.isLegacyEntry(baseVersion)) {\n      return of(0);\n    }\n    return from(\n      this.listPatchVersions(entry, baseVersion, { pageSize: 1, withTotalPages: true })\n    ).pipe(map(({ paging }) => paging.totalPages));\n  }\n\n  isLegacyEntry(entry: Partial<IManagedObject>): boolean {\n    return Boolean(entry.url);\n  }\n\n  /**\n   * Lists all versions (base and patch ones) of given top level entry.\n   * Versions are ordered by creation time (assuming the earlier created, the older the version).\n   * @param entry Top level repository entry.\n   * @param params Additional query params.\n   */\n  listAllVersions(entry: Partial<IManagedObject>, params = {}) {\n    if (this.isLegacyEntry(entry)) {\n      return this.getBaseVersionResultListForLegacyEntry(entry);\n    }\n\n    const VERSION_FILTER_ORDER = {\n      __filter: {},\n      __orderby: [{ 'creationTime.date': -1 }, { creationTime: -1 }]\n    };\n    return this.listChildren(entry, VERSION_FILTER_ORDER, params);\n  }\n\n  /**\n   * Lists base versions of given top level entry.\n   * Versions are ordered by creation time (assuming the earlier created, the older the version).\n   * @param entry Top level repository entry.\n   * @param params Additional query params.\n   */\n  listBaseVersions(entry: Partial<IManagedObject>, params = {}) {\n    if (this.isLegacyEntry(entry)) {\n      return this.getBaseVersionResultListForLegacyEntry(entry);\n    }\n\n    const NO_PATCH_FILTER_ORDER = {\n      __filter: {\n        __not: { __has: 'c8y_Patch' }\n      },\n      __orderby: [{ 'creationTime.date': -1 }, { creationTime: -1 }]\n    };\n    return this.listChildren(entry, NO_PATCH_FILTER_ORDER, params);\n  }\n\n  /**\n   * Lists patch versions of given base version under the entry.\n   * Versions are ordered by creation time (assuming the earlier created, the older the version).\n   * @param entry Top level repository entry.\n   * @param baseVersion Base version.\n   * @param params Additional query params.\n   */\n  listPatchVersions(entry: IManagedObject, baseVersion: FirmwareBinary | string, params = {}) {\n    const version = isString(baseVersion) ? baseVersion : get(baseVersion, 'c8y_Firmware.version');\n    const PATCH_FILTER_ORDER = {\n      __filter: {\n        'c8y_Patch.dependency': version\n      },\n      __orderby: [{ 'creationTime.date': -1 }, { creationTime: -1 }]\n    };\n    return this.listChildren(entry, PATCH_FILTER_ORDER, params);\n  }\n\n  /**\n   * Lists patch versions of given base version under the entry including the base version.\n   * Versions are ordered by creation time (assuming the earlier created, the older the version).\n   * In terms of legacy base version the entry gets transformed to fit the needed data model.\n   * @param entry Top level repository entry.\n   * @param baseVersion Base version.\n   * @param params Additional query params.\n   */\n  listBaseVersionAndPatches(entry: IManagedObject, baseVersion: IManagedObject, params = {}) {\n    if (this.isLegacyEntry(entry)) {\n      return Promise.resolve({\n        data: [\n          Object.assign(\n            {\n              c8y_Firmware: {\n                version: entry.version,\n                url: entry.url\n              }\n            },\n            entry\n          )\n        ]\n      });\n    }\n\n    const PATCH_FILTER_ORDER = {\n      __filter: {\n        __or: {\n          'c8y_Patch.dependency': baseVersion.c8y_Firmware.version,\n          'c8y_Firmware.version': baseVersion.c8y_Firmware.version\n        }\n      },\n      __orderby: [{ 'c8y_Patch.dependency': 1 }, { 'c8y_Firmware.version': 1 }]\n    };\n    return this.listChildren(entry, PATCH_FILTER_ORDER, params);\n  }\n\n  listChildren(entry: Partial<IManagedObject>, filters = {}, params: any = {}) {\n    const childrenFilters = { __bygroupid: entry.id };\n    const query = this.queriesUtil.addAndFilter(filters, childrenFilters);\n    // FIXME: needed because of issue in forOf directive (...)\n    params.withTotalPages = true;\n    return this.inventory.listQuery(query, params);\n  }\n\n  /**\n   * Fetches all items from the list starting with the provided page.\n   * @param firstPage The first page of the list to fetch all items for.\n   */\n  async fetchAllItemsFromList(firstPage) {\n    let allItems;\n\n    if (!firstPage.then) {\n      allItems = [...firstPage];\n    } else {\n      let { paging, data: items } = await firstPage;\n      allItems = [...items];\n\n      while (paging && paging.nextPage) {\n        ({ paging, data: items } = await paging.next());\n        allItems = [...allItems, ...items];\n      }\n    }\n\n    return allItems;\n  }\n\n  /**\n   * Gets top level repository entry managed object for base or patch version.\n   * @param mo Base or patch version managed object with parents.\n   */\n  getRepositoryEntryMO$(mo: IManagedObject): Observable<IManagedObject | undefined> {\n    if (!mo) {\n      return of(undefined);\n    }\n    const [reference] = get(mo, 'additionParents.references');\n    const id = get(reference, 'managedObject.id');\n    return id\n      ? from(this.inventory.detail(id, { withChildren: false })).pipe(map(({ data }) => data))\n      : of(undefined);\n  }\n  /**\n   * Gets base or patch version managed object.\n   * @param deviceRepositoryFragment Device repository fragment.\n   * @param type Top level repository entry type.\n   * @param configuration Configuration object with options:\n   * - **skipLegacy** - `boolean` - Exclude legacy entries.\n   * - **filters** - `object` - Filter object.\n   *\n   * @deprecated as it doesn't support 'missing url' case\n   */\n  getRepositoryBinaryMoByVersion(\n    deviceRepositoryFragment: DeviceFirmware | DeviceSoftware,\n    type: RepositoryType,\n    { skipLegacy = false, filters = {} }: { skipLegacy?: boolean; filters?: object } = {}\n  ): Promise<IManagedObject> {\n    const { version, url, name } = deviceRepositoryFragment;\n    const repositoryBinaryType = REPOSITORY_BINARY_TYPES[type];\n    let query;\n    const newModelBaseVersionQuery = {\n      [`${type}.version`]: version,\n      [`${type}.url`]: url,\n      type: repositoryBinaryType\n    };\n    const legacyVersionQuery = { url, type, name };\n    filters = { withChildren: false, withParents: true, ...filters };\n\n    if (skipLegacy) {\n      query = {\n        __and: {\n          ...newModelBaseVersionQuery\n        }\n      };\n    } else {\n      query = {\n        __or: [{ __and: { ...newModelBaseVersionQuery } }, { __and: { ...legacyVersionQuery } }]\n      };\n    }\n\n    return this.inventory.listQuery(query, filters).then(({ data }) => head(data));\n  }\n\n  getBinaryName$(binaryUrl: string): Observable<string> {\n    if (!binaryUrl) {\n      return of('---');\n    }\n\n    const binaryId = this.inventoryBinary.getIdFromUrl(binaryUrl);\n    if (!binaryId) {\n      return of(binaryUrl);\n    }\n    return defer(() => this.inventory.detail(binaryId).then(result => result.data)).pipe(\n      map(mo => mo.name)\n    );\n  }\n\n  /**\n   * Generates an inventory query object which can be used to find\n   * repository entries of specified type matching the type of provided device.\n   * @param repositoryType The type of repository entries which will be queried with the generated query.\n   * @param device The device for which matching repository entries will be queried with the generated query.\n   */\n\n  getDeviceTypeQuery(repositoryType: RepositoryType, device: IManagedObject): object {\n    let result = { type: repositoryType };\n    if (repositoryType === RepositoryType.CONFIGURATION) {\n      if (device.type) {\n        result = this.queriesUtil.addAndFilter(result, {\n          __or: [{ deviceType: device.type }, { __not: { __has: `deviceType` } }]\n        });\n      }\n    } else {\n      result = this.queriesUtil.addAndFilter(result, {\n        __or: [\n          { 'c8y_Filter.type': device.type },\n          { 'c8y_Filter.type': '' },\n          { __not: { __has: `c8y_Filter.type` } }\n        ]\n      });\n    }\n\n    return result;\n  }\n\n  /**\n   * Generates an inventory query object which can be used to find\n   * repository entries matching the predefined software types provided in the device.\n   * @param device The device for which matching repository entries will be queried with the generated query.\n   * @param query The query to which the software types filters will be attached. Default value is an object containg repository type software.\n   */\n  getSoftwareTypeQuery(device: IManagedObject, query?: object): object {\n    let result = { ...(query || {}), type: RepositoryType.SOFTWARE };\n\n    if (device.c8y_SupportedSoftwareTypes) {\n      result = this.queriesUtil.addAndFilter(result, {\n        __or: [device.c8y_SupportedSoftwareTypes.map(type => ({ softwareType: type }))]\n      });\n    }\n\n    return result;\n  }\n\n  /**\n   * Generates an inventory query object which can be used to find configuration repository entries\n   * matching the type of provided device and specified configuration type.\n   * @param device The device for which matching repository entries will be queried with the generated query.\n   * @param configurationType Configuration type for which matching repository entries will be queried with the generated query.\n   */\n  getConfigurationTypeQuery(device: IManagedObject, configurationType: string): object {\n    const query = this.getDeviceTypeQuery(RepositoryType.CONFIGURATION, device);\n    return this.queriesUtil.addAndFilter(query, {\n      __or: [\n        { configurationType },\n        { configurationType: '' },\n        { __not: { __has: `configurationType` } }\n      ]\n    });\n  }\n\n  /**\n   * Gets the list of software installed in the device in the uniform format.\n   * Supports c8y_SoftwareList and c8y_Software fragments.\n   * @param device The device whose software list should be returned.\n   */\n  getDeviceSoftwareList(device: IManagedObject): DeviceSoftware[] {\n    if (device.c8y_SoftwareList) {\n      return cloneDeep(device.c8y_SoftwareList);\n    }\n    if (device.c8y_Software) {\n      return _map(device.c8y_Software, (version, name) => ({ name, version }));\n    }\n    return [];\n  }\n\n  /**\n   * Prepares a software update operation for given device and the list of changes, and sends it to the device.\n   * @param device The device which the operation should be prepared for and sent to.\n   * @param changes The list of software changes which should be applied.\n   */\n  async createSoftwareUpdateOperation(\n    device: IManagedObject,\n    changes: DeviceSoftwareChange[]\n  ): Promise<IOperation> {\n    const operation = await this.getSoftwareUpdateOperation(device, changes);\n    return (await this.operation.create(operation)).data;\n  }\n\n  /**\n   * Prepares a software update operation for given device and changes.\n   * Returned operation type depends on device's supported operations.\n   * Supports c8y_SoftwareUpdate, c8y_SoftwareList, and c8y_Software operations.\n   * @param device The device for which operation should be prepared.\n   * @param changes The list of software changes which should be applied.\n   */\n  async getSoftwareUpdateOperation(\n    device: IManagedObject,\n    changes: DeviceSoftwareChange[]\n  ): Promise<IOperation> {\n    const operation: IOperation = {\n      deviceId: device.id,\n      description: `Apply software changes: ${changes\n        .map(\n          change =>\n            `${change.action} \"${change.name}\"${\n              change.version ? ` (version: ${change.version})` : ''\n            }`\n        )\n        .join(', ')}`\n    };\n    if (device.c8y_SupportedOperations.includes('c8y_SoftwareUpdate')) {\n      operation.c8y_SoftwareUpdate = (cloneDeep(changes) || []).map(change =>\n        omitBy(change, isNil)\n      );\n    } else if (device.c8y_SupportedOperations.includes('c8y_SoftwareList')) {\n      operation.c8y_SoftwareList = cloneDeep(\n        await this.getCurrentSoftware(device, 'c8y_SoftwareList', [])\n      );\n      changes.forEach(change => {\n        const deviceSoftware: DeviceSoftware = pick(omitBy(change, isNil), [\n          'name',\n          'version',\n          'url',\n          'softwareType'\n        ]);\n        if (change.action === 'delete') {\n          remove(operation.c8y_SoftwareList, deviceSoftware);\n        }\n        if (change.action === 'install') {\n          const softwareItemToUpdateIdx = operation.c8y_SoftwareList.findIndex(\n            item => item.name === change.name\n          );\n          if (softwareItemToUpdateIdx > -1) {\n            // update software\n            operation.c8y_SoftwareList.splice(softwareItemToUpdateIdx, 1, deviceSoftware);\n          } else {\n            // install software\n            operation.c8y_SoftwareList.push(deviceSoftware);\n          }\n        }\n      });\n    } else if (device.c8y_SupportedOperations.includes('c8y_Software')) {\n      operation.c8y_Software = cloneDeep(await this.getCurrentSoftware(device, 'c8y_Software', {}));\n      changes.forEach(change => {\n        if (change.action === 'delete') {\n          delete operation.c8y_Software[change.name];\n        }\n        if (change.action === 'install') {\n          operation.c8y_Software[change.name] = change.version;\n        }\n      });\n    }\n    return operation;\n  }\n\n  /**\n   * Extracts the list of device software changes from given operation in the context of given device.\n   * @param operation The operation from which the list should be extracted.\n   * @param device The target device of the operation.\n   */\n  async getDeviceSoftwareChangesFromOperation(\n    operation: IOperation,\n    device: IManagedObject\n  ): Promise<DeviceSoftwareChange[]> {\n    if (operation.c8y_SoftwareUpdate) {\n      return cloneDeep(operation.c8y_SoftwareUpdate);\n    }\n    if (operation.c8y_SoftwareList) {\n      return await this.getDeviceSoftwareChangesFromSoftwareListOperation(operation, device);\n    }\n    if (operation.c8y_Software) {\n      return await this.getDeviceSoftwareChangesFromSoftwareOperation(operation, device);\n    }\n    return [];\n  }\n\n  /**\n   * Prepares a firmware update operation for given device and the selected repository binary, and sends it to the device.\n   * @param device The device which the operation should be prepared for and sent to.\n   * @param selectedOption The selected repository binary option.\n   */\n  async createFirmwareUpdateOperation(\n    device: IManagedObject,\n    selectedOption: SelectedRepositoryBinary\n  ): Promise<IOperation> {\n    const operation = this.getFirmwareUpdateOperation(device, selectedOption);\n    return (await this.operation.create(operation)).data;\n  }\n\n  /**\n   * Prepares a firmware update operation for given device and selected version.\n   * Supports c8y_Firmware operation.\n   * @param device The device for which operation should be prepared.\n   * @param selectedOption Selected firmware version.\n   */\n  getFirmwareUpdateOperation(\n    device: IManagedObject,\n    selectedOption: SelectedRepositoryBinary\n  ): IOperation {\n    delete selectedOption.id;\n\n    const operation: IOperation = {\n      deviceId: device.id,\n      description: `Update firmware to: \"${selectedOption.name}\"${\n        selectedOption.version ? ` (version: ${selectedOption.version})` : ''\n      }`,\n      c8y_Firmware: { ...selectedOption }\n    };\n\n    return operation;\n  }\n\n  /**\n   * Prepares a configuration file upload operation for given device and configuration type.\n   * @param device The device for which operation should be prepared.\n   * @param configurationType Selected configuration type.\n   * @param isLegacy  A legacy operation is created without a configurationType.\n   */\n  getUploadConfigurationFileOperation(\n    device: IManagedObject,\n    configurationType: string,\n    isLegacy: boolean = false\n  ): IOperation {\n    if (isLegacy) {\n      return {\n        deviceId: device.id,\n        description: `Retrieve configuration snapshot from device ${device.name}`,\n        c8y_UploadConfigFile: {}\n      };\n    }\n    return {\n      deviceId: device.id,\n      description: `Retrieve ${configurationType} configuration snapshot from device ${device.name}`,\n      c8y_UploadConfigFile: {\n        type: configurationType\n      }\n    };\n  }\n\n  /**\n   * Prepares a configuration file download operation for given device and configuration type.\n   * @param device The device for which operation should be prepared.\n   * @param configurationType Selected configuration type.\n   * @param binaryUrl The url of a binary to be downloaded.\n   * @param isLegacy A legacy operation is created without a configurationType.\n   */\n  getDownloadConfigurationFileOperation(\n    device: IManagedObject,\n    configurationType: string,\n    configSnapshot: ConfigurationSnapshot,\n    isLegacy: boolean = false\n  ): IOperation {\n    if (isLegacy) {\n      return {\n        deviceId: device.id,\n        description: `Send configuration snapshot ${configSnapshot.name} to device ${device.name}`,\n        c8y_DownloadConfigFile: {\n          url: configSnapshot.binaryUrl,\n          c8y_ConfigurationDump: {\n            id: configSnapshot.id\n          }\n        }\n      };\n    }\n    return {\n      deviceId: device.id,\n      description: `Send configuration snapshot ${configSnapshot.name} of configuration type ${configurationType} to device ${device.name}`,\n      c8y_DownloadConfigFile: {\n        url: configSnapshot.binaryUrl,\n        type: configurationType\n      }\n    };\n  }\n\n  /**\n   * Gets the last firmware update operation for given device.\n   * Looks for c8y_Firmware operations.\n   * @param deviceId The ID of the device to find an operation for.\n   */\n  async getLastFirmwareUpdateOperation(deviceId: string | number): Promise<IOperation> {\n    const filters = {\n      deviceId,\n      dateFrom: new Date(0).toISOString(),\n      dateTo: new Date(Date.now()).toISOString(),\n      revert: true,\n      pageSize: 1\n    };\n    return this.getFirstMatchingOperation([{ ...filters, fragmentType: 'c8y_Firmware' }]);\n  }\n\n  /**\n   * Gets the last software update operation for given device.\n   * Looks for c8y_SoftwareUpdate, c8y_SoftwareList, or c8y_Software operations.\n   * @param deviceId The ID of the device to find an operation for.\n   */\n  async getLastSoftwareUpdateOperation(deviceId: string | number): Promise<IOperation> {\n    const filters = {\n      deviceId,\n      dateFrom: new Date(0).toISOString(),\n      dateTo: new Date(Date.now()).toISOString(),\n      revert: true,\n      pageSize: 1\n    };\n    return this.getLatestMatchingOperation([\n      { ...filters, fragmentType: 'c8y_SoftwareUpdate' },\n      { ...filters, fragmentType: 'c8y_SoftwareList' },\n      { ...filters, fragmentType: 'c8y_Software' }\n    ]);\n  }\n\n  /**\n   * Iterates over the list of filters and queries the operations.\n   * If a query returns at least one operation, the first one will be returned.\n   * Otherwise the next query will be performed.\n   * If none of the queries returns any operation, null will be returned.\n   * @param filtersList The list of filters for the queries.\n   */\n  async getFirstMatchingOperation(filtersList: any[]): Promise<IOperation> {\n    let matchingOperation = null;\n\n    for (const filters of filtersList) {\n      const operations = (await this.operation.list(filters)).data;\n      if (operations.length) {\n        matchingOperation = operations[0];\n        break;\n      }\n    }\n\n    return matchingOperation;\n  }\n\n  /**\n   * Iterates over the list of filters and queries the operations.\n   * It compares the operations retrieved by the queries by 'creationTime'\n   * and return the latest one.\n   * If none of the queries returns any operation, null will be returned.\n   * @param filtersList The list of filters for the queries.\n   */\n  async getLatestMatchingOperation(filtersList: any[]): Promise<IOperation> {\n    let matchingOperation: IOperation = null;\n\n    for (const filters of filtersList) {\n      const operations: IOperation[] = (await this.operation.list(filters)).data;\n      if (operations.length) {\n        if (matchingOperation) {\n          matchingOperation =\n            new Date(matchingOperation.creationTime).getTime() <\n            new Date(operations[0].creationTime).getTime()\n              ? operations[0]\n              : matchingOperation;\n        } else {\n          matchingOperation = operations[0];\n        }\n      }\n    }\n\n    return matchingOperation;\n  }\n\n  /**\n   * Creates the operation and returns an observable to track its progress.\n   * Fails the observable when the operation returns FAILED status.\n   * Completes the observable when the operation returns SUCCESSFUL status.\n   * @param operation The operation to create and track.\n   */\n  createObservedOperation(operation: IOperation): Observable<IOperation> {\n    return from(this.operation.create(operation)).pipe(\n      map(({ data }) => data),\n      take(1),\n      switchMap(createdOperation => this.observeOperation(createdOperation))\n    );\n  }\n\n  /**\n   * Returns an observable to track progress of given operation.\n   * Fails the observable when the operation returns FAILED status.\n   * Completes the observable when the operation returns SUCCESSFUL status.\n   * @param operation The operation to be observed.\n   */\n  observeOperation(operation: IOperation): Observable<IOperation> {\n    const observedOperation$ = of(operation);\n    const operationUpdates$ = observedOperation$.pipe(\n      switchMap(observedOperation => this.operationRealtime.onAll$(observedOperation.deviceId)),\n      map(({ data }) => data as IOperation),\n      withLatestFrom(observedOperation$),\n      filter(([operationUpdate, observedOperation]) => operationUpdate.id === observedOperation.id),\n      switchMap(([operationUpdate]) => {\n        if (operationUpdate.status === OperationStatus.FAILED) {\n          return throwError(operationUpdate);\n        }\n        return of(operationUpdate);\n      }),\n      takeWhile(operationUpdate => operationUpdate.status !== OperationStatus.SUCCESSFUL, true)\n    );\n    return merge(observedOperation$, operationUpdates$);\n  }\n\n  /**\n   * Gets a single event with latest creationTime for the given device Id and event type.\n   * @param deviceId The device Id for which the events should be queried.\n   * @param type Event type.\n   */\n  async getLatestConfigurationEvent(\n    deviceId: string | number,\n    type: string\n  ): Promise<IEvent | undefined> {\n    const eventFilter: object = {\n      source: deviceId,\n      type,\n      dateFrom: this.dateFrom.toISOString(),\n      dateTo: this.dateTo.toISOString(),\n      pageSize: 1\n    };\n\n    const { data } = await this.event.list(eventFilter);\n    return data[0];\n  }\n\n  /**\n   * Gets a list of operations for the given device Id, and operation type.\n   * @param deviceId The device Id for which the operation should be queried.\n   * @param operationType Operation type fragment.\n   */\n  async getConfigFileOperationList(\n    deviceId: string | number,\n    operationType: string\n  ): Promise<IOperation[]> {\n    const operationFilter: object = {\n      deviceId,\n      fragmentType: operationType,\n      dateFrom: this.dateFrom.toISOString(),\n      dateTo: this.dateTo.toISOString(),\n      revert: true,\n      pageSize: 2000\n    };\n\n    return (await this.operation.list(operationFilter)).data;\n  }\n\n  /**\n   * Gets latest uploaded configuration snapshot for the given device, and configuration type.\n   * @param device The device for which the configuration snapshot was uploaded.\n   * @param configurationType Selected configuration type.\n   */\n  async getConfigSnapshot(\n    device: IManagedObject,\n    configurationType: string\n  ): Promise<ConfigurationSnapshot | undefined> {\n    const event: IEvent = await this.getLatestConfigurationEvent(device.id, configurationType);\n    let configSnapshot: ConfigurationSnapshot;\n    if (event) {\n      configSnapshot = {\n        time: event.time,\n        name: event.text,\n        deviceType: device.type,\n        configurationType\n      };\n      try {\n        configSnapshot.binary = await (await this.eventBinary.download(event)).text();\n        if (event.c8y_IsBinary) {\n          configSnapshot.binaryType = event.c8y_IsBinary.type;\n        }\n      } catch (ex) {\n        const msg = gettext('Could not get the binary.');\n        this.alert.danger(msg);\n      }\n    }\n    return configSnapshot;\n  }\n\n  async getLegacyConfigSnapshot(deviceId) {\n    let configSnapshot: ConfigurationSnapshot;\n    let mo;\n    const device = (await this.inventory.detail(deviceId, { withChildren: false })).data;\n    const snapshotId = device.c8y_ConfigurationDump && device.c8y_ConfigurationDump.id;\n    if (!snapshotId) {\n      return;\n    }\n\n    try {\n      mo = (await this.inventory.detail(snapshotId)).data;\n    } catch (ex) {\n      // do nothing\n    }\n    if (mo) {\n      configSnapshot = {\n        time: mo.creationTime,\n        name: mo.name\n      };\n      configSnapshot.binary = await this.getBinaryText(mo.url, { allowExternal: false });\n    }\n    return configSnapshot;\n  }\n\n  /**\n   * Returns a binary object as text.\n   * @param binaryUrl The URL to find binary\n   * @param options The object with additional options:\n   * - **allowExternal** - `boolean` - allows downloading external binary file\n   * - **noAlerts** - `boolean` - do not display an alert message; defaults to `false`\n   */\n  async getBinaryText(\n    binaryUrl: string,\n    options: { allowExternal: boolean; noAlerts?: boolean }\n  ): Promise<string> {\n    const binaryId = this.inventoryBinary.getIdFromUrl(binaryUrl);\n    let res;\n    if (!binaryId) {\n      if (options.allowExternal) {\n        res = await this.getExternalBinaryResponse(binaryUrl, options);\n      }\n    } else {\n      res = await this.getInternalBinaryResponse(binaryId, options);\n    }\n    if (!res) {\n      return null;\n    }\n    return res.text();\n  }\n\n  /**\n   * Returns a binary object as File.\n   * @param binaryUrl The URL to find binary\n   * @param options The object with additional options:\n   * - **allowExternal** - `boolean` - allows downloading external binary file\n   */\n  async getBinaryFile(binaryUrl: string, options: { allowExternal: boolean }): Promise<File> {\n    const binaryId = this.inventoryBinary.getIdFromUrl(binaryUrl);\n    if (!binaryId && !options.allowExternal) {\n      return null;\n    }\n    // @TODO: note that it doesn't solve issue with external binary here, such url won't have binaryId, so we won't know the name or contentType to use in File constructor, let's add a @FIXME comment for now?\n    const { name, contentType } = (await this.inventory.detail(binaryId)).data;\n    const res = !!binaryId\n      ? await this.getInternalBinaryResponse(binaryId)\n      : await this.getExternalBinaryResponse(binaryUrl);\n    const arrayBuffer = await res.arrayBuffer();\n    return new File([arrayBuffer], name, { type: contentType });\n  }\n\n  /**\n   * Gets the last configuration update operation for given device.\n   * Looks for c8y_Configuration and c8y_SendConfiguration operations.\n   * @param deviceId The ID of the device to find an operation for.\n   */\n  async getLastConfigUpdateOperation(deviceId: string | number): Promise<IOperation> {\n    const filters = {\n      deviceId,\n      dateFrom: new Date(0).toISOString(),\n      dateTo: new Date(Date.now()).toISOString(),\n      revert: true,\n      pageSize: 1\n    };\n    return this.getLatestMatchingOperation([\n      { ...filters, fragmentType: 'c8y_Configuration' },\n      { ...filters, fragmentType: 'c8y_SendConfiguration' }\n    ]);\n  }\n\n  /**\n   * Prepares a configuration download operation for given device and its current configuration.\n   * Supports c8y_SendConfiguration operation.\n   * @param device The device for which operation should be prepared.\n   */\n  createTextBasedConfigurationReloadOperation(device: IManagedObject): IOperation {\n    return {\n      deviceId: device.id,\n      description: gettext('Requested current configuration'),\n      c8y_SendConfiguration: {}\n    };\n  }\n\n  /**\n   * Prepares a configuration update operation for the given device.\n   * Supports c8y_Configuration operation.\n   * @param device The device for which operation should be prepared.\n   * @param config The configuration which will update the existing one.\n   */\n  createTextBasedConfigurationUpdateOperation(device: IManagedObject, config: string): IOperation {\n    return {\n      deviceId: device.id,\n      description: gettext('Configuration update'),\n      c8y_Configuration: {\n        config\n      }\n    };\n  }\n\n  async getBinary(binaryId: IdReference): Promise<IFetchResponse> {\n    try {\n      return await this.inventoryBinary.download(binaryId);\n    } catch (ex) {\n      const msg = gettext('Could not get the binary.');\n      this.alert.danger(msg);\n    }\n  }\n\n  /**\n   * Gets all available snapshots from the repository for the given device.\n   * @param device The device for which the snapshots should be prepared.\n   * @param configurationType Selected configuration type.\n   */\n  async getSnapshotsFromRepository(device, configurationType) {\n    const searchQuery = this.getConfigurationTypeQuery(device, configurationType);\n    const res = await this.listRepositoryEntries(RepositoryType.CONFIGURATION, {\n      query: searchQuery,\n      params: { pageSize: 100 }\n    });\n    return res.data;\n  }\n\n  /**\n   * Checks if a device already have a given software installed\n   * @param deviceId Id of the device to be checked\n   * @param software The software to be checked\n   */\n  async isSoftwareInstalledOnDevice(\n    deviceId: string | number,\n    software: DeviceSoftware\n  ): Promise<boolean> {\n    if (!(await this.advancedSoftwareService.isASMAvailable())) {\n      return false;\n    }\n\n    const queryFilter = { deviceId };\n    if (software?.name) {\n      set(queryFilter, 'name', software.name);\n    }\n    if (software?.version) {\n      set(queryFilter, 'version', software.version);\n    }\n    return this.advancedSoftwareService.list(queryFilter).then(result => !!result.data?.length);\n  }\n\n  /**\n   * Returns a binary object.\n   * @param binaryId binary ID\n   * @param options The object with additional options:\n   * - **noAlerts** - `boolean` - do not display an alert message; defaults to `false`\n   */\n  private async getInternalBinaryResponse(\n    binaryId: IdReference,\n    options: { noAlerts?: boolean } = {}\n  ): Promise<IFetchResponse> {\n    let res;\n    try {\n      res = await this.inventoryBinary.download(binaryId);\n    } catch (ex) {\n      if (!options.noAlerts) {\n        const msg = gettext('Could not get the binary.');\n        this.alert.danger(msg);\n      }\n    }\n    return res;\n  }\n\n  /**\n   * Returns a binary object.\n   * @param binaryUrl The URL to find binary\n   * @param options The object with additional options:\n   * - **noAlerts** - `boolean` - do not display an alert message; defaults to `false`\n   */\n  private async getExternalBinaryResponse(\n    binaryUrl: string,\n    options: { noAlerts?: boolean } = {}\n  ): Promise<IFetchResponse> {\n    let res;\n    try {\n      const fetchRes = await fetch(binaryUrl);\n      if (fetchRes.status >= 400) {\n        throw res;\n      }\n      res = fetchRes;\n    } catch {\n      if (!options.noAlerts) {\n        const msg = gettext('Could not get the external binary');\n        this.alert.danger(msg);\n      }\n    }\n    return res;\n  }\n\n  private async createEntry(mo: Partial<IManagedObject>) {\n    const binaryId = await this.inventoryBinary.getIdFromUrl(mo.url);\n    const newMo = await this.inventory.create(mo);\n    if (binaryId) {\n      await this.inventory.childAdditionsAdd(binaryId, newMo.data);\n    }\n    return newMo;\n  }\n\n  private async updateEntry(mo: Partial<IManagedObject>, url) {\n    const existingBinaryId = await this.inventoryBinary.getIdFromUrl(url);\n    const newBinaryId = await this.inventoryBinary.getIdFromUrl(mo.url);\n    if (existingBinaryId && existingBinaryId !== newBinaryId) {\n      const id = this.inventoryBinary.getIdFromUrl(url);\n      await this.inventoryBinary.delete(id);\n    }\n    if (newBinaryId) {\n      await this.inventory.childAdditionsAdd(newBinaryId, mo);\n    }\n    return this.inventory.update(mo);\n  }\n\n  private getBaseVersionResultListForLegacyEntry(entry) {\n    return Promise.resolve({\n      res: {} as IFetchResponse,\n      data: [\n        {\n          ...entry,\n          [entry.type]: {\n            version: entry.version,\n            url: entry.url\n          }\n        }\n      ]\n    } as IResultList<IManagedObject>);\n  }\n\n  private async getDeviceSoftwareChangesFromSoftwareListOperation(\n    operation: IOperation,\n    device: IManagedObject\n  ): Promise<DeviceSoftwareChange[]> {\n    const changes: DeviceSoftwareChange[] = [];\n    const deviceSoftwareList = await this.getCurrentSoftware(device, 'c8y_SoftwareList', []);\n    forEach(operation.c8y_SoftwareList, operationSoftware => {\n      const deviceSoftware = find(deviceSoftwareList, { name: operationSoftware.name });\n      if (\n        (operationSoftware && operationSoftware.version) !==\n        (deviceSoftware && deviceSoftware.version)\n      ) {\n        changes.push({\n          ...operationSoftware,\n          action: 'install'\n        } as DeviceSoftwareChange);\n      }\n    });\n    forEach(deviceSoftwareList, deviceSoftware => {\n      const operationSoftware = find(operation.c8y_SoftwareList, { name: deviceSoftware.name });\n      if (\n        (operationSoftware && operationSoftware.version) !==\n        (deviceSoftware && deviceSoftware.version)\n      ) {\n        const installChange = changes.find(\n          change => deviceSoftware.name === change.name && change.action === 'install'\n        );\n        // check that this software is not an installation software change, otherwise it's an update and not a removal\n        if (!installChange) {\n          changes.push({\n            ...deviceSoftware,\n            action: 'delete'\n          } as DeviceSoftwareChange);\n        }\n      }\n    });\n    return changes;\n  }\n\n  private async getDeviceSoftwareChangesFromSoftwareOperation(\n    operation: IOperation,\n    device: IManagedObject\n  ): Promise<DeviceSoftwareChange[]> {\n    const changes: DeviceSoftwareChange[] = [];\n    const deviceSoftware = await this.getCurrentSoftware(device, 'c8y_Software', {});\n    forEach(deviceSoftware, (deviceSoftwareVersion, deviceSoftwareName) => {\n      if (operation.c8y_Software[deviceSoftwareName] !== deviceSoftwareVersion) {\n        changes.push({\n          name: deviceSoftwareName,\n          version: deviceSoftwareVersion,\n          action: 'delete'\n        } as DeviceSoftwareChange);\n      }\n    });\n    forEach(operation.c8y_Software, (operationSoftwareVersion, operationSoftwareName) => {\n      const deviceSoftwareVersion = deviceSoftware && deviceSoftware[operationSoftwareName];\n      if (deviceSoftwareVersion !== operationSoftwareVersion) {\n        changes.push({\n          name: operationSoftwareName,\n          version: operationSoftwareVersion,\n          action: 'install'\n        } as DeviceSoftwareChange);\n      }\n    });\n    return changes;\n  }\n\n  private async getCurrentSoftware(\n    device: IManagedObject,\n    swFragment: string,\n    defaultValue: object\n  ): Promise<object> {\n    const isASMAvailable = await this.advancedSoftwareService.isASMAvailable();\n    if (isASMAvailable) {\n      let softwareResultList: IResultList<IManagedObject> = await this.advancedSoftwareService.list(\n        { deviceId: device.id, pageSize: 100 }\n      );\n      let list = (softwareResultList?.data || []).map(sw =>\n        pick(omitBy(sw, isNil), ['name', 'version', 'url', 'softwareType'])\n      );\n\n      while (softwareResultList.paging?.nextPage) {\n        softwareResultList = await softwareResultList.paging.next();\n        list = [\n          ...list,\n          ...(softwareResultList?.data || []).map(sw =>\n            pick(omitBy(sw, isNil), ['name', 'version', 'url', 'softwareType'])\n          )\n        ];\n      }\n\n      if (!list?.length) {\n        return defaultValue;\n      }\n\n      return Array.isArray(defaultValue) ? list : this.softwareListToLegacy(list);\n    } else {\n      return device[swFragment] || defaultValue;\n    }\n  }\n\n  private softwareListToLegacy(list: IManagedObject[]): object {\n    return (list || []).reduce((prev, curr) => ({ ...prev, [curr.name]: curr.version }), {});\n  }\n}\n","export enum LinkRenderType {\n    DOWNLOAD,\n    LINK,\n    TEXTONLY\n}\n","import { AlertService } from '@c8y/ngx-components';\nimport { Component, Input } from '@angular/core';\nimport { RepositoryService } from '../repository.service';\nimport { memoize } from '@c8y/ngx-components';\nimport { saveAs } from 'file-saver';\nimport { InventoryBinaryService } from '@c8y/client';\nimport { LinkRenderType } from './link-render-type.enum';\n\n@Component({\n  selector: 'c8y-file-download',\n  templateUrl: './file-download.component.html'\n})\nexport class FileDownloadComponent {\n  @Input() url: string;\n  linkRenderType = LinkRenderType;\n  isDownloading = false;\n  constructor(\n    private repositoryService: RepositoryService,\n    private inventoryBinaryService: InventoryBinaryService,\n    private alertService: AlertService\n  ) {}\n\n  @memoize()\n  getBinaryName$(binaryUrl) {\n    return this.repositoryService.getBinaryName$(binaryUrl);\n  }\n\n  @memoize()\n  determineBehavior(): LinkRenderType {\n    let result: LinkRenderType;\n    if (this.inventoryBinaryService.getIdFromUrl(this.url)) {\n      result = LinkRenderType.DOWNLOAD;\n    } else if (this.url.match(/\\/\\//g)) {\n      result = LinkRenderType.LINK;\n    } else {\n      result = LinkRenderType.TEXTONLY;\n    }\n    return result;\n  }\n\n  async downloadFile() {\n    try {\n      this.isDownloading = true;\n      const binary: File = await this.repositoryService.getBinaryFile(this.url, {\n        allowExternal: false\n      });\n      this.isDownloading = false;\n      saveAs(binary);\n    } catch (ex) {\n      this.isDownloading = false;\n      if (ex) {\n        this.alertService.addServerFailure(ex);\n      }\n    }\n  }\n}\n","import { Component, EventEmitter, TemplateRef } from '@angular/core';\nimport { IManagedObject, QueriesUtil } from '@c8y/client';\nimport {\n  gettext,\n  ISelectModalObject,\n  ISelectModalOption,\n  IUpdateItemEvent,\n  ModalLabels,\n  ModalSelectionMode\n} from '@c8y/ngx-components';\nimport { TranslateService } from '@ngx-translate/core';\nimport { get, has, isEmpty, isEqual, omitBy } from 'lodash-es';\nimport { BehaviorSubject, merge, Observable, of, Subject } from 'rxjs';\nimport { map, mergeMap, switchMap, tap } from 'rxjs/operators';\nimport {\n  FilterCriteria,\n  RepositoryBinary,\n  RepositoryCategory,\n  RepositoryType,\n  SelectedRepositoryBinary\n} from '../repository.model';\nimport { RepositoryService } from '../repository.service';\n\n// MODAL STRUCTURE\n// - selectModalObject (repository entry (repositoryCategory) -> type c8y_Firmware/c8y_Software)\n//   -- ISelectModalOption (repository binary entry (repositoryBinary) => type c8y_FirmwareBinary/c8y_SoftwareBinary)\n//   -- ISelectModalOption...\n// - selectModalObject...\n\n/**\n * RepositorySelectModalComponent displays repository entries options and allows to select them.\n *\n * @example\n * ```\n * import { take } from 'rxjs/operators';\n * import { RepositorySelectModalComponent, ModalSelectionMode, RepositoryType } from '@c8y/ngx-components/repository/shared';\n *\n * const initialState = {\n *   repositoryType: RepositoryType.FIRMWARE,\n *   title: gettext('Install firmware'),\n *   subTitle: gettext('Available firmwares matching the device type'),\n *   icon: 'c8y-firmware',\n *   mode: ModalSelectionMode.SINGLE,\n *   labels: { ok: gettext('Install') },\n *   disableSelected: false\n * };\n *\n * const modal = this.bsModal.show(RepositorySelectModalComponent, {\n *   ignoreBackdropClick: true,\n *   initialState\n * });\n *\n * modal.content.load.next();\n * modal.content.resultEmitter.pipe(take(1)).subscribe((firmware) => {\n *   ...\n * })\n * ```\n */\n\n@Component({\n  selector: 'c8y-repository-select-modal',\n  templateUrl: './repository-select-modal.component.html'\n})\nexport class RepositorySelectModalComponent {\n  /**\n   * Optional\n   * Allows to provide custom data.\n   * @example\n   * ```\n   * import { from } from 'rxjs';\n   *\n   * const repositoryEntry = { name: 'ExampleEntry', type: 'c8y_Firmware' };\n   * const versions = [{ c8y_Firmware: { version: '1.0.0', url: 'http://example.com' } }];\n   *\n   * const initialState = {repositoryEntriesWithVersions$: from({ ...repositoryEntry, versions })};\n   * ```\n   */\n  repositoryEntriesWithVersions$: Observable<IManagedObject[]> = undefined;\n  /**\n   * Repository entry type.\n   */\n  repositoryType: RepositoryType.FIRMWARE | RepositoryType.SOFTWARE;\n  /**\n   * Optional\n   * Allows to use custom badges templates.\n   * @example\n   * ```\n   * import { gettext } from '@c8y/ngx-components';\n   *\n   * const badgeTemplates = { '=1': gettext('{{count}} version'), other: gettext('{{count}} versions') };\n   * const initialState = { badgeTemplates };\n   * ```\n   */\n  badgeTemplates = { '=1': gettext('{{count}} version'), other: gettext('{{count}} versions') };\n  /**\n   * Optional\n   * Allows to provide custom modal title.\n   */\n  title: string = gettext('Select repository entry');\n  /**\n   * Optional\n   * Allows to provide custom modal subtitle.\n   */\n  subTitle: string;\n  /**\n   * Loads the content of the modal.\n   * Must be invoked by the modal's caller.\n   */\n  load: Subject<void> = new Subject();\n  /**\n   * Triggers an update of the item list emitted.\n   */\n  updateInstallableList$: Subject<IUpdateItemEvent<any>> = new Subject();\n  /**\n   * Optional\n   * Emits a filter criteria object currently entered in the filter input.\n   * Use it to filter the items if you use custom repositoryEntriesWithVersions$.\n   */\n  searchTerm: BehaviorSubject<FilterCriteria> = new BehaviorSubject({});\n  /**\n   * Optional\n   * Allows to provide device type query to restrict search criteria.\n   * Only takes effect when repositoryEntriesWithVersions$ is not provided,\n   * otherwise modal's caller have to provide already filtered data in the repositoryEntriesWithVersions$.\n   */\n  deviceTypeQuery: any = {};\n  /**\n   * Optional\n   * Allows to provide query to restrict search criteria.\n   * Only takes effect when repositoryEntriesWithVersions$ is not provided,\n   * otherwise modal's caller have to provide already filtered data in the repositoryEntriesWithVersions$.\n   */\n  searchQuery: any = {};\n  /**\n   * Optional\n   * Allows to provide custom labels for the buttons responsible for confirm/dismiss modal actions.\n   */\n  labels: ModalLabels = { ok: gettext('Save') };\n  /**\n   * Optional\n   * Allows to hide the name filter input field.\n   * By default, the filter input field is displayed.\n   */\n  showFilter: boolean = true;\n  /**\n   * Optional\n   * Allows to show a warning that the search criteria should be narrowed down.\n   * By default, this warning is hidden.\n   */\n  areMoreEntries: boolean = false;\n  /**\n   * Optional\n   * Allows to display a more specific than the default message in case there are no items to display.\n   */\n  noItemsMessage: string;\n  /**\n   * Optional\n   * Allows to pass the array of items. Each item from this array will be marked as selected in the modal.\n   */\n  selected: SelectedRepositoryBinary[];\n  /**\n   * Emits whenever a new repository binary have been selected in the modal.\n   */\n  onChoiceUpdated: EventEmitter<ISelectModalObject> = new EventEmitter<ISelectModalObject>();\n  /**\n   * Emits the list of selected options.\n   */\n  resultEmitter: EventEmitter<SelectedRepositoryBinary[]> = new EventEmitter<\n    SelectedRepositoryBinary[]\n  >();\n  /**\n   * Optional\n   * Allows to change selection mode.\n   * Supported options:\n   *   * single: only single option can be selected.\n   *   * multiple: multiple options can be selected.\n   */\n  mode: ModalSelectionMode = ModalSelectionMode.SINGLE;\n  /**\n   * Optional\n   * Allows to use custom icon in the modal header.\n   */\n  icon: string;\n  /**\n   * Allows to block selection of the other versions from the same repository entry.\n   */\n  disableSelected: boolean = true;\n\n  filterCriteria: FilterCriteria = {};\n\n  repositoryEntries$: Observable<ISelectModalObject[]> = this.load.pipe(\n    switchMap(() => this.repositoryEntriesWithVersions$),\n    mergeMap(mos => this.aggregate(mos)),\n    tap(items => {\n      this.areMoreEntries = items.length >= this.PAGE_SIZE ? true : false;\n    }),\n    tap(items => (this.repositoryEntries = items))\n  );\n\n  modalEntries: Observable<ISelectModalObject[]> = merge(\n    this.repositoryEntries$,\n    this.updateInstallableList$.pipe(\n      map((updateItemEvent: IUpdateItemEvent<any>) => {\n        const itemToUpdate: ISelectModalObject = (this.repositoryEntries || []).find(\n          item => item.groupId === updateItemEvent.object.groupId\n        );\n        if (itemToUpdate) {\n          const optionToUpdate: ISelectModalOption = (itemToUpdate.options || []).find(\n            option => option.obj.id === (updateItemEvent.object as any).selectedId\n          );\n          if (optionToUpdate) {\n            optionToUpdate.template = updateItemEvent.template;\n            if (updateItemEvent.mapper) {\n              optionToUpdate.obj = updateItemEvent.mapper(optionToUpdate.obj);\n            }\n          }\n        }\n        return this.repositoryEntries;\n      })\n    )\n  );\n\n  /**\n   * Optional\n   * Allows to provide additional template that will be rendered in the\n   * filters block on top of the results list in the select modal.\n   */\n  additionalFilterTemplate: TemplateRef<any>;\n\n  private PAGE_SIZE = 100;\n  private queriesUtil: QueriesUtil;\n  private repositoryEntries: ISelectModalObject[];\n\n  constructor(\n    private repositoryService: RepositoryService,\n    private translateService: TranslateService\n  ) {\n    this.queriesUtil = new QueriesUtil();\n  }\n\n  ngOnInit() {\n    if (!this.repositoryType) {\n      throw new Error('Repository type must be defined');\n    }\n\n    if (!this.repositoryEntriesWithVersions$) {\n      this.repositoryEntriesWithVersions$ = of(1).pipe(\n        mergeMap(() =>\n          this.repositoryService.listRepositoryEntries(this.repositoryType, {\n            query: this.queriesUtil.addAndFilter(\n              this.deviceTypeQuery,\n              has(this.searchQuery, 'name')\n                ? { ...this.searchQuery, name: `*${this.searchQuery.name}*` }\n                : this.searchQuery\n            ),\n            params: { pageSize: this.PAGE_SIZE }\n          })\n        ),\n        map(({ data }) => data),\n        map(mos => this.getAndAssignRepositoryBinaries(mos))\n      );\n    }\n  }\n\n  getAndAssignRepositoryBinaries(mos: IManagedObject[]) {\n    mos.forEach(mo => {\n      mo.versions = this.repositoryService.listAllVersions(mo);\n    });\n    return mos;\n  }\n\n  search(filterCriteria: FilterCriteria) {\n    this.filterCriteria = omitBy(\n      {\n        ...this.filterCriteria,\n        ...filterCriteria\n      },\n      isEmpty\n    );\n\n    if (!isEqual(this.filterCriteria, this.searchQuery)) {\n      this.searchTerm.next(this.filterCriteria);\n      this.searchQuery = this.filterCriteria;\n      this.load.next();\n    }\n  }\n\n  result(selectedItems: SelectedRepositoryBinary[]) {\n    this.resultEmitter.emit(selectedItems);\n  }\n\n  async aggregate(mos: IManagedObject[]): Promise<ISelectModalObject[]> {\n    const repositoryType = this.repositoryType;\n    const selectedItems: SelectedRepositoryBinary[] = this.selected;\n\n    return Promise.all(\n      mos.map(async repositoryEntry => {\n        const options: ISelectModalOption[] = this.getSelectModalOptions(\n          await this.repositoryService.fetchAllItemsFromList(repositoryEntry.versions),\n          selectedItems,\n          repositoryEntry as RepositoryCategory,\n          repositoryType\n        );\n        const selectModalObject = this.getSelectModalObject(\n          repositoryEntry as RepositoryCategory,\n          options\n        );\n\n        return selectModalObject;\n      })\n    );\n  }\n\n  getSelectModalOptions(\n    versions: RepositoryBinary[],\n    selectedItems: SelectedRepositoryBinary[],\n    repositoryEntry: RepositoryCategory,\n    repositoryType: RepositoryType\n  ): ISelectModalOption[] {\n    const selectModalOptions: ISelectModalOption[] = [];\n    versions.forEach(repositoryBinary => {\n      const isSelected: boolean = this.isBinaryRepositorySelected(\n        selectedItems,\n        repositoryEntry,\n        repositoryBinary,\n        repositoryType\n      );\n\n      const { version } = repositoryBinary[`${repositoryType}`];\n      const bodyValue =\n        version || `(${this.translateService.instant(gettext('not specified`version`'))})`;\n      const bodyClass = version ? '' : 'text-muted';\n      selectModalOptions.push({\n        body: [\n          {\n            value: bodyValue,\n            class: bodyClass\n          }\n        ],\n        obj: {\n          id: repositoryBinary.id,\n          name: repositoryEntry.name,\n          version,\n          ...(get(repositoryBinary, 'c8y_Patch.dependency') && {\n            dependency: get(repositoryBinary, 'c8y_Patch.dependency')\n          }),\n          ...(get(repositoryBinary, 'c8y_Patch') && { isPatch: true }),\n          url: repositoryBinary[`${repositoryType}`].url,\n          softwareType: repositoryEntry.softwareType\n        },\n        selected: isSelected\n      });\n    });\n    return selectModalOptions;\n  }\n\n  isBinaryRepositorySelected(\n    selectedItems: SelectedRepositoryBinary[],\n    repositoryEntry: RepositoryCategory,\n    repositoryBinary: RepositoryBinary,\n    repositoryType: RepositoryType\n  ): boolean {\n    const isSelected = selectedItems\n      ? selectedItems.filter(\n          repositoryFragment =>\n            repositoryFragment.name === repositoryEntry.name &&\n            repositoryFragment.version === repositoryBinary[`${repositoryType}`].version\n        ).length > 0\n      : false;\n\n    return isSelected;\n  }\n\n  getSelectModalObject(\n    repositoryEntry: RepositoryCategory,\n    options: ISelectModalOption[]\n  ): ISelectModalObject {\n    const label =\n      options.length === 1\n        ? this.translateService.instant(this.badgeTemplates['=1'], { count: options.length })\n        : this.translateService.instant(this.badgeTemplates.other, { count: options.length });\n\n    const selectModalObject: ISelectModalObject = {\n      groupId: repositoryEntry.id,\n      body: [\n        { value: repositoryEntry.name, class: 'text-truncate' },\n        { value: repositoryEntry.description, class: 'text-truncate text-muted' }\n      ],\n      additionalInformation: { value: label, class: 'label label-info' },\n      options\n    };\n\n    return selectModalObject;\n  }\n}\n","import {\n  ChangeDetectorRef,\n  Component,\n  EventEmitter,\n  forwardRef,\n  Input,\n  OnInit,\n  Output,\n  TemplateRef,\n  ViewChild\n} from '@angular/core';\nimport {\n  AbstractControl,\n  ControlValueAccessor,\n  NG_VALIDATORS,\n  NG_VALUE_ACCESSOR,\n  ValidationErrors,\n  Validator\n} from '@angular/forms';\nimport { IManagedObject, IResultList, QueriesUtil } from '@c8y/client';\nimport { gettext, TypeaheadComponent } from '@c8y/ngx-components';\nimport { TranslateService } from '@ngx-translate/core';\nimport { uniqBy } from 'lodash-es';\nimport { BehaviorSubject, Observable, pipe, UnaryFunction } from 'rxjs';\nimport { debounceTime, map, shareReplay, switchMap, tap } from 'rxjs/operators';\nimport { RepositoryType } from '../repository.model';\nimport { RepositoryService } from '../repository.service';\n\n@Component({\n  selector: 'c8y-software-type',\n  templateUrl: 'software-type.component.html',\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      multi: true,\n      useExisting: forwardRef(() => SoftwareTypeComponent)\n    },\n    {\n      provide: NG_VALIDATORS,\n      useExisting: forwardRef(() => SoftwareTypeComponent),\n      multi: true\n    }\n  ]\n})\nexport class SoftwareTypeComponent implements OnInit, ControlValueAccessor, Validator {\n  @Input() softwareTypeMO: IManagedObject;\n\n  @Input() disabled: boolean;\n\n  @Input() style;\n\n  @Input()\n  required: boolean = true;\n\n  @Input()\n  placeholder: string = this.translateService.instant(gettext('e.g. {{ example }}'), {\n    example: 'yum'\n  });\n\n  @Input()\n  emitResultsOnly: boolean = false;\n\n  @Input()\n  showBtnInNotFoundMessage: boolean = true;\n\n  @Input()\n  allowFreeEntries: boolean = true;\n\n  @Input()\n  showClearSelectionOption: boolean = false;\n\n  @Input()\n  clearSelectionOptionLabel: string = gettext('All software types');\n\n  @ViewChild('deviceSoftwareTypeModel', { static: true })\n  deviceSoftwareTypeModel: TypeaheadComponent;\n\n  @ViewChild('notFoundTypeAddNewTemplate', { static: true })\n  notFoundTypeAddNewTemplate: TemplateRef<unknown>;\n\n  @ViewChild('notFoundTypeTemplate', { static: true })\n  notFoundTypeTemplate: TemplateRef<unknown>;\n\n  @Output() onSelectSoftware: EventEmitter<IManagedObject> = new EventEmitter<IManagedObject>();\n\n  notFoundTemplateToUse: TemplateRef<unknown>;\n\n  filterPipe: UnaryFunction<unknown, unknown> = pipe(tap());\n  softwaresResult$: Observable<IResultList<IManagedObject>>;\n  search$: BehaviorSubject<string> = new BehaviorSubject(null);\n  softwaresResult: IResultList<IManagedObject>;\n\n  private queriesUtil: QueriesUtil = new QueriesUtil();\n  private softwareTypes: Set<string> = new Set();\n\n  constructor(\n    private repositoryService: RepositoryService,\n    public changeDetectorRef: ChangeDetectorRef,\n    private translateService: TranslateService\n  ) {\n    this.softwaresResult$ = this.search$.pipe(\n      debounceTime(300),\n      tap(() => this.softwareTypes.clear()),\n      switchMap((searchString: string) => {\n        if (!this.emitResultsOnly || !searchString) {\n          this.onSelectSoftware.emit(this.softwareTypeMO);\n        }\n        return this.getSoftwareByTypeResult(searchString);\n      }),\n      shareReplay(1)\n    );\n\n    this.filterPipe = pipe(map(this.removeDuplicatesBySoftwareType.bind(this)));\n  }\n\n  ngOnInit(): void {\n    this.notFoundTemplateToUse = this.showBtnInNotFoundMessage\n      ? this.notFoundTypeAddNewTemplate\n      : this.notFoundTypeTemplate;\n  }\n\n  getSoftwareByTypeResult(searchString: string) {\n    let query = this.queriesUtil.prependOrderbys({}, [{ softwareType: 1 }]);\n    const filter = !!searchString\n      ? {\n          softwareType: {\n            __eq: `*${searchString}*`\n          }\n        }\n      : {\n          __has: 'softwareType'\n        };\n    query = this.queriesUtil.addAndFilter(query, filter);\n\n    return this.repositoryService.listRepositoryEntries(RepositoryType.SOFTWARE, {\n      query,\n      params: {\n        pageSize: 200\n      }\n    });\n  }\n\n  selectSoftware(software) {\n    this.softwareTypeMO = software;\n    this.onSelectSoftware.emit(software);\n    this.deviceSoftwareTypeModel.searchControlModel.control.markAsDirty();\n    (this.deviceSoftwareTypeModel as any).onChange(software);\n  }\n\n  clearSoftware() {\n    this.softwareTypeMO = undefined;\n    this.search$.next('');\n    this.onSelectSoftware.emit();\n  }\n\n  resetInput() {\n    this.deviceSoftwareTypeModel.reset();\n  }\n\n  writeValue(value: any): void {\n    this.deviceSoftwareTypeModel.writeValue(value);\n  }\n\n  registerOnChange(fn: any): void {\n    this.deviceSoftwareTypeModel.registerOnChange(fn);\n  }\n\n  registerOnTouched(fn: any): void {\n    this.deviceSoftwareTypeModel.registerOnTouched(fn);\n  }\n\n  setDisabledState(isDisabled: boolean): void {\n    this.deviceSoftwareTypeModel.setDisabledState(isDisabled);\n  }\n\n  validate(control: AbstractControl): ValidationErrors {\n    return this.deviceSoftwareTypeModel.validate(control);\n  }\n\n  private removeDuplicatesBySoftwareType(list: IManagedObject[]): IManagedObject[] {\n    const uniqueBySoftwareType: IManagedObject[] = uniqBy(list, 'softwareType').filter(\n      (sw: IManagedObject) => !this.softwareTypes.has(sw.softwareType)\n    );\n    uniqueBySoftwareType.forEach((sw: IManagedObject) => this.softwareTypes.add(sw.softwareType));\n    return uniqueBySoftwareType;\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { CoreModule, FormsModule, OperationRealtimeService } from '@c8y/ngx-components';\nimport { PopoverModule } from 'ngx-bootstrap/popover';\nimport { RepositoryService } from './repository.service';\nimport { RepositorySelectModalComponent } from './select-modal/repository-select-modal.component';\nimport { FileDownloadComponent } from './file-download/file-download.component';\nimport { AdvancedSoftwareService } from './advanced-software.service';\nimport { SoftwareTypeComponent } from './software-type/software-type.component';\n\n@NgModule({\n  imports: [CommonModule, CoreModule, FormsModule, PopoverModule],\n  declarations: [RepositorySelectModalComponent, FileDownloadComponent, SoftwareTypeComponent],\n  entryComponents: [RepositorySelectModalComponent],\n  providers: [AdvancedSoftwareService, RepositoryService, OperationRealtimeService],\n  exports: [RepositorySelectModalComponent, FileDownloadComponent, SoftwareTypeComponent]\n})\nexport class SharedRepositoryModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":["Service","Injectable","FetchClient","ApplicationService","RepositoryType","DeviceConfigurationOperation","QueriesUtil","isNil","set","assign","isUndefined","gettext","of","from","map","get","isString","head","defer","cloneDeep","_map","omitBy","pick","remove","take","switchMap","withLatestFrom","filter","OperationStatus","throwError","takeWhile","merge","forEach","find","InventoryService","InventoryBinaryService","OperationService","AlertService","EventService","OperationRealtimeService","EventBinaryService","saveAs","Component","Input","memoize","Subject","BehaviorSubject","EventEmitter","ModalSelectionMode","mergeMap","tap","has","isEmpty","isEqual","TranslateService","pipe","debounceTime","shareReplay","uniqBy","NG_VALUE_ACCESSOR","forwardRef","NG_VALIDATORS","ChangeDetectorRef","ViewChild","Output","NgModule","CommonModule","CoreModule","FormsModule","PopoverModule"],"mappings":"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"}