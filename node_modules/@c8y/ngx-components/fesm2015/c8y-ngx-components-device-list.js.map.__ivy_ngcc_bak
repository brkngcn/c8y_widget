{"version":3,"file":"c8y-ngx-components-device-list.js","sources":["../../device-list/add-smart-group.component.ts","../../device-list/device-list.component.ts","../../device-list/device-list-navigation.factory.ts","../../device-list/device-list.module.ts","../../device-list/c8y-ngx-components-device-list.ts"],"sourcesContent":["import { Component } from '@angular/core';\nimport { SmartGroupsService } from '@c8y/client';\nimport { AlertService, gettext } from '@c8y/ngx-components';\nimport { DeviceGridService } from '@c8y/ngx-components/device-grid';\nimport { TranslateService } from '@ngx-translate/core';\nimport { BsModalRef } from 'ngx-bootstrap/modal';\nimport { of } from 'rxjs';\nimport { catchError, switchMap, take, tap } from 'rxjs/operators';\n\n@Component({\n  selector: 'c8y-add-smart-group',\n  templateUrl: './add-smart-group.component.html'\n})\nexport class AddSmartGroupComponent {\n  smartGroup = {\n    name: '',\n    type: 'c8y_DynamicGroup',\n    c8y_IsDynamicGroup: {}\n  };\n\n  configKey: string;\n  deviceQuery: string;\n\n  constructor(\n    private modal: BsModalRef,\n    private smartGroupsService: SmartGroupsService,\n    private deviceGridService: DeviceGridService,\n    private alert: AlertService,\n    private translateService: TranslateService\n  ) {}\n\n  create() {\n    return this.deviceGridService\n      .getConfig$(this.configKey)\n      .pipe(\n        switchMap(config => {\n          return this.smartGroupsService.create({\n            smartGroup: this.smartGroup,\n            deviceQueryString: this.deviceQuery,\n            configurableColumns: config\n          });\n        }),\n        tap(() => {\n          this.alert.success(\n            this.translateService.instant(gettext('Smart group {{ name }} created.'), {\n              name: this.smartGroup.name\n            })\n          );\n          this.modal.hide();\n        }),\n        catchError(ex => {\n          this.alert.addServerFailure(ex);\n          return of([]);\n        }),\n        take(1)\n      )\n      .subscribe();\n  }\n\n  close() {\n    this.modal.hide();\n  }\n}\n","import { Component } from '@angular/core';\nimport { DeviceGridService } from '@c8y/ngx-components/device-grid';\nimport { BsModalService } from 'ngx-bootstrap/modal';\nimport { AddSmartGroupComponent } from './add-smart-group.component';\n\n@Component({\n  selector: 'c8y-device-list',\n  templateUrl: './device-list.component.html'\n})\nexport class DeviceListComponent {\n  readonly GRID_CONFIG_KEY = 'device-grid-all';\n\n  count$ = this.deviceGridService.getTotal({});\n\n  deviceQueryStringOutput: string;\n\n  constructor(\n    protected deviceGridService: DeviceGridService,\n    private bsModalService: BsModalService\n  ) {}\n\n  async createSmartGroup() {\n    const initialState = {\n      configKey: this.GRID_CONFIG_KEY,\n      deviceQuery: this.deviceQueryStringOutput\n    };\n\n    this.bsModalService.show(AddSmartGroupComponent, {\n      class: 'modal-sm',\n      initialState\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { gettext, NavigatorNode, NavigatorNodeFactory } from '@c8y/ngx-components';\n\n@Injectable()\nexport class DeviceListNavigationFactory implements NavigatorNodeFactory {\n  navs: NavigatorNode[] = [];\n\n  async get() {\n    this.navs.push(\n      new NavigatorNode({\n        label: gettext('All devices'),\n        path: 'device',\n        icon: 'c8y-device-management',\n        parent: {\n          label: gettext('Devices'),\n          icon: 'exchange'\n        },\n        priority: 2000\n      })\n    );\n\n    return this.navs;\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { Route, RouterModule } from '@angular/router';\nimport { CoreModule, CommonModule, HOOK_NAVIGATOR_NODES } from '@c8y/ngx-components';\nimport { DeviceGridModule } from '@c8y/ngx-components/device-grid';\n\nimport { DeviceListNavigationFactory } from './device-list-navigation.factory';\nimport { DeviceListComponent } from './device-list.component';\nimport { AddSmartGroupComponent } from './add-smart-group.component';\n\nconst routes: Route[] = [\n  {\n    path: 'device',\n    component: DeviceListComponent\n  }\n];\n\n@NgModule({\n  imports: [CoreModule, CommonModule, DeviceGridModule, RouterModule.forChild(routes)],\n  declarations: [DeviceListComponent, AddSmartGroupComponent],\n  entryComponents: [DeviceListComponent],\n  exports: [],\n  providers: [\n    {\n      provide: HOOK_NAVIGATOR_NODES,\n      useClass: DeviceListNavigationFactory,\n      multi: true\n    }\n  ]\n})\nexport class DeviceListModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}