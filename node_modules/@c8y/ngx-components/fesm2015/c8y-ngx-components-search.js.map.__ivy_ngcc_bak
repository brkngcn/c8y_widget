{"version":3,"file":"c8y-ngx-components-search.js","sources":["../../search/search.service.ts","../../search/search-grid.component.ts","../../search/search-results.component.ts","../../search/search-action.component.ts","../../search/search.module.ts","../../search/c8y-ngx-components-search.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { Pagination } from '@c8y/ngx-components';\nimport { DeviceGridColumn } from '@c8y/ngx-components/device-grid';\nimport { SubAssetsService } from '@c8y/ngx-components/sub-assets';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AssetSearchService extends SubAssetsService {\n  protected GRID_CONFIG_STORAGE_KEY = 'search-grid-config';\n  protected DEFAULT_PAGE_SIZE = 50;\n\n  buildCombinedRootQueryFilter(columns, pagination) {\n    const rootQuery = {\n      __filter: {\n        __and: { __not: { __has: `c8y_IsBinary` } }\n      }\n    };\n    const userQuery = this.getQueryObj(columns, pagination);\n    const queryPart = this.queriesUtil.addOrderbys(rootQuery, userQuery.__orderby, 'append');\n    const fullQuery = this.queriesUtil.addAndFilter(queryPart, userQuery.__filter);\n    return this.queriesUtil.buildQuery(fullQuery);\n  }\n\n  async getData(columns: DeviceGridColumn[], pagination: Pagination) {\n    const query = this.buildCombinedRootQueryFilter(columns, pagination);\n    return this.assetNodeService.getAllInventories({ ...pagination, query });\n  }\n}\n","import { Component, EventEmitter, Input, Output, ViewChild } from '@angular/core';\nimport {\n  ActionControl,\n  BuiltInActionType,\n  BulkActionControl,\n  DataGridComponent,\n  DataSourceModifier,\n  FilteringActionType,\n  FilteringModifier,\n  gettext,\n  Pagination,\n  ServerSideDataResult,\n  InventorySearchService,\n  Row\n} from '@c8y/ngx-components';\nimport { DeviceGridColumn } from '@c8y/ngx-components/device-grid';\nimport { IManagedObject, SmartGroupsService } from '@c8y/client';\nimport { AssetSearchService } from './search.service';\nimport {\n  AssetTypeGridColumn,\n  DeleteAssetsModalComponent,\n  DeleteModalCheckboxes,\n  SubAssetsService\n} from '@c8y/ngx-components/sub-assets';\nimport { BsModalService } from 'ngx-bootstrap/modal';\nimport {\n  AlarmsDeviceGridColumn,\n  DeviceGridService,\n  ImeiDeviceGridColumn,\n  ModelDeviceGridColumn,\n  NameDeviceGridColumn,\n  RegistrationDateDeviceGridColumn,\n  SerialNumberDeviceGridColumn,\n  SystemIdDeviceGridColumn\n} from '@c8y/ngx-components/device-grid';\n\n@Component({\n  selector: 'c8y-search-grid',\n  templateUrl: './search-grid.component.html'\n})\nexport class SearchGridComponent {\n  @Input('parent-group') parentGroup: IManagedObject;\n  @Input() title: string = '';\n  @Input() loadingItemsLabel: string = gettext('Loading results…');\n  @Input('columns') set _columns(value: DeviceGridColumn[]) {\n    if (value) {\n      this.columns = value;\n    } else {\n      this.columns = this.searchService.getDefaultColumns();\n    }\n  }\n  @Input('pagination') set _pagination(value: Pagination) {\n    if (value) {\n      this.pagination = value;\n    } else {\n      this.pagination = this.searchService.getDefaultPagination();\n    }\n  }\n  @Input('actionControls') set _actionControls(value: ActionControl[]) {\n    if (value) {\n      this.actionControls = value;\n    } else {\n      this.actionControls = this.searchService.getDefaultActionControls();\n    }\n  }\n  @Input() selectable: boolean = false;\n  @Input('bulkActionControls') set _bulkActionControls(value: BulkActionControl[]) {\n    if (value) {\n      this.bulkActionControls = value;\n    } else {\n      this.bulkActionControls = this.searchService.getDefaultBulkActionControls();\n    }\n  }\n  @Output() onColumnsChange: EventEmitter<DeviceGridColumn[]> = new EventEmitter<\n    DeviceGridColumn[]\n  >();\n\n  @Input()\n  searchText = '';\n\n  @Input()\n  filteringName: string;\n\n  columns: DeviceGridColumn[];\n  pagination: Pagination = this.searchService.getDefaultPagination();\n  actionControls: ActionControl[];\n  bulkActionControls: BulkActionControl[] = this.searchService.getDefaultBulkActionControls();\n  serverSideDataCallback: any;\n  refresh: EventEmitter<any> = new EventEmitter();\n\n  @ViewChild(DataGridComponent, { static: true })\n  dataGrid: DataGridComponent;\n\n  private sizeCount = 0;\n\n  constructor(\n    private coreSearchService: InventorySearchService,\n    public searchService: AssetSearchService,\n    private bsModalService: BsModalService,\n    private smartGroupsService: SmartGroupsService,\n    private subAssetsGridService: SubAssetsService\n  ) {}\n\n  ngOnInit(): void {\n    if (!this.filteringName) {\n      this.columns = this.searchService.getDefaultColumns();\n    } else {\n      this.columns = [\n        new AssetTypeGridColumn({ sortOrder: 'desc' }),\n        new NameDeviceGridColumn({\n          sortOrder: 'asc',\n          filter: { externalFilterQuery: { names: [this.filteringName] } }\n        }),\n        new ModelDeviceGridColumn(),\n        new SerialNumberDeviceGridColumn({ visible: false }),\n        new RegistrationDateDeviceGridColumn({ visible: false }),\n        new SystemIdDeviceGridColumn({ visible: false }),\n        new ImeiDeviceGridColumn({ visible: false }),\n        new AlarmsDeviceGridColumn()\n      ];\n    }\n    this.serverSideDataCallback = this.onDataSourceModifier.bind(this);\n    this.setActionControls();\n  }\n\n  trackByName(_index, column: DeviceGridColumn): string {\n    return column.name;\n  }\n\n  async onDataSourceModifier(\n    dataSourceModifier: DataSourceModifier\n  ): Promise<ServerSideDataResult> {\n    let response;\n    if (dataSourceModifier.searchText) {\n      response = await this.coreSearchService.search(\n        dataSourceModifier.searchText,\n        dataSourceModifier.pagination\n      );\n    } else {\n      response = await this.searchService.getData(\n        dataSourceModifier.columns,\n        dataSourceModifier.pagination,\n      );\n    }\n    const { res, data, paging } = response;\n    const filteredData = this.coreSearchService.filterOnlyAssets(data);\n\n    if (paging.currentPage === 1) {\n      this.sizeCount = 0;\n    }\n    this.sizeCount += filteredData.length;\n    this.onColumnsChange.emit(dataSourceModifier.columns);\n\n    return {\n      res,\n      data: filteredData,\n      paging,\n      filteredSize: this.sizeCount,\n      size: undefined\n    };\n  }\n\n  setActionControls() {\n    const actionControls: ActionControl[] = [];\n    const deleteAction: ActionControl = {\n      type: BuiltInActionType.Delete,\n      callback: (asset: Row) => this.onDeleteAsset(asset as IManagedObject, this.parentGroup)\n    };\n    actionControls.push(deleteAction);\n    if (!this.actionControls) {\n      this.actionControls = actionControls;\n    }\n  }\n\n  updateFiltering(\n    columnNames: string[],\n    action: {\n      type: FilteringActionType;\n      payload?: { filteringModifier: FilteringModifier };\n    }\n  ) {\n    const { type } = action;\n    if (type === FilteringActionType.ResetFilter) {\n      this.dataGrid.clearFilters();\n    } else {\n      this.dataGrid.updateFiltering(columnNames, action, false);\n    }\n  }\n\n  configChange(config) {\n    this.searchService.saveConfig(config);\n  }\n\n  private onDeleteAsset(asset, parentRef) {\n    const initialState = {\n      showWithDeviceUserCheckbox: this.subAssetsGridService.shouldShowWithDeviceUserCheckbox(asset),\n      asset,\n      showWithCascadeCheckbox:\n        !this.smartGroupsService.isSmartGroup(asset) &&\n        !this.smartGroupsService.isSmartGroupV2(asset)\n    };\n\n    const modalRef = this.bsModalService.show(DeleteAssetsModalComponent, { initialState });\n\n    modalRef.content.closeSubject.subscribe(async (result: DeleteModalCheckboxes) => {\n      if (result) {\n        await this.subAssetsGridService.deleteAsset(asset, parentRef, result);\n        this.refresh.emit();\n      }\n    });\n  }\n}\n","import { Component, OnDestroy, ViewChild } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { Subject } from 'rxjs';\nimport { skip, takeUntil } from 'rxjs/operators';\nimport { SearchGridComponent } from './search-grid.component';\nimport { FilteringActionType, AlertService, Status, gettext, Alert } from '@c8y/ngx-components';\n\n@Component({\n  selector: 'c8y-search-results',\n  templateUrl: './search-results.component.html'\n})\nexport class SearchResultsComponent implements OnDestroy {\n  filter: string = '';\n  searchText: string = '';\n  @ViewChild(SearchGridComponent, { static: true })\n  searchGrid: SearchGridComponent;\n  filteringName: string;\n\n  private readonly WARNING_TIMEOUT_TIME = 3000;\n  private unsubscribe$ = new Subject<any>();\n\n  constructor(private route: ActivatedRoute, private alert: AlertService) {}\n\n  ngOnInit() {\n    this.route.queryParams.pipe(takeUntil(this.unsubscribe$)).subscribe(params => {\n      if (params.filter) {\n        this.filteringName = params.filter;\n      }\n    });\n  }\n\n  ngAfterViewInit(): void {\n    this.route.queryParams\n      .pipe(takeUntil(this.unsubscribe$))\n      .subscribe(({ filter, search }) => this.onQueryParamsChange(filter, search));\n\n    this.searchGrid.dataGrid.onBeforeSearch.pipe(takeUntil(this.unsubscribe$)).subscribe(text => {\n      if (text) {\n        this.resetFilter();\n      }\n    });\n\n    this.searchGrid.dataGrid.onBeforeFilter\n      .pipe(takeUntil(this.unsubscribe$))\n      .subscribe(() => this.resetSearch());\n  }\n\n  resetSearch() {\n    if (this.searchGrid.dataGrid.searchText) {\n      this.alert.add({\n        text: gettext('Search reset. Full text search does not support filtering.'),\n        type: Status.WARNING,\n        timeout: this.WARNING_TIMEOUT_TIME\n      } as Alert);\n      this.searchText = '';\n      this.searchGrid.dataGrid.searchText = '';\n    }\n  }\n\n  resetFilter() {\n    this.filter = '';\n    if (this.searchGrid.dataGrid.filteringApplied) {\n      this.alert.add({\n        text: gettext('Filter reset. Full text search does not support filtering.'),\n        type: Status.WARNING,\n        timeout: this.WARNING_TIMEOUT_TIME\n      } as Alert);\n      this.searchGrid.dataGrid.clearFilters(false);\n    }\n  }\n\n  ngOnDestroy() {\n    this.unsubscribe$.next();\n    this.unsubscribe$.complete();\n  }\n\n  private onQueryParamsChange(filter: string, searchTerm: string) {\n    if (!this.shouldFilter(filter) && searchTerm) {\n      this.searchText = searchTerm || '';\n    }\n  }\n\n  private shouldFilter(filter) {\n    if (!filter) {\n      return false;\n    }\n    this.resetSearch();\n    this.filter = filter || '';\n    this.searchGrid.updateFiltering(['name'], {\n      type: FilteringActionType.ApplyFilter,\n      payload: {\n        filteringModifier: {\n          externalFilterQuery: {\n            names: [this.filter]\n          }\n        }\n      }\n    });\n    return true;\n  }\n}\n","import { Component } from '@angular/core';\nimport { IManagedObject } from '@c8y/client';\nimport { NavigationExtras, Router } from '@angular/router';\nimport { RouterService as C8yRouter } from '@c8y/ngx-components';\n\n@Component({\n  selector: 'c8y-search-action',\n  templateUrl: './search-action.component.html'\n})\nexport class SearchActionComponent {\n  constructor(private c8yRouter: C8yRouter, private router: Router) {}\n\n  onSearch(on: string) {\n    this.navigate(['/assetsearch'], {\n      queryParams: { search: on },\n      replaceUrl: true\n    });\n  }\n\n  onFilter(on: string) {\n    this.navigate(['/assetsearch'], {\n      queryParams: { filter: on },\n      replaceUrl: true\n    });\n  }\n\n  onClick(mo: IManagedObject) {\n    this.router.navigateByUrl(this.c8yRouter.getHref(mo, '/'));\n  }\n\n  private navigate(commands: any[], extras?: NavigationExtras) {\n    this.router\n      .navigateByUrl('/', { skipLocationChange: true })\n      .then(() => this.router.navigate(commands, extras));\n  }\n}\n","import { NgModule } from '@angular/core';\nimport {\n  CoreModule,\n  HOOK_ONCE_ROUTE,\n  HOOK_SEARCH,\n  Search,\n  HOOK_ROUTE,\n  SearchModule as CoreSearchModule\n} from '@c8y/ngx-components';\nimport { DeviceGridModule } from '@c8y/ngx-components/device-grid';\nimport { SearchResultsComponent } from './search-results.component';\nimport { SearchGridComponent } from './search-grid.component';\nimport { SearchActionComponent } from './search-action.component';\nimport { AssetSearchService } from './search.service';\n\n@NgModule({\n  declarations: [SearchResultsComponent, SearchGridComponent, SearchActionComponent],\n  imports: [CoreModule, DeviceGridModule, CoreSearchModule],\n  entryComponents: [SearchResultsComponent, SearchActionComponent],\n  exports: [SearchResultsComponent, SearchGridComponent],\n  providers: [\n    AssetSearchService,\n    {\n      provide: HOOK_ROUTE,\n      useValue: [\n        {\n          path: 'assetsearch',\n          component: SearchResultsComponent\n        }\n      ],\n      multi: true\n    },\n    {\n      provide: HOOK_SEARCH,\n      useValue: [\n        {\n          template: SearchActionComponent\n        }\n      ] as Search[],\n      multi: true\n    }\n  ]\n})\nexport class SearchModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n\nexport {SearchActionComponent as ɵa} from './search-action.component';"],"names":["C8yRouter","CoreSearchModule"],"mappings":"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"}